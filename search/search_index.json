{"config":{"lang":["en"],"separator":"[\\u200b\\u3000\\-\u3001\u3002\uff0c\uff0e\uff1f\uff01\uff1b\\s\\-,:!=\\[\\]()\"/]+|(?!\\b)(?=[A-Z][a-z])|\\.(?!\\d)|&[lg]t;","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"About","text":"<p>\u5173\u4e8e\u6211</p> <p>Misaki <code>90\u540e\u672b\u73ed\u8f66</code> <code>CS</code> <code>\u670d\u52a1\u7aef\u96c6\u6210</code> |  GitHub  LeetCode</p> <p>\u8fd9\u91cc\u662f\u6211\u7684\u7b14\u8bb0\u672c (\u517c\u4e2a\u4eba\u4e3b\u9875\uff0c\u94fe\u63a5\u9879\u76ee\uff0c\u4f1a\u5b58\u653e\u4ee3\u7801\u7247\u6bb5\uff0c\u5076\u5c14\u4e5f\u5199\u70b9\u535a\u5ba2\u3002</p> <p>\u5bf9\u4ee3\u7801\u7684\u6fc0\u60c5\u5728\u4e8e\u63a2\u7d22\u4e00\u5207\u53ef\u80fd\u6027\uff0c\u8ffd\u6c42\u7b80\u5355\u3001\u9ad8\u6548\u3001\u597d\u7528\u7684\u6a21\u5757\u5316\u4ee3\u7801\u3002</p> <p>\u559c\u6b22\u6444\u5f71\uff0c\u4eab\u53d7\u97f3\u4e50\uff0c\u4e5f\u54c1\u5c1d\u72ec\u7acb\u6e38\u620f\uff0c\u5bf9\u65b0\u4e8b\u7269\u62b1\u6709\u70ed\u60c5\uff01</p>"},{"location":"#repo-links","title":"Repo Links","text":"<ul> <li> <p> Erdtree</p> <p>\u57fa\u4e8eC++20\u5f00\u53d1\u7684\u8f7b\u91cf\u5316Daemon\u670d\u52a1\uff0c\u652f\u6301\u914d\u7f6e\u3001\u591a\u8fdb\u7a0b\u3001hooks\u3001\u5171\u4eab\u5185\u5b58\u3002</p> </li> <li> <p> AsioHttp\u670d\u52a1\u6846\u67b6</p> <p>\u4f7f\u7528Boost Asio\u548cc++20 coroutine\u642d\u5efa\uff0c\u57fa\u4e8eC++\u7684\u7b80\u5355http\u670d\u52a1\u6846\u67b6\u3002</p> </li> <li> <p> Base64\u7f16\u89e3\u7801</p> <p>\u4e00\u4e2a\u7ec3\u4e60\u9879\u76ee\uff0c\u5b9e\u73b0\u4e86base64\u7684\u7f16\u89e3\u7801\u65b9\u6cd5\u3002\u4f7f\u7528\u4e86CMake\u7f16\u8bd1\uff0cConan\u5305\u7ba1\u7406\u4ee5\u53caGoogleTest\u6d4b\u8bd5</p> </li> <li> <p> LumosLog</p> <p>\u4e00\u4e2a\u8f7b\u91cf\u7ea7\u7684\u3001\u4ec5\u9650\u5934\u7684\u65e5\u5fd7\u670d\u52a1\u5b9a\u4f4d\u5668\u3002\u89e3\u8026\u65e5\u5fd7\u7cfb\u7edf\u548c\u4e1a\u52a1\u6a21\u5757\uff0c\u5141\u8bb8\u5728\u8fd0\u884c\u65f6\u52a8\u6001\u6ce8\u5165\u81ea\u5b9a\u4e49Logger\u3002</p> </li> <li> <p> MD5\u8ba1\u7b97</p> <p>\u4f7f\u7528openssl\u7684MD5(EVP)\u91cd\u65b0\u5305\u88c5\u7684\u5de5\u5177\u5e93\u3002</p> </li> </ul> <p> \u591a\u6469\u5ddd\u898b\u6674\u3089\u3057\u516c\u5712</p>"},{"location":"CodeSnippets/CPUMemoryMonitor/","title":"CPU\u5185\u5b58\u76d1\u63a7","text":"<p>Python Only</p> <p>\u5229\u7528psutil\u548cmatplotlib\u5b9e\u73b0\u5bf9\u6307\u5b9a\u8fdb\u7a0b\u7684\u8d44\u6e90\u76d1\u63a7\uff0c\u5e76\u753b\u56fe\u4fdd\u5b58</p> depends<pre><code>pip3 install psutil matplotlib -i https://pypi.tuna.tsinghua.edu.cn/simple\n</code></pre> <pre><code>import psutil\nimport time\nimport argparse\nimport logging\n\ndef parse_arguments():\n    parser = argparse.ArgumentParser()\n    parser.add_argument(\"-p\", \"--pid\", help=\"pid of target\", type=int)\n    parser.add_argument(\"-d\", \"--duration\", default=10, help=\"Duration Time\", type=int)\n    parser.add_argument(\"-i\", \"--interval\", default=1, help=\"interval\", type=int)\n    parser.add_argument(\"--save_image\", default=False, help=\"save image?\", type=bool)\n    args = parser.parse_args()\n\n    if not args.pid:\n        print(\"Please set pid\")\n        exit(1)\n\n    return args\n\nclass Monitor:\n    _process_id = 1\n    _process = None\n    _timestamps = []\n    _memory_usage = []\n    _cpu_usage = []\n\n    def __init__(self, process_id):\n        self._process_id = process_id\n        try:\n            self._process = psutil.Process(self._process_id)\n        except psutil.NoSuchProcess:\n            print(f\"\u8fdb\u7a0bID {self._process_id} \u4e0d\u5b58\u5728\u6216\u5df2\u7ec8\u6b62\u3002\")\n            exit(-1)\n\n    def save_usage_image(self):\n        import matplotlib.pyplot as plt\n\n        # \u7ed8\u5236\u5185\u5b58\u4f7f\u7528\u7387\u56fe\u8868\n        plt.figure(1)\n        plt.plot(self._timestamps, self._memory_usage)\n        plt.xlabel('time(s)')\n        plt.ylabel('Memory(MB)')\n        plt.title('Usage')\n        plt.grid(True)\n\n        # \u4fdd\u5b58\u56fe\u8868\n        plt.savefig(\"memory_usage_plot_\" + str(self._process_id) + \".png\")\n\n        # \u7ed8\u5236CPU\u4f7f\u7528\u7387\u56fe\u8868\n        plt.figure(2)\n        plt.plot(self._timestamps, self._cpu_usage)\n        plt.xlabel('time(s)')\n        plt.ylabel('CPU(%)')\n        plt.title('CPU Usage')\n        plt.grid(True)\n\n        # \u4fdd\u5b58\u56fe\u8868\n        plt.savefig(\"cpu_usage_plot_\" + str(self._process_id) + \".png\")\n\n    def process(self, duration, interval):\n        start_time = time.time()\n\n        while time.time() - start_time &lt;= duration:\n            cur_time = time.time() - start_time\n            try:\n                mem_info = self._process.memory_info()\n                cur_mem_usage = mem_info.rss / (1024 * 1024) # \u5355\u4f4d\uff1aMB\n                self._memory_usage.append(cur_mem_usage)  \n\n                cpu_percent = self._process.cpu_percent(interval=interval)\n                self._cpu_usage.append(cpu_percent)\n\n                logging.info(f\"Memory usage: {cur_mem_usage:.6f}MB, CPU usage: {cpu_percent}%\")\n\n                self._timestamps.append(cur_time)\n            except:\n                logging.warn(f\"\u8fdb\u7a0bID {self._process_id} \u4e0d\u5b58\u5728\u6216\u5df2\u7ec8\u6b62\u3002\")\n                break\n\nif __name__ == \"__main__\":\n    args = parse_arguments()\n\n    process_id = args.pid\n    duration = args.duration\n    interval = args.interval\n    b_save_img = args.save_image if args.save_image else False\n\n    print(\"b_save_img:\", b_save_img)\n\n    log_file_name = str(process_id) + \".log\"\n    logging.basicConfig(level=logging.DEBUG,\n                        format='%(asctime)s - %(levelname)s - %(message)s',\n                        filename=log_file_name)\n\n    monitor = Monitor(process_id)\n    monitor.process(duration, interval)\n\n    if b_save_img:\n        monitor.save_usage_image()        \n</code></pre>"},{"location":"CodeSnippets/Converter/","title":"\u5b57\u7b26\u8f6c\u6362","text":""},{"location":"CodeSnippets/Converter/#string-wstring","title":"string &amp; wstring","text":"C++ <pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;locale&gt;\n#include &lt;codecvt&gt;\n\nclass CharConverter {\npublic:\n    CharConverter() = delete;\n    ~CharConverter() = delete;\n\n    static std::wstring str_to_wstr(const std::string&amp; str) {\n        return converter.from_bytes(str);\n    }\n\n    static std::string wstr_to_str(const std::wstring&amp; wstr) {\n        return converter.to_bytes(wstr);\n    }\n\nprivate:\n    static std::wstring_convert&lt;std::codecvt_utf8_utf16&lt;wchar_t&gt;&gt; converter;\n};\n\nstd::wstring_convert&lt;std::codecvt_utf8_utf16&lt;wchar_t&gt;&gt; CharConverter::converter;\n</code></pre> <p>Example</p> <pre><code>int main() {\n    std::string original = \"\u4f60\u597d\uff0c\u4e16\u754c\uff01\";\n\n    std::cout &lt;&lt; \"Narrow to Wide to Narrow: \" &lt;&lt; \n    CharConverter::wstr_to_str(CharConverter::str_to_wstr(original)) &lt;&lt; std::endl;\n\n    return 0;\n}\n</code></pre>"},{"location":"CodeSnippets/Converter/#utf-unicode","title":"UTF &amp; unicode","text":"C++ utf32 to utf8unicode to utf8 <pre><code>#include &lt;iostream&gt;\n#include &lt;string&gt;\n#include &lt;vector&gt;\n#include &lt;stdexcept&gt;\n\nstd::string utf32ToUtf8(char32_t utf32Char) {\n    std::string utf8Char;\n    if (utf32Char &lt;= 0x7F) {\n        utf8Char.push_back(static_cast&lt;char&gt;(utf32Char));\n    } else if (utf32Char &lt;= 0x7FF) {\n        utf8Char.push_back(static_cast&lt;char&gt;((utf32Char &gt;&gt; 6) | 0xC0));\n        utf8Char.push_back(static_cast&lt;char&gt;((utf32Char &amp; 0x3F) | 0x80));\n    } else if (utf32Char &lt;= 0xFFFF) {\n        utf8Char.push_back(static_cast&lt;char&gt;((utf32Char &gt;&gt; 12) | 0xE0));\n        utf8Char.push_back(static_cast&lt;char&gt;(((utf32Char &gt;&gt; 6) &amp; 0x3F) | 0x80));\n        utf8Char.push_back(static_cast&lt;char&gt;((utf32Char &amp; 0x3F) | 0x80));\n    } else if (utf32Char &lt;= 0x10FFFF) {\n        utf8Char.push_back(static_cast&lt;char&gt;((utf32Char &gt;&gt; 18) | 0xF0));\n        utf8Char.push_back(static_cast&lt;char&gt;(((utf32Char &gt;&gt; 12) &amp; 0x3F) | 0x80));\n        utf8Char.push_back(static_cast&lt;char&gt;(((utf32Char &gt;&gt; 6) &amp; 0x3F) | 0x80));\n        utf8Char.push_back(static_cast&lt;char&gt;((utf32Char &amp; 0x3F) | 0x80));\n    } else {\n        throw std::runtime_error(\"Invalid UTF-32 character\");\n    }\n    return utf8Char;\n}\n\nstd::vector&lt;std::string&gt; toUtf8Sequence(const std::string&amp; input) {\n    std::vector&lt;std::string&gt; utf8Sequence;\n\n    for (char c : input) {\n        char32_t utf32Char = static_cast&lt;unsigned char&gt;(c);\n        std::string utf8Char = utf32ToUtf8(utf32Char);\n        utf8Sequence.push_back(utf8Char);\n    }\n\n    return utf8Sequence;\n}\n</code></pre> <pre><code>std::vector&lt;std::string&gt; toUtf8Sequence(const std::string &amp;text) {\n    std::vector&lt;std::string&gt; utf8Sequence;\n    int num = text.size();\n    int i = 0;\n    while (i &lt; num) {\n        int size = 1;\n        if (text[i] &amp; 0x80) {\n        char temp = text[i];\n        temp &lt;&lt;= 1;\n        do {\n            temp &lt;&lt;= 1;\n            ++size;\n        } while (temp &amp; 0x80);\n        }\n        std::string subWord = text.substr(i, size);\n        utf8Sequence.push_back(subWord);\n\n        i += size;\n    }\n    return utf8Sequence;\n}\n</code></pre> <p>Example</p> <pre><code>~~~c++\nint main() {\n    std::string input = \"Hello, \u4f60\u597d, \u4e16\u754c!\";\n\n    std::vector&lt;std::string&gt; utf8Sequence = toUtf8Sequence(input);\n\n    std::cout &lt;&lt; \"UTF-8 Character Sequence:\" &lt;&lt; std::endl;\n    for (const std::string&amp; utf8Char : utf8Sequence) {\n        printf(\"%X \", utf8Char.c_str());\n    }\n    printf(\"\\n\");\n\n    return 0;\n}\n~~~\n</code></pre>"},{"location":"CodeSnippets/FastapiCORS/","title":"FastapiCORS","text":"<p>Python Only</p> Python Fastapi \u8de8\u57df\u7ec4\u4ef6<pre><code>from fastapi import FastAPI\nfrom fastapi.middleware.cors import CORSMiddleware\n\napp = FastAPI()\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"]\n)\n</code></pre>"},{"location":"CodeSnippets/Logger/","title":"\u7b80\u6613Logger","text":"C++Python logger.hpp<pre><code>#pragma once\n\n#include &lt;iostream&gt;\n#include &lt;ctime&gt;\n#include &lt;cstdarg&gt;\n#include &lt;string&gt;\n\nenum LogLevel {\n    DEBUG,\n    INFO,\n    WARN,\n    ERROR\n};\n\nclass Logger {\npublic:\n    static void log(LogLevel level, const char* format, ...);\n\nprivate:\n    static std::string getCurrentTime();\n};\n</code></pre> logger.cpp<pre><code>void Logger::log(LogLevel level, const char* format, ...) {\n#ifndef DEBUG_LOG\n    if (level == DEBUG) {\n        return;\n    }\n#endif\n    std::string levelStr;\n    switch (level) {\n        case DEBUG:\n            levelStr = \"DEBUG\";\n            break;\n        case INFO:\n            levelStr = \"INFO\";\n            break;\n        case WARN:\n            levelStr = \"WARN\";\n            break;\n        case ERROR:\n            levelStr = \"ERROR\";\n            break;\n    }\n\n    std::string timeStr = getCurrentTime();\n    std::string prefix = timeStr + \" [\" + levelStr + \"] \";\n\n    std::cout &lt;&lt; prefix;\n    va_list args;\n    va_start(args, format);\n    std::vprintf(format, args);\n    va_end(args);\n    std::cout &lt;&lt; std::endl;\n}\n\nstd::string Logger::getCurrentTime() {\n    std::time_t now = std::time(nullptr);\n    char buffer[100];\n    std::strftime(buffer, sizeof(buffer), \"%Y-%m-%d %H:%M:%S\", std::localtime(&amp;now));\n    return buffer;\n}\n</code></pre> <p>Example</p> <pre><code>int a;\nint b;\nLogger::log(DEBUG, \"a=%d, b=%d\", a, b);\n</code></pre> mylogger.py<pre><code>import logging\nfrom logging import handlers\nimport threading\n\n\nclass Log:\n    _instance_lock = threading.Lock()\n\n    def init(self, *args, **kwargs):\n        # \u65e5\u5fd7\u7b49\u7ea7 \u9ed8\u8ba4: INFO\n        self.level = (kwargs[\"level\"] if kwargs.get(\"level\") else \"INFO\")\n        # self.level = (kwargs[\"level\"] if kwargs.get(\"level\") else \"DEBUG\")\n        # \u65f6\u95f4\u6233\u683c\u5f0f \u9ed8\u8ba4: %Y-%m-%d-%H:%M:%S\n        self.datefmt = (kwargs[\"datefmt\"] if kwargs.get(\"datefmt\") else \"%Y-%m-%d_%H:%M:%S\")\n        # \u65e5\u5fd7\u8f93\u51fa\u683c\u5f0f \u9ed8\u8ba4: [\u65f6\u95f4] [\u6a21\u5757\u540d] [\u51fd\u6570\u540d] [\u65e5\u5fd7\u7b49\u7ea7] \u8fdb\u7a0b\u53f7 \u7ebf\u7a0b\u53f7 \u6253\u5370\u5185\u5bb9\n        self.format = logging.Formatter((kwargs[\"format\"] if kwargs.get(\"format\") else \n        \"%(asctime)s.%(msecs)03d [%(module)s] [%(funcName)s] [%(levelname)s] %(process)d %(thread)d %(message)s\"), self.datefmt)\n        # \u662f\u5426\u63a7\u5236\u53f0\u8f93\u51fa \u9ed8\u8ba4: \u662f\n        self.console = (kwargs[\"console\"] if kwargs.get(\"console\") else True)\n        # \u65e5\u5fd7\u6587\u4ef6\u540d\u524d\u7f00 \u9ed8\u8ba4: log\n        self.filename = \"./logs/\" + (kwargs[\"filename\"] + \"_\" if kwargs.get(\"filename\") else \"\") + \"log\" \n        # \u65e5\u5fd7\u5207\u5206\u65f6\u95f4 \u9ed8\u8ba4: 0\u70b9\n        self.when = (kwargs[\"when\"] if kwargs.get(\"when\") else \"MIDNIGHT\")\n        # \u65e5\u5fd7\u6eda\u52a8\u4fdd\u7559\u4e2a\u6570 \u9ed8\u8ba4: 1\n        self.backupCount = (kwargs[\"backupCount\"] if kwargs.get(\"backupCount\") else 1)\n\n        self.level_map = {\n            \"DEBUG\" : logging.DEBUG,\n            \"INFO\"  : logging.INFO,\n            \"WARNING\" : logging.WARNING,\n            \"ERROR\" : logging.ERROR,\n            \"CRITICAL\" : logging.CRITICAL\n        }\n\n        self.logger = logging.getLogger(\"__name__\")\n        self.logger.setLevel(self.level_map.get(self.level))\n\n        # \u63a7\u5236\u53f0\u65e5\u5fd7handler\n        if self.console:\n            stream_handler = logging.StreamHandler()\n            stream_handler.setFormatter(self.format)\n            self.logger.addHandler(stream_handler)\n\n        # \u6587\u4ef6\u65e5\u5fd7handler\n        file_handler = handlers.TimedRotatingFileHandler(\n            filename=self.filename,\n            when=self.when,\n            backupCount=self.backupCount,\n            delay = True,\n            encoding=\"utf-8\"\n        )\n        file_handler.setFormatter(self.format)\n        self.logger.addHandler(file_handler)\n\n    def __new__(cls, *args, **kwargs):\n        if not hasattr(Log, \"_instance\"):\n            with Log._instance_lock:\n                if not hasattr(Log, \"_instance\"):\n                    Log._instance = object.__new__(cls)\n                    Log._instance.init(*args, **kwargs)\n                    Log._instance.logger.debug(\"logger init success\")\n        return Log._instance\n\nmylogger = Log().logger\n</code></pre> <p>Example</p> <pre><code>from mylogger import mylogger\n\ndef test():\n    mylogger.info(\"hello world\")\n\nif __name__ == \"__main__\":\n    test()\n</code></pre>"},{"location":"CodeSnippets/PyMultiProcess/","title":"Python\u7684\u5f02\u6b65\u591a\u4efb\u52a1\u4e0e\u4e8b\u4ef6\u5faa\u73af","text":"<p>Python\u7684\u5f02\u6b65\u591a\u8fdb\u7a0b, \u9700\u8981\u7279\u522b\u6ce8\u610fGIL</p> <p>\u5173\u4e8ePython\u7684\u4e8b\u4ef6\u5faa\u73af</p> <p>\u8fd9\u91cc\u8d34\u4e00\u4e0b\u6587\u6863  Use EventLoop in thread or process pools</p> <p>Python\u7684\u5f02\u6b65\u76f8\u5f53\u4e8e\u4e00\u4e2a\u72ec\u7279\u7684\u4e8b\u4ef6\u5faa\u73af\uff0c\u5b83\u6709\u4e00\u4e2a\u7279\u70b9\uff0c\u5982\u679c\u5728\u8fd9\u4e2a\u4e8b\u4ef6\u5faa\u73af\u91cc\u8fd0\u884c\u4e86\u975e\u5f02\u6b65\u7684\u65b9\u6cd5\uff0c\u90a3\u4e48\u6574\u4e2a\u5f02\u6b65\u90fd\u4f1a\u7b49\u5f85\u8fd9\u4e2a\u201c\u540c\u6b65\u65b9\u6cd5\u201d\u8fd0\u884c\u5b8c\u3002\u5047\u5982\u4f60\u7684\u540c\u6b65\u65b9\u6cd5\u53c8\u6070\u597d\u662f\u4e2aCPU\u5bc6\u96c6\u578b\u5de5\u4f5c\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u5f88\u660e\u663e\u7684\u89c2\u6d4b\u5230TPS\u964d\u4f4e\uff0c\u5f02\u6b65\u770b\u8d77\u6765\u201c\u5931\u6548\u201d\u4e86\u3002</p> <p>\u89e3\u51b3\u7684\u529e\u6cd5\u4e00\u79cd\u662f\u7ed9\u6240\u6709\u88ab\u8c03\u7528\u7684\u65b9\u6cd5\u90fd\u5957\u4e0a<code>async</code>\uff0c\u4e0d\u8fc7\u5927\u591a\u6570\u65f6\u5019\u4ee3\u7801\u5f88\u5e9e\u5927\uff0c\u6240\u4ee5\u6309\u7167\u6587\u6863\u5957\u4e00\u5c42loop\u5174\u8bb8\u662f\u76f8\u5bf9\u7b80\u5355\u7684\u529e\u6cd5\u3002</p> \u7528asyncio\u7684loop\uff0c\u89e3\u51b3python\u5f02\u6b65\u51fd\u6570\u88ab\u963b\u585e\u7684\u95ee\u9898 <pre><code>import os\nimport asyncio\nimport concurrent.futures\n\nmax_cpu_cores = int(os.getenv(\"MAX_CPU_CORES\", 4))\n_pool = concurrent.futures.ThreadPoolExecutor(max_workers=min(max_cpu_cores, (os.cpu_count() or 1)))\n\ndef func_impl(param):\n    return param\n\nasync def func():\n    param = \"hello\"\n    loop = asyncio.get_running_loop()\n    result = await loop.run_in_executor(_pool, func_impl, param)\n    return result\n</code></pre> Python <pre><code>import asyncio\nimport concurrent.futures\nimport time\n\nasync def worker_async(id):\n    print(f\"Async task {id} started\")\n    await asyncio.sleep(2)  # \u6a21\u62dfI/O\u64cd\u4f5c\n    print(f\"Async task {id} finished\")\n\ndef worker_process(id):\n    print(f\"Process {id} started\")\n    time.sleep(2)  # \u6a21\u62dfCPU\u5bc6\u96c6\u578b\u64cd\u4f5c\n    print(f\"Process {id} finished\")\n\nasync def main():\n    loop = asyncio.get_running_loop()\n    num_async_tasks = 3\n    num_processes = 2\n\n    async_tasks = [worker_async(i) for i in range(num_async_tasks)]\n\n    with concurrent.futures.ProcessPoolExecutor(max_workers=num_processes) as executor:\n        process_tasks = [loop.run_in_executor(executor, worker_process, i) for i in range(num_processes)]\n\n        await asyncio.gather(*async_tasks, *process_tasks)\n\nif __name__ == \"__main__\":\n    asyncio.run(main())\n</code></pre>"},{"location":"CodeSnippets/ShareMemory/","title":"\u5171\u4eab\u5185\u5b58","text":"<p>C++ Only?</p> <p>\u7531\u4e8epython\u4e2d\u5904\u7406\u591a\u8fdb\u7a0b\uff08multiprocess\uff09\u8981\u6bd4C++\u7b80\u6d01\u5f88\u591a\uff0c\u8fd9\u91cc\u5c31\u4e0d\u4e3e\u4f8b\u4e86</p> C++ \u4f7f\u7528name\u7684\u65b9\u5f0f\u4f7f\u7528key\u7684\u65b9\u5f0f \u521b\u5efa<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt; \n#include &lt;iostream&gt;\n\nint main() {\n    const char *name = \"/my_shared_memory\";\n    const size_t SIZE = 4096;  // \u5927\u5c0f\u4e3a4KB\n\n    int shm_fd = shm_open(name, O_CREAT | O_RDWR, 0666);\n    if (shm_fd == -1) {\n        std::cerr &lt;&lt; \"shm_open failed\\n\";\n        return 1;\n    }\n\n    if (ftruncate(shm_fd, SIZE) == -1) {\n        std::cerr &lt;&lt; \"ftruncate failed\\n\";\n        return 1;\n    }\n\n    void *ptr = mmap(0, SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, shm_fd, 0);\n    if (ptr == MAP_FAILED) {\n        std::cerr &lt;&lt; \"mmap failed\\n\";\n        return 1;\n    }\n\n    std::cout &lt;&lt; \"Shared memory created and mapped successfully\\n\";\n\n    return 0;\n}\n</code></pre> \u540c\u6b65<pre><code>#include &lt;fcntl.h&gt;\n#include &lt;sys/mman.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;iostream&gt;\n#include &lt;semaphore.h&gt;\n#include &lt;cstring&gt;\n\nconst char *name = \"/my_shared_memory\";\nconst size_t SIZE = 4096;\nconst char *sem_name = \"/my_semaphore\";\n\nint main() {\n    sem_t *sem = sem_open(sem_name, O_CREAT, 0666, 1);\n    if (sem == SEM_FAILED) {\n        std::cerr &lt;&lt; \"sem_open failed\\n\";\n        return 1;\n    }\n\n    int shm_fd = shm_open(name, O_CREAT | O_RDWR, 0666);\n    if (shm_fd == -1) {\n        std::cerr &lt;&lt; \"shm_open failed\\n\";\n        return 1;\n    }\n\n    if (ftruncate(shm_fd, SIZE) == -1) {\n        std::cerr &lt;&lt; \"ftruncate failed\\n\";\n        return 1;\n    }\n\n    void *ptr = mmap(0, SIZE, PROT_READ | PROT_WRITE, MAP_SHARED, shm_fd, 0);\n    if (ptr == MAP_FAILED) {\n        std::cerr &lt;&lt; \"mmap failed\\n\";\n        return 1;\n    }\n\n    sem_wait(sem);\n\n    strcpy((char *)ptr, \"Hello, shared memory!\");\n\n    sem_post(sem);\n\n    return 0;\n}\n</code></pre> \u521b\u5efa<pre><code>int s_shmem_key = 888666;\nint s_sem_id = -1;\nint s_shmid = -1;\nint s_shmsize = 123;\nvoid *s_pshm = NULL;\nint init_shm() {\n    if ((s_shmid = shmget(key_t(s_shmem_key), s_shmsize, 0666 | IPC_CREAT)) &lt; 0) {\n        printf(\"shmget fail %s\", strerror(errno));\n        return -1;\n    }\n    s_pshm = shmat(s_shmid, 0, 0);\n    if (s_pshm == (void*) -1) {\n        printf(\"shmat fail %s\", strerror(errno));\n        return -1;\n    }\n\n    ((char *)s_pshm)[s_shmsize - 1] = '\\0';\n\n    return 0;\n}\n</code></pre> \u540c\u6b65<pre><code>int sync_shm(int shmid, int semid) {\ns_shmid = shmid;\ns_sem_id = semid;\n\nif (s_shmid &lt; 0 || s_sem_id &lt; 0) {\n    return -1;\n}\n\ns_pshm = shmat(s_shmid, 0, 0);\nif (s_pshm == (void*) -1) {\n    printf(\"shmat fail %s\", strerror(errno));\n    return -1;\n}\n\n((char *)s_pshm)[s_shmsize - 1] = '\\0';\n\nreturn 0;\n}\n</code></pre>"},{"location":"CodeSnippets/TraversalFiles/","title":"\u6587\u4ef6\u904d\u5386","text":"C++Python filesystemdirent.h <pre><code>#include &lt;iostream&gt;\n#include &lt;filesystem&gt;\n\nnamespace fs = std::filesystem;\n\nint main() {\n    std::string path = \".\";\n\n    try {\n        for (const auto&amp; entry : fs::directory_iterator(path)) {\n            std::cout &lt;&lt; entry.path() &lt;&lt; std::endl;\n        }\n    } catch (const fs::filesystem_error&amp; e) {\n        std::cerr &lt;&lt; \"Filesystem error: \" &lt;&lt; e.what() &lt;&lt; std::endl;\n    } catch (const std::exception&amp; e) {\n        std::cerr &lt;&lt; \"General exception: \" &lt;&lt; e.what() &lt;&lt; std::endl;\n    }\n\n    return 0;\n}\n</code></pre> <pre><code>#include &lt;iostream&gt;\n#include &lt;dirent.h&gt;\n#include &lt;cstring&gt;\n\nint main() {\n    const char *path = \".\";\n    DIR *dir = opendir(path);\n\n    if (dir == nullptr) {\n        std::cerr &lt;&lt; \"Error opening directory: \" &lt;&lt; std::strerror(errno) &lt;&lt; std::endl;\n        return 1;\n    }\n\n    struct dirent *entry;\n    while ((entry = readdir(dir)) != nullptr) {\n        std::cout &lt;&lt; entry-&gt;d_name &lt;&lt; std::endl;\n    }\n\n    closedir(dir);\n    return 0;\n}\n</code></pre> os.walk <pre><code>import os\n\ndef list_files(startpath):\n    for root, dirs, files in os.walk(startpath):\n        for name in files:\n            print(os.path.join(root, name))\n        for name in dirs:\n            print(os.path.join(root, name))\n\nstart_directory = '.'\nlist_files(start_directory)\n</code></pre>"},{"location":"blog/","title":"Blog","text":""},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/","title":"\u7b80\u6613docker\u4f7f\u7528\u624b\u518c","text":""},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_1","title":"\u62c9\u53d6\u4e0e\u63a8\u9001\u955c\u50cf","text":""},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_2","title":"\u62c9\u53d6\u955c\u50cf","text":"<p>\u901a\u5e38\u53ef\u4ee5\u5728DockerHub\u8fd9\u91cc\u641c\u7d22\u4f60\u60f3\u8981\u7684\u955c\u50cf</p> <p><pre><code>docker pull ubuntu:20.04\n</code></pre> \u6216\u8005\u6307\u5b9asha\u6765\u62c9\u53d6\u7279\u5b9a\u7248\u672c(\u4f8b\u5982armv8\u7684\u7248\u672c) <pre><code>docker pull ubuntu:20.04@sha256:0b897358ff6624825fb50d20ffb605ab0eaea77ced0adb8c6a4b756513dec6fc\n</code></pre></p>"},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_3","title":"\u63a8\u9001\u955c\u50cf","text":"<p>\u4e00\u822c\u60c5\u51b5\u4e0b\u90fd\u4f1a\u9700\u8981\u5148\u767b\u5f55\u5230\u5e0c\u671b\u63a8\u9001\u7684\u4ed3\u5e93(\u793a\u4f8bregistry.myharbor.com) <pre><code>docker login -u user registry.myharbor.com\n</code></pre></p> <pre><code>docker push registry.myharbor.com/ubuntu:focal\n</code></pre>"},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_4","title":"\u5982\u4f55\u6362\u6e90","text":"<p>\u4e5f\u8bb8\u4f1a\u9700\u8981\u7528\u5230\u4ee3\u7406\uff0c\u6216\u8005\u5e72\u8106\u4f7f\u7528\u56fd\u5185\u7684\u6e90</p> <p>\u76ee\u524d\u56fd\u5185\u6e90\uff08\u4f8b\u5982\u963f\u91cc\u4e91\uff09\u57fa\u672c\u4e0a\u53ea\u652f\u6301\u5c11\u91cf\u7684\u516c\u5171\u955c\u50cf\u4e0b\u8f7d\uff0c\u5982\u679c\u662f\u672c\u5730\u673a\u5668\uff0c\u5efa\u8bae\u8d70\u4ee3\u7406\u4e0b\u8f7d\u3002</p> <p>\u8fd9\u91cc\u4ee5\u534e\u4e3a\u4e91\u4e3e\u4f8b\uff0c\u6253\u5f00docker\u7684\u914d\u7f6e\u6587\u4ef6\uff0c\u5982\u679c\u662f\u65b0\u5b89\u88c5\u7684docker\uff0c\u8fd9\u91cc\u53ef\u80fd\u6ca1\u6709\u8fd9\u4e2a\u6587\u4ef6\uff0c\u521b\u5efa\u4e00\u4e2a\u5c31\u53ef\u4ee5\u3002</p> <pre><code>sudo vim /etc/docker/daemon.json\n</code></pre> <p>\u586b\u5165\u6211\u4eec\u60f3\u52a0\u5165\u7684\u6e90\uff0c\u4f8b\u5982\u534e\u4e3a\u4e91\uff1a<code>https://mirrors.huaweicloud.com/</code>\uff0c\u50cf\u8fd9\u6837\uff1a</p> <pre><code>{\n  \"registry-mirrors\": [ \n    \"https://mirrors.huaweicloud.com/\"\n  ]\n}\n</code></pre> <p>\u7136\u540e\u91cd\u542fdocker\u670d\u52a1\uff1a</p> <pre><code>sudo systemctl daemon-reload\nsudo systemctl restart docker\n</code></pre> <p>\u8fd9\u6837\u5c31\u5b8c\u6210\u4e86\u6362\u6e90\u64cd\u4f5c\u3002</p>"},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_5","title":"\u8fdb\u5165\u5bb9\u5668\u5f00\u53d1","text":""},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_6","title":"\u542f\u52a8\u5bb9\u5668","text":"<p>\u200b   \u7b80\u5355\u7684\u793a\u4f8b\uff1a<code>docker run -ti --rm --net=host --name=test image:tag</code></p> <p>\u200b   \u793a\u4f8b\u5e38\u89c1\u53c2\u6570\uff1a</p> \u53c2\u6570\u540d \u529f\u80fd <code>-ti</code> t\u548ci\u4e24\u4e2a\u53c2\u6570\u901a\u5e38\u4e00\u8d77\u4f7f\u7528\uff0c\u4ea4\u4e92\u5f0f\u542f\u52a8\u5bb9\u5668 <code>--rm</code> \u505c\u6b62\u5bb9\u5668\u540e\u81ea\u52a8\u5220\u9664\uff0c\u5e38\u89c1\u4e8e\u5f00\u53d1\u65f6\uff0c\u907f\u514d\u65e7\u5bb9\u5668\u5806\u79ef <code>--net=host</code> \u4e0e-p\u91cd\u53e0\uff0c\u4f7f\u7528\u5bbf\u4e3b\u673a\u7f51\u5361\uff0c\u6620\u5c04\u5168\u90e8\u7aef\u53e3 <code>-p</code> -p port:port\uff0c\u6620\u5c04\u5bb9\u5668\u5185\u7aef\u53e3\u5230\u5bbf\u4e3b\u673a\u7aef\u53e3\uff0c\u53ef\u4ee5\u6279\u91cf\u6307\u5b9a <code>--name</code> \u4e3a\u5bb9\u5668\u8bbe\u7f6e\u540d\u79f0\uff0c\u9ed8\u8ba4\u4f1a\u4f7f\u7528\u4e00\u4e2ahash\u503c\u4f5c\u4e3a\u5bb9\u5668\u540d <code>-v</code> \u6302\u8f7d\u5916\u90e8\u76ee\u5f55\u5230\u5bb9\u5668\u5185\uff0c\u4f1a\u8986\u76d6\u5bb9\u5668\u5185\u5df2\u5b58\u5728\u7684\u76ee\u5f55\u3002\u597d\u5904\u662f\u53ef\u4ee5\u5916\u90e8\u4fee\u6539\u6216\u5373\u65f6\u5907\u4efd\uff0c\u53ef\u4ee5\u5229\u7528\u6302\u8f7d\u5b9e\u73b0\u4e00\u4e9b\u52a8\u6001\u6548\u679c <p>\u8fd8\u6709\u5f88\u591a\u6709\u7528\u53c2\u6570\u53ef\u89c1Docker\u5b98\u65b9\u6587\u6863</p>"},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_7","title":"\u6302\u8f7d\u76ee\u5f55","text":"<p>\u5927\u591a\u6570\u65f6\u5019\u6211\u4eec\u8fd8\u662f\u5e0c\u671b\u5373\u65f6\u7684\u4fee\u6539\u5de5\u7a0b\u4ee3\u7801</p> <p>\u6761\u4ef6\u5141\u8bb8\u7684\u8bdd\u6211\u731c\u4f60\u4e0d\u4f1a\u559c\u6b22\u5728\u5bb9\u5668\u91cc\u7528\u7ec8\u7aef\u5199\u4ee3\u7801\u7684</p> <p>\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u5de5\u7a0b\u6302\u8f7d\u5230\u5bb9\u5668\u91cc</p> <pre><code>docker run -ti -v /path/to/project/folder:/path/to/folder image:tag\n</code></pre> <p>\u4f8b\u5982\u8fd9\u6837\u6211\u4eec\u628a\u5bbf\u4e3b\u673a\u4e0a\u7684<code>/path/to/project/folder</code>\u76ee\u5f55\u6302\u8f7d\u5230\u4e86\u5bb9\u5668\u91cc\u7684<code>/path/to/folder</code>\u76ee\u5f55\uff0c\u76f8\u5f53\u4e8e\u6620\u5c04\u5173\u7cfb\u3002</p>"},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_8","title":"\u9650\u5236\u8d44\u6e90\u6216\u4f20\u9012\u9ed8\u8ba4\u73af\u5883\u53d8\u91cf","text":"<p>\u6709\u65f6\u5019\u6211\u4eec\u5e76\u4e0d\u5e0c\u671b\u8fd9\u4e2a\u5bb9\u5668\u62ff\u8d70\u673a\u5668\u4e0a\u5168\u90e8\u7684\u8d44\u6e90\uff0c\u5c24\u5176\u662f\u505a\u6027\u80fd\u6d4b\u8bd5\u7684\u65f6\u5019</p> <pre><code>docker run -ti --cpus=16 image:tag\n</code></pre> <ul> <li> <p>\u4f7f\u7528<code>--cpus=16</code>\u9650\u5236\u5bb9\u5668\u53ea\u80fd\u6700\u591a\u7528\u5230<code>1600%</code>\u7684CPU\u6838\u5fc3\u8d44\u6e90\uff0c\u8fd9\u5e76\u4e0d\u610f\u5473\u7740\u4e00\u5b9a\u662f16\u4e2a\u6838\u5fc3\uff0c\u4e5f\u53ef\u80fd\u662f32\u6838\u5fc3\u6bcf\u4e2a\u7528\u4e00\u534a</p> </li> <li> <p>\u4f7f\u7528<code>--cpu-shares</code>\u9009\u9879\u53ef\u4ee5\u8bbe\u7f6e CPU \u5171\u4eab\u6743\u91cd\uff0c\u6743\u91cd\u7684\u9ed8\u8ba4\u503c\u662f1024\uff0c\u6bcf\u4e2a\u542f\u52a8\u7684\u5bb9\u5668\u5728\u4ed6\u4eec\u9700\u8981\u7684\u65f6\u5019\uff0c\u90fd\u4f1a\u6309\u6743\u91cd\u62a2\u5360\u53ef\u7528\u7684CPU\u8d44\u6e90</p> </li> <li> <p>\u4f7f\u7528<code>--cpu-period</code>\u548c<code>--cpu-quota</code>\u9009\u9879\u53ef\u4ee5\u9650\u5236\u5bb9\u5668\u7684 CPU \u4f7f\u7528\u65f6\u95f4\u3002</p> </li> </ul> <p>\u4f8b\u5982<code>--cpu-period=100000 --cpu-quota=25000</code>\u8868\u793a\u5728\u6bcf 100ms \u7684\u65f6\u95f4\u5468\u671f\u5185\uff0c\u5bb9\u5668\u6700\u591a\u53ea\u80fd\u4f7f\u7528 25ms \u7684 CPU \u65f6\u95f4\u3002</p> <ul> <li>\u4f7f\u7528<code>-m</code>\u6216<code>--memory</code>\u9009\u9879\u53ef\u4ee5\u6307\u5b9a\u5bb9\u5668\u7684\u6700\u5927\u5185\u5b58\u4f7f\u7528\u91cf\u3002</li> </ul> <p>\u4f8b\u5982<code>-m 512m</code>\u6216\u662f<code>-m 1G</code></p> <pre><code>docker run -ti -e MY_ENV=my_env image:tag\n</code></pre> <p>\u4f7f\u7528\u53c2\u6570<code>-e</code>\u5c31\u53ef\u4ee5\u4e3a\u5bb9\u5668\u4f20\u9012\u4e00\u4e2a\u9ed8\u8ba4\u7684\u73af\u5883\u53d8\u91cf\uff0c\u5f53\u7136\uff0c\u8fdb\u5165\u5bb9\u5668\u540e\u4ecd\u7136\u53ef\u4ee5\u6539\u53d8\u4ed6\u4eec</p>"},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_9","title":"\u4fdd\u5b58\u4e0e\u6784\u5efa\u955c\u50cf","text":""},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_10","title":"\u4fdd\u5b58","text":"<p>docker save \u53ef\u4ee5\u5c06\u4e00\u4e2a\u955c\u50cf\u6253\u5305\u6210tar\u5305\uff0c\u4ee5\u4fbf\u4e8e\u4f60\u53d1\u5e03\u5b83 <pre><code>docker save -o name_of_image.tar image:tag\n</code></pre></p> <p>docker commit \u53ef\u4ee5\u5c06\u4e00\u4e2a\u6b63\u5728\u8fd0\u884c\u7684\u5bb9\u5668\u4fdd\u5b58\u6210\u955c\u50cf\uff0c\u5f53\u7136\u8fd9\u4f1a\u4fdd\u5b58\u8fd9\u4e2a\u5bb9\u5668\u5f53\u524d\u7684\u6240\u6709\u72b6\u6001\uff0c\u8bf7\u4e0d\u8981\u5728\u53d1\u5e03\u955c\u50cf\u65f6\u8fd9\u4e48\u505a\u5594 <pre><code>docker commit container_id image:tag\n</code></pre></p>"},{"location":"blog/2023/11/04/%E7%AE%80%E6%98%93docker%E4%BD%BF%E7%94%A8%E6%89%8B%E5%86%8C/#_11","title":"\u6784\u5efa\u955c\u50cf","text":"<p>\u5229\u7528dockerfile\u5b9e\u73b0\u955c\u50cf\u6253\u5305\uff0c\u8be6\u7ec6\u7684\u4f7f\u7528\u65b9\u5f0f\u53ef\u89c1\u5b98\u65b9\u6587\u6863</p> <p>build\u65f6\u53ef\u4ee5\u9009\u62e9\u4e0a\u4f20\u7684\u7f13\u5b58\u76ee\u5f55\uff0c\u50cf\u8fd9\u6837<code>docker build -f dockerfile -t image:new_tag .</code>\uff0c\u6700\u540e\u7684<code>.</code>\u5373\u8868\u793a\u4f7f\u7528\u5f53\u524d\u76ee\u5f55\u4f5c\u4e3a\u7f13\u5b58\u4e0a\u4f20\u3002</p> <p>\u955c\u50cf\u6784\u5efa\u901a\u5e38\u7528\u4e8e\u53bb\u6389\u4e00\u4e9b\u4e0d\u5fc5\u8981\u7684layer\uff0c\u6765\u5c3d\u53ef\u80fd\u51cf\u5c0f\u955c\u50cf\u4f53\u79ef\uff0c\u5e76\u4e14\u5c06\u53d8\u52a8\u5c42\u7f6e\u540e\uff0c\u6709\u5229\u4e8e\u955c\u50cf\u4ed3\u5e93\u66f4\u597d\u7684\u7ba1\u7406\u3002\u8d44\u6599</p> <p>\u5728\u81ea\u52a8\u5316\u6784\u5efa\u4e2d\uff0c\u8fd8\u53ef\u4ee5\u5229\u7528\u591a\u6b21FROM\u5b9e\u73b0\u9694\u79bb\uff0c\u53ea\u9009\u53d6\u5fc5\u8981\u7684\u5185\u5bb9\u6dfb\u52a0\u5230\u6700\u7ec8\u7684\u955c\u50cf\u91cc\u3002</p>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/","title":"\u8c03\u8bd5\u5c0f\u5e2e\u624bGDB","text":""},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_1","title":"\u7b80\u5355\u7684\u4ecb\u7ecd","text":"<p>c++\u5de5\u7a0b\u5f88\u591a\u65f6\u5019\u56e0\u4e3a\u6d89\u53ca\u5230\u5927\u91cf\u7684\u4e09\u65b9\u5e93\u548c\u6846\u67b6\uff0c\u8c03\u8bd5\u8d77\u6765\u5e76\u4e0d\u90a3\u4e48\u5bb9\u6613\u3002\u8fd9\u65f6\u5019\u5c31\u9700\u8981GDB\u6765\u625b\u8d77\u8fd9\u4e2a\u8c03\u8bd5\u5927\u65d7\u4e86\u3002</p> <p>\u5b83\u53ef\u4ee5\u8bbe\u7f6e\u65ad\u70b9\u3001\u5355\u6b65\u6267\u884c\u4ee3\u7801\u3001\u67e5\u770b\u8c03\u7528\u6808\uff0c\u5206\u6790\u7a0b\u5e8f\u7684\u5d29\u6e83\u539f\u56e0\u3002\u5728\u4e00\u4e9b\u610f\u6599\u4e4b\u5916\u7684\u60c5\u51b5\u53d1\u751f\u7684\u65f6\u5019\uff0c\u907f\u514d\u76f4\u63a5\u4fee\u6539\u6e90\u7801\u800c\u53c8\u53ef\u4ee5\u5feb\u901f\u6392\u67e5\u95ee\u9898\u3002</p>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_2","title":"\u524d\u7f6e","text":"<p>\u8fd9\u91cc\u5047\u8bbe\u6211\u4eec\u4f7f\u7528cmake\u4f5c\u4e3ac++\u5de5\u7a0b\u7684\u6784\u5efa\u5de5\u5177</p> <ul> <li>\u8bbe\u7f6e\u6784\u5efa\u7c7b\u578b\u4e3adebug   \u5982\u679c\u662f\u53ef\u6267\u884c\u6587\u4ef6\uff0c\u53ef\u4ee5\u76f4\u63a5\u52a0\u5728\u547d\u4ee4\u91cc\uff1a   <pre><code>cmake -DCMAKE_BUILD_TYPE=Debug ..\n</code></pre></li> </ul> <p>\u5f53\u7136\uff0c\u66f4\u63a8\u8350\u4ee5\u53c2\u6570\u7684\u5f62\u5f0f\u52a0\u5728cmake\u6587\u4ef6\u91cc\uff1a   <pre><code>set(CMAKE_BUILD_TYPE Debug)\n</code></pre></p> <ul> <li> <p>\u6216\u8005\u624b\u52a8\u8bbe\u7f6e\u8c03\u8bd5\u6807\u8bb0   <pre><code>set(CMAKE_CXX_FLAGS_DEBUG \"${CMAKE_CXX_FLAGS_DEBUG} -g\")\n</code></pre></p> </li> <li> <p>\u6709\u65f6\u4f60\u4e0d\u4f1a\u60f3\u7f16\u8bd1\u5668\u5e2e\u4f60\u4f18\u5316\u4e86\u4e9b\u4ec0\u4e48\u7684, \u52a0\u4e0a\u6807\u8bb0\u5173\u95ed\u5b83\u5427 <pre><code>set(CMAKE_CXX_FLAGS_DEBUG \"${CMAKE_CXX_FLAGS_DEBUG} -O0\")\n</code></pre></p> </li> </ul> <p>\u5982\u679c\u4f60\u8981\u8c03\u8bd5\u7684\u662f\u7b2c\u4e09\u65b9\u5e93(\u4f8b\u5982xxx.so)\uff0c\u90a3\u5c31\u9700\u8981\u5b83\u5728\u7f16\u8bd1\u7684\u65f6\u5019\u662f\u5e26\u4e86\u8c03\u8bd5\u6807\u8bb0\u7684\u3002</p>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_3","title":"\u8c03\u8bd5","text":""},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_4","title":"\u65ad\u70b9\u578b","text":"<p>\u8fd9\u79cd\u65b9\u6848\u9002\u5408\u90a3\u4e9b\u4f60\u6709\u6e90\u7801\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u7ba1\u95ee\u9898\u662f\u4e0d\u662f\u6700\u7ec8\u4f1a\u5bfc\u81f4\u4e2d\u65ad\uff0c\u90fd\u53ef\u4ee5\u6392\u67e5\u5f02\u5e38\u51fa\u73b0\u7684\u5177\u4f53\u4f4d\u7f6e\u3002</p> <ol> <li> <p>\u542f\u52a8</p> <pre><code>gdb ./program\n</code></pre> <p>\u4f7f\u7528<code>run</code>\u6216\u8005<code>r</code>\u542f\u52a8\u53ef\u6267\u884c\u7a0b\u5e8f</p> <p>\u5982\u679c\u8981\u52a0\u53c2\u6570\uff0c\u548c\u6b63\u5e38\u542f\u52a8\u4e00\u6837\u8bbe\u7f6e\u5373\u53ef\uff0c\u4f8b\u5982 <pre><code>r -p 1234\n</code></pre></p> </li> <li> <p>\u65ad\u70b9\u7684\u8bbe\u7f6e\u548c\u5220\u9664</p> <p>\u4f7f\u7528<code>list</code>\u6216\u8005<code>l</code>\u67e5\u770b\u4ee3\u7801 <pre><code>l test.cpp:10\n</code></pre></p> <p>\u4f7f\u7528<code>break</code>\u6216\u8005<code>b</code>\u8bbe\u7f6e\u65ad\u70b9 <pre><code>b test.cpp:11\n</code></pre></p> <p>\u4f7f\u7528<code>info b</code>\u67e5\u770b\u8bbe\u7f6e\u7684\u65ad\u70b9 <pre><code>info b\n</code></pre></p> <p>\u4f7f\u7528<code>delete &lt;number&gt;</code>\u6216\u8005<code>d &lt;number&gt;</code>\u5220\u9664\u65ad\u70b9(\u7f16\u53f7) <pre><code>d 1\n</code></pre></p> <p>\u6216\u8005\u4f7f\u7528<code>disable</code>\u548c<code>enable</code>\u6765\u7981\u7528/\u542f\u7528\u65ad\u70b9 <pre><code>disable 1\n\nenable 1\n</code></pre></p> </li> <li> <p>\u6253\u5370\u548c\u4fee\u6539\u53d8\u91cf</p> <p>\u4f7f\u7528<code>print</code>\u6216\u8005<code>p</code>\u6253\u5370\u53d8\u91cf <pre><code>p input\n</code></pre></p> <p>\u4f7f\u7528<code>set</code>\u4e3a\u53d8\u91cf\u8bbe\u7f6e\u65b0\u7684\u503c <pre><code>set int v = 10\n</code></pre></p> </li> <li> <p>\u67e5\u770b\u5806\u6808</p> <p>\u4f7f\u7528<code>backtrace</code>\u6216\u8005<code>bt</code>\u6253\u5370\u5806\u6808\u4fe1\u606f(\u901a\u5e38\u662f\u5728\u4e2d\u65ad\u53d1\u751f\u65f6) <pre><code>bt\n</code></pre></p> </li> <li> <p>\u9010\u6b65\u8fd0\u884c</p> <ul> <li> <p>\u4f7f\u7528<code>next</code>\u6216\u8005<code>n</code>\u5355\u6b65\u6267\u884c\u4e0b\u4e00\u884c\u4ee3\u7801</p> </li> <li> <p>\u4f7f\u7528<code>step</code>\u6216\u8005<code>s</code>\u8fdb\u5165\u51fd\u6570</p> </li> <li> <p>\u4f7f\u7528<code>continue</code>\u6216\u8005<code>c</code>\u6267\u884c\u76f4\u5230\u7ed3\u675f\u6216\u4e0b\u4e2a\u65ad\u70b9</p> </li> </ul> </li> </ol>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_5","title":"\u8fdb\u7a0b\u578b","text":"<p>\u8fd9\u79cd\u65b9\u6848\u9002\u5408\u4f60\u6ca1\u6709\u6e90\u7801\uff0c\u6216\u8005\u4f60\u7684\u4ea7\u54c1\u5e76\u4e0d\u662f\u4e2a\u4e00\u6b21\u6027\u8fd0\u884c\u7684\u4e1c\u897f(\u4f8b\u5982\u5b83\u662f\u4e2ahttp\u670d\u52a1)\uff0c\u540c\u65f6\u9700\u8981\u95ee\u9898\u80fd\u591f\u89e6\u53d1\u53ef\u6267\u884c\u7a0b\u5e8f\u8fd0\u884c\u65f6\u4e2d\u65ad\u3002</p> <p>\u4f8b\u5982\u7528<code>ps -ef</code>\u914d\u5408<code>grep</code>\u627e\u5230\u4f60\u7684\u8fdb\u7a0bid\uff0c\u7136\u540e\u50cf\u8fd9\u6837\u5c06gdb\u9644\u52a0\u5230\u8fdb\u7a0b\u4e0a</p> <pre><code>gdb attach 12345\n</code></pre> <p>\u7136\u540e\u4f60\u5c31\u80fd\u50cf\u8c03\u8bd5\u53ef\u6267\u884c\u7a0b\u5e8f\u90a3\u6837\u8c03\u8bd5\u8fdb\u7a0b\u4e86\uff0c\u8bb0\u5f97\u9000\u51fa\u65f6\u7528<code>detach</code>\u5206\u79bb\u3002</p>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_6","title":"\u66f4\u591a\u529f\u80fd","text":""},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_7","title":"\u6761\u4ef6\u65ad\u70b9","text":"<p>GDB \u652f\u6301\u6761\u4ef6\u65ad\u70b9\uff0c\u5373\u53ea\u6709\u5728\u6ee1\u8db3\u7279\u5b9a\u6761\u4ef6\u65f6\uff0c\u7a0b\u5e8f\u624d\u4f1a\u5728\u65ad\u70b9\u5904\u6682\u505c\u3002\u4f8b\u5982\uff1a</p> <pre><code>(gdb) break my_function if x == 5\n</code></pre> <p>\u8fd9\u5c06\u5728 <code>x == 5</code> \u65f6\u89e6\u53d1 <code>my_function</code> \u7684\u65ad\u70b9\u3002</p>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_8","title":"\u76d1\u89c6\u53d8\u91cf","text":"<p>GDB \u53ef\u4ee5\u76d1\u89c6\u67d0\u4e2a\u53d8\u91cf\u6216\u5185\u5b58\u4f4d\u7f6e\u7684\u53d8\u5316\uff0c\u5f53\u5176\u503c\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u7a0b\u5e8f\u4f1a\u6682\u505c\u6267\u884c\u3002\u8fd9\u5bf9\u4e8e\u8c03\u8bd5\u5185\u5b58\u95ee\u9898\u975e\u5e38\u6709\u7528\uff1a</p> <pre><code>(gdb) watch my_variable\n</code></pre> <p>\u6216\u76d1\u89c6\u5185\u5b58\u5730\u5740\uff1a</p> <pre><code>(gdb) watch *0x601040\n</code></pre>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_9","title":"\u9006\u5411\u8c03\u8bd5","text":"<p>GDB \u652f\u6301\u5728\u67d0\u4e9b\u5e73\u53f0\u4e0a\u8fdb\u884c\u9006\u5411\u8c03\u8bd5\uff0c\u5373\u4f60\u53ef\u4ee5\u5012\u9000\u7a0b\u5e8f\u7684\u6267\u884c\uff0c\u67e5\u770b\u4e4b\u524d\u7684\u72b6\u6001\u3002\u8fd9\u5728\u8c03\u8bd5\u590d\u6742\u95ee\u9898\u65f6\u975e\u5e38\u6709\u5e2e\u52a9\uff1a</p> <pre><code>(gdb) reverse-continue\n(gdb) reverse-step\n</code></pre>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_10","title":"\u8c03\u8bd5\u591a\u7ebf\u7a0b\u7a0b\u5e8f","text":"<p>GDB \u652f\u6301\u8c03\u8bd5\u591a\u7ebf\u7a0b\u7a0b\u5e8f\uff0c\u4f60\u53ef\u4ee5\u67e5\u770b\u548c\u63a7\u5236\u5404\u4e2a\u7ebf\u7a0b\uff1a</p> <ul> <li>\u5217\u51fa\u6240\u6709\u7ebf\u7a0b\uff1a</li> </ul> <pre><code>(gdb) info threads\n</code></pre> <ul> <li>\u5207\u6362\u5230\u7279\u5b9a\u7ebf\u7a0b\uff1a</li> </ul> <pre><code>(gdb) thread [thread-number]\n</code></pre> <ul> <li>\u8bbe\u7f6e\u7ebf\u7a0b\u7279\u5b9a\u7684\u65ad\u70b9\uff1a</li> </ul> <pre><code>(gdb) break my_function thread 2\n</code></pre>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_11","title":"\u8c03\u8bd5\u5171\u4eab\u5e93","text":"<p>GDB \u652f\u6301\u8c03\u8bd5\u52a0\u8f7d\u7684\u5171\u4eab\u5e93\uff08\u52a8\u6001\u94fe\u63a5\u5e93\uff09\u3002\u4f60\u53ef\u4ee5\u5728\u5171\u4eab\u5e93\u4e2d\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5e76\u67e5\u770b\u5171\u4eab\u5e93\u7684\u52a0\u8f7d\u60c5\u51b5\uff1a</p> <ul> <li>\u67e5\u770b\u52a0\u8f7d\u7684\u5171\u4eab\u5e93\uff1a</li> </ul> <pre><code>(gdb) info sharedlibrary\n</code></pre> <ul> <li>\u5728\u5171\u4eab\u5e93\u4e2d\u8bbe\u7f6e\u65ad\u70b9\uff1a</li> </ul> <pre><code>(gdb) break my_shared_library.c:42\n</code></pre>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_12","title":"\u811a\u672c\u5316\u8c03\u8bd5","text":"<p>GDB \u652f\u6301\u4f7f\u7528 Python \u811a\u672c\u6765\u6269\u5c55\u548c\u81ea\u52a8\u5316\u8c03\u8bd5\u4efb\u52a1\u3002\u4f60\u53ef\u4ee5\u7f16\u5199 Python \u811a\u672c\u6765\u81ea\u52a8\u5316\u8c03\u8bd5\u6b65\u9aa4\u6216\u89e3\u6790\u8c03\u8bd5\u6570\u636e\uff1a</p> <pre><code># example.py\nimport gdb\nclass HelloWorld(gdb.Command):\n    def __init__(self):\n        super(HelloWorld, self).__init__(\"hello\", gdb.COMMAND_USER)\n\n    def invoke(self, arg, from_tty):\n        print(\"Hello, GDB World!\")\nHelloWorld()\n</code></pre> <p>\u5728 GDB \u4e2d\u52a0\u8f7d\u5e76\u8fd0\u884c\u811a\u672c\uff1a</p> <pre><code>(gdb) source example.py\n(gdb) hello\n</code></pre>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_13","title":"\u5185\u5b58\u68c0\u67e5","text":"<p>GDB \u53ef\u4ee5\u76f4\u63a5\u68c0\u67e5\u548c\u64cd\u4f5c\u5185\u5b58\u5185\u5bb9\uff1a</p> <ul> <li>\u67e5\u770b\u5185\u5b58\u5185\u5bb9\uff1a</li> </ul> <pre><code>(gdb) x/16xw 0x601000\n</code></pre> <p>\u8fd9\u91cc\u7684 <code>x/16xw</code> \u8868\u793a\u4ee5 16 \u4e2a\u5b57\u7684\u5bbd\u5ea6\u663e\u793a\u5185\u5b58\u5185\u5bb9\u3002</p> <ul> <li>\u4fee\u6539\u5185\u5b58\u5185\u5bb9\uff1a</li> </ul> <pre><code>(gdb) set {int}0x601000 = 42\n</code></pre>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_14","title":"\u8bb0\u5f55\u548c\u91cd\u653e\u8c03\u8bd5\u4f1a\u8bdd","text":"<p>GDB \u5141\u8bb8\u4f60\u8bb0\u5f55\u8c03\u8bd5\u4f1a\u8bdd\uff0c\u7a0d\u540e\u53ef\u4ee5\u91cd\u653e\u8be5\u4f1a\u8bdd\u4ee5\u91cd\u590d\u5206\u6790\u95ee\u9898\uff1a</p> <pre><code>(gdb) record\n(gdb) replay\n</code></pre>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_15","title":"\u7b26\u53f7\u8868\u64cd\u4f5c","text":"<p>GDB \u53ef\u4ee5\u52a0\u8f7d\u3001\u5378\u8f7d\u548c\u64cd\u4f5c\u7b26\u53f7\u8868\uff0c\u8fd9\u5728\u8c03\u8bd5\u591a\u6a21\u5757\u7a0b\u5e8f\u65f6\u975e\u5e38\u6709\u7528\uff1a</p> <ul> <li>\u52a0\u8f7d\u7b26\u53f7\u8868\uff1a</li> </ul> <pre><code>(gdb) symbol-file my_program\n</code></pre> <ul> <li>\u5378\u8f7d\u7b26\u53f7\u8868\uff1a</li> </ul> <pre><code>(gdb) remove-symbol-file my_program\n</code></pre>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_16","title":"\u6838\u5fc3\u8f6c\u50a8\u6587\u4ef6\u8c03\u8bd5","text":"<p>GDB \u53ef\u4ee5\u52a0\u8f7d\u6838\u5fc3\u8f6c\u50a8\u6587\u4ef6\uff08core dump\uff09\u6765\u5206\u6790\u7a0b\u5e8f\u5d29\u6e83\u7684\u539f\u56e0\uff1a</p> <pre><code>gdb my_program core\n</code></pre> <p>\u52a0\u8f7d\u6838\u5fc3\u6587\u4ef6\u540e\uff0c\u4f60\u53ef\u4ee5\u68c0\u67e5\u5d29\u6e83\u65f6\u7684\u72b6\u6001\u3001\u5806\u6808\u7b49\u4fe1\u606f\u3002</p>"},{"location":"blog/2024/08/08/%E8%B0%83%E8%AF%95%E5%B0%8F%E5%B8%AE%E6%89%8Bgdb/#_17","title":"\u4f1a\u8bdd\u811a\u672c","text":"<p>\u53ef\u4ee5\u5c06\u4e00\u7cfb\u5217 GDB \u547d\u4ee4\u5199\u5165\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\uff0c\u7136\u540e\u5728 GDB \u542f\u52a8\u65f6\u81ea\u52a8\u6267\u884c\uff1a</p> <pre><code>gdb -x commands.gdb my_program\n</code></pre>"},{"location":"blog/2024/07/17/gunicorn--%E7%BB%BF%E8%89%B2%E7%8B%AC%E8%A7%92%E5%85%BD/","title":"Gunicorn \u2014\u2014 \u7eff\u8272\u72ec\u89d2\u517d","text":""},{"location":"blog/2024/07/17/gunicorn--%E7%BB%BF%E8%89%B2%E7%8B%AC%E8%A7%92%E5%85%BD/#_1","title":"\u4e3a\u4ec0\u4e48\u9009\u62e9\u5b83","text":"<p>\u5e38\u89c1\u7684python web\u5e94\u7528\u6846\u67b6\u6709Fastapi\u6216\u8005Flask\uff0c\u4e0e\u4e4b\u5bf9\u5e94\u7684http\u670d\u52a1\u5668\u5219\u662fUvicorn\u548cGunicorn\u3002</p> \u4e0d\u5982\u5148\u770b\u770b\u5b98\u65b9\u624b\u518c\u5427 <p>WSGI:  Gunicorn Docs +  Flask Docs</p> <p>ASGI:  Uvicorn Docs +  Fastapi Docs</p> <p>\u7531\u4e8eFlask\u7684\u9ed8\u8ba4\u542f\u52a8\u65b9\u5f0f\u5e76\u4e0d\u5408\u9002\u7528\u4e8e\u751f\u4ea7\uff0c\u6211\u66f4\u4e60\u60ef\u9009\u62e9Fastapi</p> <p>Do not use the development server when deploying to production. It is intended for use only during local development. It is not designed to be particularly secure, stable, or efficient.</p> <p>\u76f8\u5173\u8d44\u6599</p> <p>\u7136\u800cFastapi\u662f\u4e00\u4e2a\u5f02\u6b65\u7684web\u6846\u67b6\uff0c\u4e0e\u4e4b\u642d\u914d\u7684uvicorn\u53c8\u5e76\u6ca1\u6709\u50cfGunicorn\u8fd9\u6837\u975e\u5e38\u65b9\u4fbf\u7684\u914d\u7f6e\u6587\u4ef6\u548c\u94a9\u5b50\u673a\u5236\u3002</p> <p>\u597d\u5728uvicorn\u63d0\u4f9b\u4e86\u4e00\u4e2a\u517c\u5bb9\u7684worker\u53ef\u4ee5\u4f7f\u7528\uff0c\u4e8e\u662f\u5c31\u6709\u4e86\u5982\u4e0b\u7684\u7ec4\u5408:</p> <p>Fastapi + uvicorn.workers.UvicornWorker + Gunicorn</p>"},{"location":"blog/2024/07/17/gunicorn--%E7%BB%BF%E8%89%B2%E7%8B%AC%E8%A7%92%E5%85%BD/#_2","title":"\u5982\u4f55\u5f00\u59cb","text":"<ol> <li> <p>\u8bb0\u5f97\u5b89\u88c5\u597d\u5b83\u4eec</p> <pre><code>pip install fastapi uvicorn gunicorn\n</code></pre> </li> <li> <p>\u4f60\u7684fastapi\u4ee3\u7801</p> <pre><code>from fastapi import FastAPI\n\napp = FastAPI()\n\n@app.get(\"/\")\ndef read_root():\n    return {\"Hello\": \"World\"}\n\n@app.get(\"/items/{item_id}\")\ndef read_item(item_id: int, q: str = None):\n    return {\"item_id\": item_id, \"q\": q}\n</code></pre> </li> <li> <p>\u542f\u52a8</p> <pre><code>gunicorn -k uvicorn.workers.UvicornWorker main:app\n</code></pre> </li> </ol>"},{"location":"blog/2024/07/17/gunicorn--%E7%BB%BF%E8%89%B2%E7%8B%AC%E8%A7%92%E5%85%BD/#_3","title":"\u66f4\u591a\u914d\u7f6e","text":"<p>\u50cf\u8fd9\u6837\u6307\u5b9a\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u6765\u542f\u52a8app\uff0c\u7136\u540e\u5728\u914d\u7f6e\u6587\u4ef6\u91cc\u81ea\u5b9a\u4e49\u66f4\u591a\u4f60\u60f3\u8981\u7684\u5185\u5bb9</p> <pre><code>gunicorn -c gunicorn_conf.py main:app\n</code></pre>"},{"location":"blog/2024/07/17/gunicorn--%E7%BB%BF%E8%89%B2%E7%8B%AC%E8%A7%92%E5%85%BD/#gunicorn_confpy","title":"gunicorn_conf.py","text":"<pre><code>import os\nimport multiprocessing\n\n# \u83b7\u53d6\u73af\u5883\u53d8\u91cf\nmax_workers_str = os.getenv(\"MAX_WORKERS\")\nhost = os.getenv(\"HOST\", \"0.0.0.0\")\nport = os.getenv(\"PORT\", \"8080\")\nbind_env = os.getenv(\"BIND\")\nuse_loglevel = os.getenv(\"LOG_LEVEL\", \"info\")\naccesslog_var = os.getenv(\"ACCESS_LOG\", \"-\")\nerrorlog_var = os.getenv(\"ERROR_LOG\", \"-\")\ngraceful_timeout_str = os.getenv(\"GRACEFUL_TIMEOUT\", \"120\")\ntimeout_str = os.getenv(\"TIMEOUT\", \"120\")\nkeepalive_str = os.getenv(\"KEEP_ALIVE\", \"5\")\nbacklog_str = os.getenv(\"BACKLOG\", \"2048\")\n\n# \u8bbe\u7f6e Gunicorn \u914d\u7f6e\nuse_max_workers = int(max_workers_str) if max_workers_str else (multiprocessing.cpu_count() * 2 + 1)\nuse_bind = bind_env if bind_env else f\"{host}:{port}\"\nuse_accesslog = accesslog_var or None\nuse_errorlog = errorlog_var or None\n\n# Gunicorn config variables\n\n# \u5de5\u4f5c\u8fdb\u7a0b\u6570\u91cf\nworkers = use_max_workers\nworker_class = \"uvicorn.workers.UvicornWorker\"\n\n# \u7ed1\u5b9a\u5730\u5740\u548c\u7aef\u53e3\nbind = use_bind\n\n# \u65e5\u5fd7\u914d\u7f6e\nerrorlog = use_errorlog\naccesslog = use_accesslog\nloglevel = use_loglevel\n\n# \u8d85\u65f6\u65f6\u95f4\ntimeout = int(timeout_str)\ngraceful_timeout = int(graceful_timeout_str)\n\n# \u4fdd\u6301\u6d3b\u52a8\u65f6\u95f4\nkeepalive = int(keepalive_str)\n\n# \u8bf7\u6c42\u961f\u5217\u5927\u5c0f\nbacklog = int(backlog_str)\n\n\n# For debugging and testing\nlog_data = {\n    \"loglevel\": loglevel,\n    \"workers\": workers,\n    \"bind\": bind,\n    \"backlog\": backlog,\n    \"graceful_timeout\": graceful_timeout,\n    \"timeout\": timeout,\n    \"keepalive\": keepalive,\n    \"errorlog\": errorlog,\n    \"accesslog\": accesslog,\n    # Additional, non-gunicorn variables\n    \"use_max_workers\": use_max_workers,\n    \"host\": host,\n    \"port\": port,\n}\nprint(log_data)\n</code></pre>"},{"location":"blog/2024/07/17/gunicorn--%E7%BB%BF%E8%89%B2%E7%8B%AC%E8%A7%92%E5%85%BD/#hooks","title":"hooks","text":"<p>\u8fd9\u5141\u8bb8\u7528\u6237\u5728 Gunicorn \u7684\u4e0d\u540c\u751f\u547d\u5468\u671f\u9636\u6bb5\u6267\u884c\u81ea\u5b9a\u4e49\u4ee3\u7801\u3002\u8fd9\u4e9b hooks \u53ef\u4ee5\u7528\u6765\u6267\u884c\u542f\u52a8\u524d\u521d\u59cb\u5316\u3001\u65e5\u5fd7\u8bb0\u5f55\u3001\u4fe1\u53f7\u5904\u7406\u7b49\u64cd\u4f5c\u3002\u5177\u4f53\u8be6\u7ec6\u7684\u8bf4\u660e\u53ef\u4ee5\u5728\u6587\u6863\u91cc\u627e\u5230\uff0c\u8fd9\u91cc\u505a\u7b80\u5355\u793a\u4f8b\u3002</p> <pre><code># add in gunicorn_conf.py\n\nWORKER_ENV = {}\n\ndef get_worker_id(worker):\n    return f'WORKER_{worker.age}'\n\ndef when_ready(server):\n    server.log.info(f\"on when_ready\")\n\ndef pre_fork(server, worker):\n    server.log.info(f\"on pre_fork\")\n\ndef post_fork(server, worker):\n    server.log.info(f\"on post_fork\")\n\ndef post_worker_init(worker):\n    worker.log.info(f\"worker {get_worker_id(worker)} init success\")\n\ndef child_exit(server, worker):\n    server.log.info(f\"worker:{worker_id} exited\")\n</code></pre>"},{"location":"blog/2024/07/14/nginx%E7%9A%84%E9%85%8D%E7%BD%AE/","title":"nginx\u7684\u914d\u7f6e","text":""},{"location":"blog/2024/07/14/nginx%E7%9A%84%E9%85%8D%E7%BD%AE/#_1","title":"\u5b89\u88c5","text":"<pre><code>sudo apt update &amp;&amp; apt install nginx                # ubuntu\n\nsudo yum install epel-release &amp;&amp; yum install nginx  # centos\n</code></pre>"},{"location":"blog/2024/07/14/nginx%E7%9A%84%E9%85%8D%E7%BD%AE/#_2","title":"\u542f\u52a8","text":"<pre><code>sudo systemctl start nginx\n\nsudo systemctl stop nginx\n\nsudo systemctl restart nginx\n\nsudo systemctl status nginx\n</code></pre>"},{"location":"blog/2024/07/14/nginx%E7%9A%84%E9%85%8D%E7%BD%AE/#_3","title":"\u914d\u7f6e","text":"<p>\u9ed8\u8ba4\u914d\u7f6e\u6587\u4ef6\u4f4d\u4e8e <code>/etc/nginx/nginx.conf</code></p>"},{"location":"blog/2024/07/14/nginx%E7%9A%84%E9%85%8D%E7%BD%AE/#1-http","title":"1. \u914d\u7f6e HTTP \u670d\u52a1\u5668","text":"<pre><code>http {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    server {\n        listen       80;\n        server_name  your_domain_or_IP;\n\n        location / {\n            root   /usr/share/nginx/html;\n            index  index.html index.htm;\n        }\n\n        error_page  404              /404.html;\n        location = /404.html {\n            root   /usr/share/nginx/html;\n        }\n\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   /usr/share/nginx/html;\n        }\n    }\n}\n</code></pre> <p>\u4ee5\u4e0a\u914d\u7f6e\u4f1a\u5728\u670d\u52a1\u5668\u7684\u6839\u76ee\u5f55\uff08<code>/usr/share/nginx/html</code>\uff09\u4e0b\u67e5\u627e <code>index.html</code> \u6216 <code>index.htm</code> \u6587\u4ef6\u5e76\u8fd4\u56de\u3002</p>"},{"location":"blog/2024/07/14/nginx%E7%9A%84%E9%85%8D%E7%BD%AE/#2","title":"2. \u914d\u7f6e\u53cd\u5411\u4ee3\u7406","text":"<p>\u5728 <code>http</code> \u5757\u4e2d\u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u670d\u52a1\u5668\u5757\uff1a</p> <pre><code>http {\n    include       mime.types;\n    default_type  application/octet-stream;\n\n    server {\n        listen       80;\n        server_name  your_domain_or_IP;\n\n        location / {\n            proxy_pass http://localhost:8080;\n            proxy_set_header Host $host;\n            proxy_set_header X-Real-IP $remote_addr;\n            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n            proxy_set_header X-Forwarded-Proto $scheme;\n        }\n\n        error_page  404              /404.html;\n        location = /404.html {\n            root   /usr/share/nginx/html;\n        }\n\n        error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   /usr/share/nginx/html;\n        }\n    }\n}\n</code></pre> <p>\u4ee5\u4e0a\u914d\u7f6e\u4f1a\u5c06\u6240\u6709\u8bf7\u6c42\u4ee3\u7406\u5230\u672c\u5730\u7684 8080 \u7aef\u53e3\u3002</p>"},{"location":"blog/2024/07/14/nginx%E7%9A%84%E9%85%8D%E7%BD%AE/#3-https","title":"3. \u914d\u7f6e HTTPS","text":"<p>\u8981\u914d\u7f6e HTTPS\uff0c\u4f60\u9700\u8981\u62e5\u6709 SSL \u8bc1\u4e66\u3002\u53ef\u4ee5\u901a\u8fc7 <code>certbot</code> \u83b7\u53d6\u514d\u8d39\u7684 Let\u2019s Encrypt \u8bc1\u4e66\u3002</p> <p>\u9996\u5148\uff0c\u5b89\u88c5 Certbot\uff1a</p> <pre><code>sudo apt install certbot python3-certbot-nginx\n</code></pre> <p>\u7136\u540e\uff0c\u83b7\u53d6\u8bc1\u4e66\uff1a</p> <pre><code>sudo certbot --nginx -d your_domain\n</code></pre> <p>\u8fd9\u4f1a\u81ea\u52a8\u4e3a\u4f60\u7684\u57df\u540d\u914d\u7f6e SSL\uff0c\u5e76\u4fee\u6539 Nginx \u914d\u7f6e\u6587\u4ef6\u4ee5\u4f7f\u7528 HTTPS\u3002</p>"},{"location":"blog/2024/07/14/nginx%E7%9A%84%E9%85%8D%E7%BD%AE/#4","title":"4. \u8de8\u57df\u95ee\u9898","text":"<pre><code>http {\n    # \u5176\u4ed6\u914d\u7f6e...\n\n    server {\n        # \u5176\u4ed6\u914d\u7f6e...\n\n        location / {\n            # \u5176\u4ed6\u914d\u7f6e...\n            add_header 'Access-Control-Allow-Origin' '*';\n            add_header 'Access-Control-Allow-Methods' 'GET, POST, OPTIONS';\n            add_header 'Access-Control-Allow-Headers' 'Origin, Content-Type, Accept, Authorization';\n        }\n    }\n}\n</code></pre>"},{"location":"blog/2024/07/14/ssh%E7%9A%84%E9%85%8D%E7%BD%AE/","title":"SSH\u7684\u914d\u7f6e","text":""},{"location":"blog/2024/07/14/ssh%E7%9A%84%E9%85%8D%E7%BD%AE/#_1","title":"\u5b89\u88c5","text":"<pre><code>sudo apt-get install openssh-server  # Debian/Ubuntu\nsudo yum install openssh-server      # CentOS/RHEL\n</code></pre> <p>\u542f\u52a8 <pre><code>sudo systemctl start ssh\nsudo systemctl enable ssh\n\nsudo systemctl status ssh       # \u67e5\u770b\u72b6\u6001\n\nsudo systemctl restart ssh      # \u91cd\u542f\n</code></pre></p>"},{"location":"blog/2024/07/14/ssh%E7%9A%84%E9%85%8D%E7%BD%AE/#_2","title":"\u914d\u7f6e","text":"<p>\u914d\u7f6e\u6587\u4ef6\u5b58\u653e\u5728<code>/etc/ssh</code>\u4e0b\uff0c\u4e00\u822c\u662f<code>sshd_config</code>\u6587\u4ef6</p> <pre><code>#Port 22\n# SSH\u670d\u52a1\u76d1\u542c\u7684\u7aef\u53e3\u53f7\uff0c\u9ed8\u8ba4\u662f22\u3002\u53ef\u4ee5\u66f4\u6539\u4e3a\u5176\u4ed6\u7aef\u53e3\u4ee5\u589e\u5f3a\u5b89\u5168\u6027\u3002\n\n#AddressFamily any\n# \u6307\u5b9aSSH\u76d1\u542c\u7684\u5730\u5740\u65cf\uff0c\u53ef\u4ee5\u662f \"inet\" (IPv4) \u6216 \"inet6\" (IPv6) \u6216 \"any\" (\u9ed8\u8ba4)\u3002\n\n#ListenAddress 0.0.0.0\n#ListenAddress ::\n# \u6307\u5b9aSSH\u670d\u52a1\u76d1\u542c\u7684\u5730\u5740\uff0c\u53ef\u4ee5\u914d\u7f6e\u7279\u5b9a\u7684IP\u5730\u5740\u6216\u4f7f\u7528\u9ed8\u8ba4\u7684\u6240\u6709\u5730\u5740\u3002\n\n#HostKey /etc/ssh/ssh_host_rsa_key\n#HostKey /etc/ssh/ssh_host_ecdsa_key\n#HostKey /etc/ssh/ssh_host_ed25519_key\n# SSH\u670d\u52a1\u4f7f\u7528\u7684\u4e3b\u673a\u5bc6\u94a5\u6587\u4ef6\uff0c\u7528\u4e8e\u4e0d\u540c\u7684\u52a0\u5bc6\u7b97\u6cd5\uff08RSA\u3001ECDSA\u3001Ed25519\uff09\u3002\n\n# Ciphers and keying\n#RekeyLimit default none\n# \u8bbe\u7f6e\u91cd\u65b0\u52a0\u5bc6\u6570\u636e\u4f20\u8f93\u7684\u9891\u7387\u3002\u53ef\u4ee5\u6307\u5b9a\u6570\u636e\u91cf\u548c\u65f6\u95f4\u9650\u5236\u3002\n\n# Logging\n#SyslogFacility AUTH\n# \u8bbe\u7f6e\u65e5\u5fd7\u7684\u8bbe\u65bd\uff0c\u9ed8\u8ba4\u662fAUTH\u3002\n\n#LogLevel INFO\n# \u8bbe\u7f6e\u65e5\u5fd7\u7684\u8be6\u7ec6\u7ea7\u522b\uff0c\u53ef\u4ee5\u662fQUIET\u3001FATAL\u3001ERROR\u3001INFO\u3001VERBOSE\u3001DEBUG1\u3001DEBUG2\u3001DEBUG3\u3002\n\n# Authentication:\n\n#LoginGraceTime 2m\n# \u767b\u5f55\u5bbd\u9650\u65f6\u95f4\uff0c\u9ed8\u8ba4\u662f2\u5206\u949f\u3002\u5728\u8fd9\u4e2a\u65f6\u95f4\u5185\u5982\u679c\u7528\u6237\u672a\u80fd\u6210\u529f\u767b\u5f55\uff0c\u8fde\u63a5\u5c06\u88ab\u5173\u95ed\u3002\n\n#PermitRootLogin prohibit-password\n# \u662f\u5426\u5141\u8bb8root\u7528\u6237\u767b\u5f55\uff0c\u9ed8\u8ba4\u662f \"prohibit-password\"\uff08\u7981\u6b62\u4f7f\u7528\u5bc6\u7801\u767b\u5f55\uff09\u3002\n\n#StrictModes yes\n# \u68c0\u67e5\u7528\u6237\u4e3b\u76ee\u5f55\u548cSSH\u76f8\u5173\u6587\u4ef6\u7684\u6743\u9650\u8bbe\u7f6e\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n#MaxAuthTries 6\n# \u5141\u8bb8\u7684\u6700\u5927\u8ba4\u8bc1\u5c1d\u8bd5\u6b21\u6570\uff0c\u9ed8\u8ba4\u662f6\u6b21\u3002\n\n#MaxSessions 10\n# \u6bcf\u4e2a\u7f51\u7edc\u8fde\u63a5\u5141\u8bb8\u7684\u6700\u5927\u5e76\u53d1\u4f1a\u8bdd\u6570\uff0c\u9ed8\u8ba4\u662f10\u3002\n\n#PubkeyAuthentication yes\n# \u542f\u7528\u516c\u94a5\u8ba4\u8bc1\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n# Expect .ssh/authorized_keys2 to be disregarded by default in future.\n#AuthorizedKeysFile     .ssh/authorized_keys .ssh/authorized_keys2\n# \u6307\u5b9a\u5b58\u50a8\u516c\u94a5\u7684\u6587\u4ef6\uff0c\u9ed8\u8ba4\u662f \".ssh/authorized_keys\"\u3002\n\n#AuthorizedPrincipalsFile none\n# \u6307\u5b9a\u5b58\u50a8\u6388\u6743\u4e3b\u4f53\u7684\u6587\u4ef6\uff0c\u9ed8\u8ba4\u662f\u6ca1\u6709\u3002\n\n#AuthorizedKeysCommand none\n# \u6307\u5b9a\u83b7\u53d6\u516c\u94a5\u7684\u547d\u4ee4\uff0c\u9ed8\u8ba4\u662f\u6ca1\u6709\u3002\n\n#AuthorizedKeysCommandUser nobody\n# \u6307\u5b9a\u8fd0\u884c\u83b7\u53d6\u516c\u94a5\u547d\u4ee4\u7684\u7528\u6237\uff0c\u9ed8\u8ba4\u662f \"nobody\"\u3002\n\n# For this to work you will also need host keys in /etc/ssh/ssh_known_hosts\n#HostbasedAuthentication no\n# \u662f\u5426\u542f\u7528\u57fa\u4e8e\u4e3b\u673a\u7684\u8ba4\u8bc1\uff0c\u9ed8\u8ba4\u662f\u7981\u7528\u7684\u3002\n\n# Change to yes if you don't trust ~/.ssh/known_hosts for\n# HostbasedAuthentication\n#IgnoreUserKnownHosts no\n# \u662f\u5426\u5ffd\u7565\u7528\u6237\u7684 \"known_hosts\" \u6587\u4ef6\uff0c\u9ed8\u8ba4\u662f\u4e0d\u5ffd\u7565\u3002\n\n# Don't read the user's ~/.rhosts and ~/.shosts files\n#IgnoreRhosts yes\n# \u662f\u5426\u5ffd\u7565\u7528\u6237\u7684 \".rhosts\" \u548c \".shosts\" \u6587\u4ef6\uff0c\u9ed8\u8ba4\u662f\u5ffd\u7565\u3002\n\n# To disable tunneled clear text passwords, change to no here!\n#PasswordAuthentication yes\n# \u662f\u5426\u5141\u8bb8\u5bc6\u7801\u8ba4\u8bc1\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\u4e3a\u4e86\u5b89\u5168\uff0c\u53ef\u4ee5\u8bbe\u7f6e\u4e3a \"no\"\u3002\n\n#PermitEmptyPasswords no\n# \u662f\u5426\u5141\u8bb8\u7a7a\u5bc6\u7801\uff0c\u9ed8\u8ba4\u662f\u4e0d\u5141\u8bb8\u3002\n\n# Change to yes to enable challenge-response passwords (beware issues with\n# some PAM modules and threads)\nChallengeResponseAuthentication no\n# \u662f\u5426\u542f\u7528\u6311\u6218-\u54cd\u5e94\u5bc6\u7801\u8ba4\u8bc1\uff0c\u9ed8\u8ba4\u662f\u7981\u7528\u7684\u3002\n\n# Kerberos options\n#KerberosAuthentication no\n# \u662f\u5426\u542f\u7528Kerberos\u8ba4\u8bc1\uff0c\u9ed8\u8ba4\u662f\u7981\u7528\u7684\u3002\n\n#KerberosOrLocalPasswd yes\n# \u662f\u5426\u5141\u8bb8\u4f7f\u7528Kerberos\u6216\u8005\u672c\u5730\u5bc6\u7801\u8fdb\u884c\u8ba4\u8bc1\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n#KerberosTicketCleanup yes\n# \u662f\u5426\u5728\u7528\u6237\u6ce8\u9500\u65f6\u6e05\u9664Kerberos\u7968\u636e\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n#KerberosGetAFSToken no\n# \u662f\u5426\u5728\u8ba4\u8bc1\u8fc7\u7a0b\u4e2d\u83b7\u53d6AFS\u4ee4\u724c\uff0c\u9ed8\u8ba4\u662f\u7981\u7528\u7684\u3002\n\n# GSSAPI options\n#GSSAPIAuthentication no\n# \u662f\u5426\u542f\u7528GSSAPI\u8ba4\u8bc1\uff0c\u9ed8\u8ba4\u662f\u7981\u7528\u7684\u3002\n\n#GSSAPICleanupCredentials yes\n# \u662f\u5426\u5728\u7528\u6237\u6ce8\u9500\u65f6\u6e05\u9664GSSAPI\u51ed\u8bc1\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n#GSSAPIStrictAcceptorCheck yes\n# \u662f\u5426\u542f\u7528GSSAPI\u4e25\u683c\u7684\u63a5\u53d7\u8005\u68c0\u67e5\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n#GSSAPIKeyExchange no\n# \u662f\u5426\u542f\u7528GSSAPI\u5bc6\u94a5\u4ea4\u6362\uff0c\u9ed8\u8ba4\u662f\u7981\u7528\u7684\u3002\n\n# AllowAgentForwarding yes\n# \u5141\u8bb8\u4ee3\u7406\u8f6c\u53d1\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n# AllowTcpForwarding yes\n# \u5141\u8bb8TCP\u8f6c\u53d1\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n# GatewayPorts no\n# \u662f\u5426\u5141\u8bb8\u8fdc\u7a0b\u4e3b\u673a\u8fde\u63a5\u8f6c\u53d1\u7aef\u53e3\uff0c\u9ed8\u8ba4\u662f\u4e0d\u5141\u8bb8\u7684\u3002\n\nX11Forwarding yes\n# \u5141\u8bb8X11\u8f6c\u53d1\uff0c\u7528\u4e8e\u56fe\u5f62\u5316\u754c\u9762\u5e94\u7528\u7684\u8fdc\u7a0b\u4f7f\u7528\u3002\n\n# X11DisplayOffset 10\n# X11\u663e\u793a\u504f\u79fb\uff0c\u9ed8\u8ba4\u503c\u662f10\u3002\n\n# X11UseLocalhost yes\n# \u4ec5\u5141\u8bb8\u672c\u5730\u56de\u73af\u5730\u5740\u8fde\u63a5\u5230X11\u670d\u52a1\u5668\u3002\n\n# PermitTTY yes\n# \u5141\u8bb8TTY\uff08\u7ec8\u7aef\uff09\u5206\u914d\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\nPrintMotd no\n# \u767b\u5f55\u65f6\u4e0d\u663e\u793a\u7cfb\u7edf\u6d88\u606f\uff08Message of the Day\uff09\uff0c\u53ef\u4ee5\u51cf\u5c11\u566a\u97f3\u4fe1\u606f\u3002\n\n# PrintLastLog yes\n# \u767b\u5f55\u65f6\u663e\u793a\u4e0a\u6b21\u767b\u5f55\u4fe1\u606f\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n# TCPKeepAlive yes\n# \u5141\u8bb8TCP\u8fde\u63a5\u4fdd\u6301\u6d3b\u8dc3\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n# PermitUserEnvironment no\n# \u662f\u5426\u5141\u8bb8\u7528\u6237\u81ea\u5b9a\u4e49\u73af\u5883\u53d8\u91cf\uff0c\u9ed8\u8ba4\u662f\u4e0d\u5141\u8bb8\u7684\u3002\n\n# Compression delayed\n# \u542f\u7528\u538b\u7f29\uff0c\u4f46\u5ef6\u8fdf\u76f4\u5230\u7528\u6237\u8ba4\u8bc1\u5b8c\u6210\u3002\n\n# ClientAliveInterval 0\n# \u8bbe\u7f6e\u670d\u52a1\u5668\u5411\u5ba2\u6237\u7aef\u53d1\u9001\u4fdd\u6301\u6d3b\u52a8\u6d88\u606f\u7684\u65f6\u95f4\u95f4\u9694\uff0c\u9ed8\u8ba4\u662f0\uff08\u7981\u7528\uff09\u3002\n\n# ClientAliveCountMax 3\n# \u8bbe\u7f6e\u670d\u52a1\u5668\u53d1\u9001\u4fdd\u6301\u6d3b\u52a8\u6d88\u606f\u7684\u6700\u5927\u6b21\u6570\uff0c\u5982\u679c\u5ba2\u6237\u7aef\u6ca1\u6709\u54cd\u5e94\uff0c\u8fde\u63a5\u5c06\u88ab\u5173\u95ed\u3002\n\n# UseDNS no\n# \u662f\u5426\u4f7f\u7528DNS\u53cd\u5411\u89e3\u6790\u5ba2\u6237\u7aef\u7684\u4e3b\u673a\u540d\uff0c\u9ed8\u8ba4\u662f\u542f\u7528\u7684\u3002\n\n# PidFile /var/run/sshd.pid\n# SSH\u5b88\u62a4\u8fdb\u7a0b\u7684PID\u6587\u4ef6\u8def\u5f84\u3002\n\n# MaxStartups 10:30:100\n# \u8bbe\u7f6e\u540c\u65f6\u8fdb\u884c\u7684\u672a\u8ba4\u8bc1\u8fde\u63a5\u7684\u6700\u5927\u6570\u91cf\u3002\n\n# PermitTunnel no\n# \u662f\u5426\u5141\u8bb8\u901a\u8fc7SSH\u521b\u5efa\u7f51\u7edc\u96a7\u9053\uff0c\u9ed8\u8ba4\u662f\u4e0d\u5141\u8bb8\u7684\u3002\n\n# ChrootDirectory none\n# \u8bbe\u7f6e\u7528\u6237\u7684Chroot\u76ee\u5f55\uff0c\u9ed8\u8ba4\u662f\u6ca1\u6709\u3002\n\n# VersionAddendum none\n# \u6dfb\u52a0\u81ea\u5b9a\u4e49\u7684\u7248\u672c\u5b57\u7b26\u4e32\uff0c\u9ed8\u8ba4\u662f\u6ca1\u6709\u3002\n\n# no default banner path\n# Banner none\n# \u4e0d\u663e\u793a\u767b\u5f55\u6a2a\u5e45\u4fe1\u606f\u3002\n\n# Allow client to pass locale environment variables\nAcceptEnv LANG LC_*\n# \u5141\u8bb8\u5ba2\u6237\u7aef\u4f20\u9012\u8bed\u8a00\u73af\u5883\u53d8\u91cf\uff08locale\uff09\u3002\n\n# override default of no subsystems\nSubsystem       sftp    /usr/lib/openssh/sftp-server\n# \u8bbe\u7f6eSFTP\u5b50\u7cfb\u7edf\u7684\u8def\u5f84\u3002\n</code></pre>"},{"location":"blog/2024/07/14/ssh%E7%9A%84%E9%85%8D%E7%BD%AE/#_3","title":"\u6b63\u5411\u4e0e\u53cd\u5411\u8fde\u63a5","text":"<p>\u6307\u5b9a\u8fdc\u7a0b\u8fde\u63a5\u670d\u52a1\u5668\u7684\u7aef\u53e3(1234) <pre><code>ssh -p 1234 user@10.1.10.10\n</code></pre></p> <p>\u5c06\u672c\u5730\u7684\u7aef\u53e3(4321)\u6620\u5c04\u5230\u8fdc\u7a0b\u670d\u52a1\u5668\u7684\u7aef\u53e3(1234) <pre><code>ssh -NCR 1234:127.0.0.1:4321 user@10.1.10.10\n</code></pre></p> <p>\u8fd9\u91cc\u53c2\u6570<code>-R</code>\u5373\u53cd\u5411\u96a7\u9053\uff1b</p> <p><code>-N</code>\u8868\u793a\u4e0d\u4f1a\u5728\u8fdc\u7a0b\u4e3b\u673a\u4e0a\u8fd0\u884c\u4efb\u4f55\u547d\u4ee4\uff0c\u53ea\u5efa\u7acb\u96a7\u9053\u800c\u4e0d\u6253\u5f00\u8fdc\u7a0b shell\uff1b</p> <p><code>-C</code>\u8868\u793a\u5728\u4f20\u8f93\u8fc7\u7a0b\u4e2d\u538b\u7f29\u6570\u636e\uff0c\u5728\u5e26\u5bbd\u6709\u9650\u7684\u7f51\u7edc\u4e0a\u4e5f\u8bb8\u80fd\u63d0\u9ad8\u4f20\u8f93\u6548\u7387\u3002</p> <p>\u5982\u679c\u5728\u6b64\u57fa\u7840\u4e0a\u4e3a\u670d\u52a1\u5668\u914d\u7f6e\u4e86<code>GatewayPorts yes</code>\uff0c\u76f8\u5f53\u4e8e\u5efa\u7acb\u4e86\u4e34\u65f6\u7684\u5185\u7f51\u7a7f\u900f\u3002</p>"},{"location":"blog/2024/07/14/ssh%E7%9A%84%E9%85%8D%E7%BD%AE/#sshscp","title":"\u57fa\u4e8essh\u7528scp\u6765\u4f20\u8f93\u6587\u4ef6","text":"<pre><code>scp -P 1234 file.tar.gz user@10.1.10.10:/home/user/\n</code></pre> <p>\u8868\u793a\u5229\u7528\u7aef\u53e3(1234)\u5efa\u7acb\u8fde\u63a5\uff0c\u5e76\u5c06\u672c\u5730\u7684\u6587\u4ef6\u4f20\u8f93\u5230\u76ee\u6807\u670d\u52a1\u5668\u7684<code>/home/user/</code>\u76ee\u5f55\u4e0b</p>"},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/","title":"\u642d\u5efaJava\u670d\u52a1\u5668(Ubuntu20.04)\u8fd0\u884c\u73af\u5883","text":""},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/#_1","title":"\u524d\u8a00","text":"<p>\u7b2c\u4e00\u6b21\u642dUbuntu\u73af\u5883\uff0c\u8bb0\u5f55\u4e00\u4e0b\u5927\u5927\u5c0f\u5c0f\u7684\u5751\u3002\u5173\u4e8e\u7aef\u53e3\u5f00\u653e\uff0c\u6216\u8005\u76f8\u5173\u547d\u4ee4\u8fd9\u91cc\u4e0d\u4f1a\u8bf4\u660e\uff0c\u9ed8\u8ba4\u90fd\u4e86\u89e3\u3002</p>"},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/#docker","title":"docker\u73af\u5883","text":"<p>\u5b89\u88c5docker\u8be6\u89c1\u4ece\u96f6\u5f00\u59cb\u7684Ubuntu\u4e4b\u65c5\u3002\u8fd9\u91cc\u4e3b\u8981\u8d34\u4e00\u4e0bdocker-compose,\u5305\u542b\u5e38\u7528\u7684\u4e00\u4e9b\u955c\u50cf\u3002</p>"},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/#docker-compose","title":"docker-compose","text":"<p>\u79fb\u690d\u5230\u300a\u7b80\u6613docker\u4f7f\u7528\u624b\u518c\u300b\uff1f</p> <ul> <li>\u5b89\u88c5 <p>tips: \u60a8\u53ef\u4ee5\u5728docker-compose\u4e2d\u67e5\u627e\u5b98\u65b9\u7248\u672c\u3002\u8bf7\u786e\u4fdd\u4f7f\u7528\u6700\u65b0\u7248\u672c\u3002 <pre><code>sudo curl -L \"https://github.com/docker/compose/releases/download/1.29.1/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\n</code></pre></p> </li> <li> <p>\u6388\u6743\u53ef\u6267\u884c\u6743\u9650  \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5c06docker-compose\u4e8c\u8fdb\u5236\u6587\u4ef6\u6807\u8bb0\u4e3a\u53ef\u6267\u884c\u6587\u4ef6\uff1a <code>sudo chmod +x /usr/local/bin/docker-compose</code></p> <p>tips: \u8fd0\u884c <code>docker-compose --version</code> \u9a8c\u8bc1Docker Compose\u662f\u5426\u6b63\u786e\u5b89\u88c5</p> </li> <li> <p>docker-compose.yml <pre><code>version: \"3\"\nnetworks:\n  es-net:\n    driver: bridge\n\nservices:\n  redis:\n    image: redis\n    container_name: redis\n    ports:\n      - \"6379:6379\"\n    volumes:\n      - /data/redis/conf/redis.conf:/etc/redis/redis.conf\n      - /data/redis/data:/data\n    command: redis-server /etc/redis/redis.conf\n\n  elasticSearch:\n    image: elasticsearch:7.17.7\n    container_name: es\n    ports:\n      - \"9200:9200\"\n      - \"9300:9300\"\n    volumes:\n      - /data/es/config/elasticsearch.yml:/usr/share/elasticsearch/config/elasticsearch.yml\n      - /data/es/data:/usr/share/elasticsearch/data\n      - /data/es/logs:/usr/share/elasticsearch/logs\n      - /data/es/plugins:/usr/share/elasticsearch/plugins\n      - /data/es/plugins:/usr/share/elasticsearch/plugins\n    privileged: true\n    networks:\n      - es-net\n    environment:\n      - \"discovery.type=single-node\"\n      - \"ES_JAVA_OPTS=-Xms256m -Xmx256m\"\n\n  kibana:\n    image: kibana:7.17.7\n    container_name: kibana\n    ports:\n      - \"5601:5601\"\n    volumes:\n      - /data/kibana/data:/usr/share/kibana/data\n      - /data/kibana/config:/usr/share/kibana/config\n      - /data/kibana/plugins:/usr/share/kibana/plugins\n      - /data/kibana/logs:/usr/share/kibana/logs\n    privileged: true\n    networks:\n      - es-net\n  minio:\n    image: minio/minio\n    container_name: minio\n    ports:\n      - \"9000:9000\"\n      - \"9001:9001\"\n    volumes:\n      - /data/minio/data:/data\n    environment:\n      - \"MINIO_ACCESS_KEY=minioadmin\"\n      - \"MINIO_SECRET_KEY=minioadmin\"\n    command: server /data --console-address \":9001\"\n</code></pre></p> <p>\u5c0ftips: - \u6302\u8f7d\u7684config\u4e2d\u90fd\u9700\u8981\u6709xxx.conf\u6587\u4ef6\uff0c\u5c24\u5176\u662fkibana\u4f1a\u76f4\u63a5\u5bfc\u81f4\u542f\u52a8\u5931\u8d25,\u5176\u4e2dkibana\u8fd8\u9700\u8981\u914d\u7f6e<code>elasticsearch.hosts</code>,\u4fdd\u8bc1kibana\u80fd\u591f\u88ab\u6b63\u5e38\u8bbf\u95ee, \u6302\u8f7d\u76ee\u5f55\u540c\u65f6\u9700\u8981777\u7684\u6743\u9650 - \u4e0a\u8ff0\u5168\u662f\u5355\u673a\u6a21\u5f0f\uff0c\u5982\u679c\u9700\u8981\u96c6\u7fa4\u53ea\u9700\u8981\u590d\u5236\u5373\u53ef - es\u8bb0\u5f97\u914d\u7f6eik\u5206\u8bcd\u5668\u54e6~</p> </li> </ul>"},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/#mysql","title":"mysql\u73af\u5883","text":""},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/#_2","title":"\u5b89\u88c5","text":"<p>\u7f51\u4e0a\u5b89\u88c5\u914d\u7f6emysql\u6559\u7a0b\u7eb7\u7e41\u6742\u4e71\u3002\u8bb0\u5f55\u5e38\u7528\u5230\u7684\u5b89\u88c5\u548c\u914d\u7f6emysql\u6559\u7a0b\uff0c\u4f5c\u4e3a\u7b14\u8bb0\u548c\u8e29\u5751\u65e5\u5fd7\uff0c\u4fbf\u590d\u7528\u3002</p> <p>\u5728ubuntu\u4e2d\u5b89\u88c5mysql\u53ea\u8981\u4e00\u884c\u547d\u4ee4\u5c31\u53ef\u4ee5\u4e86 <code>sudo apt install mysql-server</code>\u3002\u8f93\u5165<code>service mysql status</code>\u67e5\u770b\u670d\u52a1\u8fd0\u884c\u72b6\u6001\u3002</p> <p>tips: \u901a\u8fc7apt\u5b89\u88c5\u7684mysql\u4e0d\u9700\u8981\u50cf\u5176\u4ed6\u5e73\u53f0\u90a3\u6837\u5f00\u542f\u670d\u52a1\uff0c\u56e0\u4e3a\u5df2\u7ecf\u9ed8\u8ba4\u5f00\u542f\uff0c\u5e76\u4e14\u670d\u52a1\u540d\u53eb\u505amysql\uff0c\u800c\u4e0d\u662fmysqld</p>"},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/#_3","title":"\u767b\u5f55","text":"<p><code>sudo mysql</code> \u8fdb\u5165\u5230mysql\u547d\u4ee4\u884c\u3002</p> <ul> <li>\u91cd\u7f6e\u5bc6\u7801</li> </ul> <p>\u91cd\u7f6e root \u8d26\u6237\u5bc6\u7801 <code>ALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '\u65b0\u5bc6\u7801';</code></p> <p>\u5237\u65b0\u6743\u9650 <code>FLUSH PRIVILEGES;</code></p> <ul> <li>\u8fdc\u7a0b\u767b\u5f55\u7528\u6237 \u5982\u679c\u9700\u8981\u8fdc\u7a0b\u767b\u9646\uff1a</li> <li> <ul> <li>\u521b\u5efa\u4e00\u4e2a host \u5b57\u6bb5\u4e3a % \u7684 root \u7528\u6237\uff08\u521b\u5efa\u7528\u6237\u7684\u540c\u65f6\u8bbe\u7f6e\u5bc6\u7801\uff09</li> </ul> </li> <li> <ul> <li>\u6388\u6743\u6240\u6709\u6570\u636e\u5e93\u7684\u8bbf\u95ee\u6743\u9650</li> </ul> </li> <li> <ul> <li>\u5237\u65b0\u6743\u9650\u5217\u8868</li> </ul> </li> </ul> <p>\u65b0\u5efa\u4e00\u4e2a host \u4e3a % \u7684 mireux \u7528\u6237\uff0c\u5bc6\u7801\u968f\u610f  <code>create user 'mireux'@'%' identified by 'yourpassword';</code></p> <p>\u6388\u6743 <code>GRANT ALL PRIVILEGES ON *.* TO 'mireux'@'%' WITH GRANT OPTION;</code></p> <p>\u5237\u65b0\u6743\u9650 <code>FLUSH PRIVILEGES;</code></p> <p>\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u7684\u65b9\u5f0f\u67e5\u770b\u6211\u4eec\u7684\u7528\u6237\u4fe1\u606f\u60c5\u51b5 mysql&gt; use mysql mysql&gt; select host,user,authentication_string from user;</p>"},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/#_4","title":"\u5176\u4ed6\u95ee\u9898","text":"<p>\u5982\u679c\u6309\u7167\u4e0a\u8ff0\u6b65\u9aa4\u4f9d\u7136\u65e0\u6cd5\u8fdc\u7a0b\u8fde\u63a5\uff0c\u53ef\u80fd\u9700\u8981\u4fee\u6539mysql\u76f8\u5173\u7684\u914d\u7f6e\u6587\u4ef6\u3002 1. \u5173\u505cmysql\u670d\u52a1 <code>sudo systemctl stop mysql</code> 2. \u7f16\u8f91mysql\u914d\u7f6e\u6587\u4ef6 <code>sudo vim /etc/mysql/mysql.conf.d/mysqld.cnf</code> 3. \u6ce8\u91ca\u6389<code>#bind-address = 127.0.0.1</code>  4. \u91cd\u542fmysql\u670d\u52a1 <code>sudo service mysql start</code></p>"},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/#java","title":"Java\u73af\u5883","text":""},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/#_5","title":"\u5b89\u88c5","text":"<p>\u5b89\u88c5\u7684\u811a\u672c \u8981\u662f\u6709\u4ec0\u4e48\u9700\u8981\u6216\u8005\u66f4\u597d\u7684\u5efa\u8bae\u53ef\u4ee5\u4ea4\u6d41 ( \u6211\u4e5f\u662f\u4e2a\u521d\u5b66\u8005:-( ) \u5168\u90e8\u90fd\u662f\u57fa\u4e8eapt\u7684\u5b89\u88c5</p>"},{"location":"blog/2023/11/14/%E6%90%AD%E5%BB%BAjava%E6%9C%8D%E5%8A%A1%E5%99%A8ubuntu2004%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83/#binbash-bashrc-jdk-source-echo-jdk-javapathsudo-update-alternatives-list-java-if-e-javapath-then-echo-javajavapath0javapath-9-else-echo-jdk-jdk17-sudo-apt-update-sudo-apt-install-openjdk-17-jdk-sudo-update-alternatives-list-java-echo-export-java_homejavapath0javapath-9-bashrc-source-bashrc-fi-jdkjava_home-mvn-version-mvn-settingxmllocalrepository-echo-maven-mvnpathwhich-mvn-if-e-mvnpath-then-echo-mavenwhereis-maven-mvn-version-else-echo-maven-sudo-apt-get-update-sudo-apt-get-y-install-maven-mvn-version-fi-echo-git-gitpathwhich-git-if-e-gitpath-then-echo-gitwhereis-git-git-version-else-echo-git-sudo-apt-update-sudo-apt-install-git-git-version-fi","title":"<pre><code>#!/bin/bash\n# \u53ef\u80fd\u9700\u8981\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u8c03\u6574~/.bashrc\u91cc\u7684\u8def\u5f84 \u9700\u8981\u6307\u5411jdk\u6240\u5728\u7684\u76ee\u5f55 \u4fee\u6539\u540e\u8bb0\u5f97source\necho \"\u5f00\u59cb\u68c0\u6d4b\u662f\u5426\u5df2\u7ecf\u5b89\u88c5jdk...\"\njavaPath=`sudo update-alternatives --list java`\nif [ -e $javaPath ]; then\n        echo \"java\u7684\u8def\u5f84\u662f:${javaPath:0:${#javaPath}-9}\"\nelse\n        echo 'jdk\u4e0d\u5b58\u5728 \u5f00\u59cb\u4e0b\u8f7djdk17'\n        sudo apt update\n        sudo apt install openjdk-17-jdk\n        sudo update-alternatives --list java\n        echo \"export JAVA_HOME=${javaPath:0:${#javaPath}-9}\" &gt;&gt; ~/.bashrc\n        source ~/.bashrc\nfi\n# \u4e00\u5b9a\u8981\u786e\u4fdd\u5df2\u7ecf\u5b89\u88c5\u4e86jdk\u5e76\u4e14\u5df2\u7ecf\u914d\u7f6e\u4e86JAVA_HOME\u73af\u5883\u53d8\u91cf \u4e0d\u7136mvn -version\u4f1a\u62a5\u9519\n# \u4e0b\u8f7d\u540e\u4e0d\u8981\u5fd8\u8bb0\u4fee\u6539mvn\u7684\u914d\u7f6e\u6587\u4ef6 setting.xml\u4e2d\u7684localRepository\u548c\u955c\u50cf\u54e6~\necho \"\u5f00\u59cb\u68c0\u6d4b\u662f\u5426\u5df2\u7ecf\u5b89\u88c5maven...\"\nmvnPath=`which mvn`\nif [ -e $mvnPath ]; then\n        echo \"maven\u5df2\u7ecf\u5b58\u5728,$(whereis maven)\"\n        mvn -version\nelse\n        echo \"maven\u4e0d\u5b58\u5728 \u5f00\u59cb\u4e0b\u8f7d\"\n        sudo apt-get update\n        sudo apt-get -y install maven\n        mvn -version\nfi\n\necho \"\u5f00\u59cb\u68c0\u6d4b\u662f\u5426\u5df2\u7ecf\u5b89\u88c5git...\"\ngitPath=`which git`\nif [ -e $gitPath ]; then\n        echo \"git\u5df2\u7ecf\u5b58\u5728,$(whereis git)\"\n        git --version\nelse\n        echo \"git\u4e0d\u5b58\u5728 \u5f00\u59cb\u4e0b\u8f7d\"\n        sudo apt update\n        sudo apt install git\n        git --version\nfi\n</code></pre>","text":"<p>\u641e\u5b9a\u73af\u5883\uff01 \u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u53bb\u5c1d\u8bd5\u90e8\u7f72\u4f60\u7684\u7a0b\u5e8f\u54af~</p>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/","title":"ElasticSearch\u9ad8\u7ea7\u67e5\u8be2","text":""},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#_1","title":"\u8bf4\u660e","text":"<p>\u4e3b\u8981\u662fES\u4e2d\u7684\u9ad8\u7ea7\u67e5\u8be2\u5185\u5bb9</p> <p>\u200bES\u4e2d\u63d0\u4f9b\u4e86\u4e00\u79cd\u5f3a\u5927\u7684\u68c0\u7d22\u6570\u636e\u65b9\u5f0f,\u8fd9\u79cd\u68c0\u7d22\u65b9\u5f0f\u79f0\u4e4b\u4e3a<code>Query DSL</code> ,<code>Query DSL</code>\u662f\u5229\u7528<code>Rest API\u4f20\u9012JSON\u683c\u5f0f\u7684\u8bf7\u6c42\u4f53(Request Body)\u6570\u636e</code>\u4e0eES\u8fdb\u884c\u4ea4\u4e92\uff0c\u8fd9\u79cd\u65b9\u5f0f\u7684<code>\u4e30\u5bcc\u67e5\u8be2\u8bed\u6cd5</code>\u8ba9ES\u68c0\u7d22\u53d8\u5f97<code>\u66f4\u5f3a\u5927\uff0c\u66f4\u7b80\u6d01</code>\u3002"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#_2","title":"\u8bed\u6cd5","text":"<pre><code># GET /\u7d22\u5f15\u540d/_doc/_search {json\u683c\u5f0f\u8bf7\u6c42\u4f53\u6570\u636e}\n</code></pre> <p>\u6d4b\u8bd5\u6570\u636e\uff1a</p> <pre><code>{\n  \"took\" : 14,\n  \"timed_out\" : false,\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"skipped\" : 0,\n    \"failed\" : 0\n  },\n  \"hits\" : {\n    \"total\" : {\n      \"value\" : 4,\n      \"relation\" : \"eq\"\n    },\n    \"max_score\" : 1.0,\n    \"hits\" : [\n      {\n        \"_index\" : \"products\",\n        \"_type\" : \"_doc\",\n        \"_id\" : \"1\",\n        \"_score\" : 1.0,\n        \"_source\" : {\n          \"title\" : \"Iphone XR\",\n          \"created_at\" : \"2018-09-01\",\n          \"price\" : \"4999\",\n          \"description\" : \"\u8fd9\u662f\u4e00\u90e8Iphone XR \u624b\u673a\"\n        }\n      },\n      {\n        \"_index\" : \"products\",\n        \"_type\" : \"_doc\",\n        \"_id\" : \"brw9qX0BViY44oHwbDLo\",\n        \"_score\" : 1.0,\n        \"_source\" : {\n          \"title\" : \"Iphone15\",\n          \"created_at\" : \"2014-09-01\",\n          \"price\" : \"4000\",\n          \"description\" : \"\u8fd9\u662f\u4e00\u90e8\u8fc7\u65f6\u4e86\u7684Iphone 4\u624b\u673a\"\n        }\n      },\n      {\n        \"_index\" : \"products\",\n        \"_type\" : \"_doc\",\n        \"_id\" : \"3\",\n        \"_score\" : 1.0,\n        \"_source\" : {\n          \"title\" : \"iphone14\",\n          \"price\" : 8999.99,\n          \"created_at\" : \"2021-09-15\",\n          \"description\" : \"iPhone 14\u5c4f\u5e55\u91c7\u75286.8\u82f1\u5bf8OLED\u5c4f\u5e55\"\n        }\n      },\n      {\n        \"_index\" : \"products\",\n        \"_type\" : \"_doc\",\n        \"_id\" : \"4\",\n        \"_score\" : 1.0,\n        \"_source\" : {\n          \"title\" : \"iphone15\",\n          \"price\" : 8999.99,\n          \"created_at\" : \"2021-10-15\",\n          \"description\" : \"iPhone 15\u5c4f\u5e55\u91c7\u752810.8\u82f1\u5bf8OLED\u5c4f\u5e55\"\n        }\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#_3","title":"\u5e38\u89c1\u68c0\u7d22","text":""},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#match_all","title":"\u67e5\u8be2\u6240\u6709[match_all]","text":"<p>match_all\u5173\u952e\u5b57:  \u8fd4\u56de\u7d22\u5f15\u4e2d\u7684\u5168\u90e8\u6587\u6863</p> <pre><code>GET /products/_search\n{\n  \"query\": {\n    \"match_all\": {}\n  }\n}\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#term","title":"\u5173\u952e\u8bcd\u67e5\u8be2[term]","text":"<p>\u8fd9\u91cc\u5f15\u51fa\u5173\u4e8e\u5206\u8bcd\u5668\u7684\u95ee\u9898\u4e86\u3002\u540e\u9762\u4f1a\u8be6\u7ec6\u8bb2\u3002</p> <p>ES\u9ed8\u8ba4\u4f7f\u7528\u7684\u662fStandard Analyzer \uff0c\u5c31\u662f\u82f1\u6587\u9ed8\u8ba4\u4e3a\u4e00\u4e2a\u5355\u8bcd\u4e3a\u5207\u5272\uff0c\u4e2d\u6587\u9ed8\u8ba4\u4e3a\u4e00\u4e2a\u5b57\u4e3a\u5207\u5272\u3002</p> <p>\u4f46\u662f\u5728Mappings\u6620\u5c04\u4e2d\uff0c\u53ea\u6709text\u6574\u4e2a\u7c7b\u578b\u662f\u53ef\u4ee5\u88ab\u5206\u8bcd\u7684\uff0c\u800ckeyword\u3001date\u3001integer\u7b49\u7b49\u7c7b\u578b\u5176\u5b9e\u662f\u4e0d\u652f\u6301\u5206\u8bcd\u7684\u3002</p> <p>\u6240\u4ee5\u5982\u679c\u6211\u4eec\u641ctitle\u7684\u8bdd\uff0c\u5fc5\u987b\u8981\u6574\u4e2a\u641c\u7d22</p> <pre><code># \u5173\u952e\u8bcd\u67e5\u8be2 term\nGET /products/_search\n{\n  \"query\": {\n    \"term\" : {\n        \"title\": {\n             \"value\": \"iphone\"\n      }\n    }\n  }\n}\n</code></pre> <p>\u6211\u4eec\u8fd9\u6837\u641c\u7d22\u662f\u641c\u7d22\u4e0d\u5230\u7684\u3002</p> <pre><code># \u5173\u952e\u8bcd\u67e5\u8be2 term\nGET /products/_search\n{\n  \"query\": {\n    \"term\": {\n      \"description\": {\n        \"value\": \"\u8fd9\"\n      }\n    }\n  }\n}\n</code></pre> <p>\u641c\"\u8fd9\"\u662f\u53ef\u4ee5\u641c\u5230\u7684\uff0c\u4f46\u662f\u641c\u201c\u8fd9\u91cc\u201d\u5c31\u65e0\u6cd5\u641c\u5bfb\u5230\u3002ES\u81ea\u5e26\u7684\u5206\u8bcd\u5668\u5bf9\u4e8e\u4e2d\u6587\u4e0d\u53cb\u597d\u3002\u6240\u4ee5\u540e\u671f\u6211\u4eec\u8981\u66f4\u6362\u5206\u8bcd\u5668\u3002</p> <p>\u8fd9\u91cc\u56e0\u4e3a\u6211\u7684ES\u662f7.16.0 \u7248\u672c\uff0c\u800c\u5e38\u7528\u7684ES\u4e2d\u6587\u5206\u8bcd\u5668IK\u5206\u8bcd\u5668\u66f4\u65b0\u52307.15 \u6240\u4ee5\u6682\u65f6\u65e0\u6cd5\u6d4b\u8bd5 \u6211\u4e0d\u60f3\u56de\u9000\u7248\u672c</p> <p>\u7b49IK\u5206\u8bcd\u5668\u66f4\u65b0\u5728\u66f4\u65b0\u5173\u4e8e\u5206\u8bcd\u7684\u4e00\u4e9b\u95ee\u9898</p>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#range","title":"\u8303\u56f4\u67e5\u8be2[range]","text":"<p>range \u5173\u952e\u5b57: \u7528\u6765\u6307\u5b9a\u67e5\u8be2\u6307\u5b9a\u8303\u56f4\u5185\u7684\u6587\u6863</p> <pre><code># \u8303\u56f4\u67e5\u8be2 range\nGET /products/_search\n{\n  \"query\": {\n    \"range\": {\n      \"price\": {\n        \"gte\": 3000,\n        \"lte\": 4999\n      }\n    }\n  }\n}\n</code></pre> <p>lt \u5c0f\u4e8e gt \u5927\u4e8e e \u7b49\u4e8e</p>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#prefix","title":"\u524d\u7f00\u67e5\u8be2 [prefix]","text":"<p>prefix \u5173\u952e\u5b57: \u7528\u6765\u68c0\u7d22\u542b\u6709\u6307\u5b9a\u524d\u7f00\u7684\u5173\u952e\u8bcd\u7684\u76f8\u5173\u6587\u6863</p> <pre><code># \u524d\u7f00\u67e5\u8be2 prefix\nGET /products/_search \n{\n  \"query\": {\n    \"prefix\": {\n      \"title\": {\n        \"value\": \"ipho\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#wildcard","title":"\u901a\u914d\u7b26\u67e5\u8be2[wildcard]","text":"<p>wildcard \u5173\u952e\u5b57: \u901a\u914d\u7b26\u67e5\u8be2     ? \u7528\u6765\u5339\u914d\u4e00\u4e2a\u4efb\u610f\u5b57\u7b26  * \u7528\u6765\u5339\u914d\u591a\u4e2a\u4efb\u610f\u5b57\u7b26</p> <pre><code>GET /products/_search\n{\n  \"query\": {\n    \"wildcard\": {\n      \"description\": {\n        \"value\": \"iphon*\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#idids","title":"\u591aid\u67e5\u8be2[ids]","text":"<p>ids \u5173\u952e\u5b57 : \u503c\u4e3a\u6570\u7ec4\u7c7b\u578b,\u7528\u6765\u6839\u636e\u4e00\u7ec4id\u83b7\u53d6\u591a\u4e2a\u5bf9\u5e94\u7684\u6587\u6863</p>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#fuzzy","title":"\u6a21\u7cca\u67e5\u8be2[fuzzy]","text":"<p>fuzzy \u5173\u952e\u5b57: \u7528\u6765\u6a21\u7cca\u67e5\u8be2\u542b\u6709\u6307\u5b9a\u5173\u952e\u5b57\u7684\u6587\u6863</p> <p>\u6ce8\u610f: <code>fuzzy \u6a21\u7cca\u67e5\u8be2  \u6700\u5927\u6a21\u7cca\u9519\u8bef \u5fc5\u987b\u57280-2\u4e4b\u95f4</code></p> <ul> <li>\u641c\u7d22\u5173\u952e\u8bcd\u957f\u5ea6\u4e3a 2 \u4e0d\u5141\u8bb8\u5b58\u5728\u6a21\u7cca</li> <li>\u641c\u7d22\u5173\u952e\u8bcd\u957f\u5ea6\u4e3a3-5 \u5141\u8bb8\u4e00\u6b21\u6a21\u7cca</li> <li>\u641c\u7d22\u5173\u952e\u8bcd\u957f\u5ea6\u5927\u4e8e5 \u5141\u8bb8\u6700\u59272\u6a21\u7cca</li> </ul>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#bool","title":"\u5e03\u5c14\u67e5\u8be2[bool]","text":"<p>bool \u5173\u952e\u5b57: \u7528\u6765\u7ec4\u5408\u591a\u4e2a\u6761\u4ef6\u5b9e\u73b0\u590d\u6742\u67e5\u8be2</p> <p>must: \u76f8\u5f53\u4e8e&amp;&amp; \u540c\u65f6\u6210\u7acb</p> <p>should: \u76f8\u5f53\u4e8e|| \u6210\u7acb\u4e00\u4e2a\u5c31\u884c</p> <p>must_not: \u76f8\u5f53\u4e8e!  \u4e0d\u80fd\u6ee1\u8db3\u4efb\u4f55\u4e00\u4e2a</p>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#multi_match","title":"\u591a\u5b57\u6bb5\u67e5\u8be2[multi_match]","text":"<pre><code>GET /products/_search\n{\n  \"query\": {\n    \"multi_match\": {\n      \"query\": \"iphone13 \u6beb\",\n      \"fields\": [\"title\",\"description\"]\n    }\n  }\n}\n\u6ce8\u610f: \u5b57\u6bb5\u7c7b\u578b\u5206\u8bcd,\u5c06\u67e5\u8be2\u6761\u4ef6\u5206\u8bcd\u4e4b\u540e\u8fdb\u884c\u67e5\u8be2\u6539\u5b57\u6bb5  \u5982\u679c\u8be5\u5b57\u6bb5\u4e0d\u5206\u8bcd\u5c31\u4f1a\u5c06\u67e5\u8be2\u6761\u4ef6\u4f5c\u4e3a\u6574\u4f53\u8fdb\u884c\u67e5\u8be2\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#query_string","title":"\u9ed8\u8ba4\u5b57\u6bb5\u5206\u8bcd\u67e5\u8be2[query_string]","text":"<pre><code>GET /products/_search\n{\n  \"query\": {\n    \"query_string\": {\n      \"default_field\": \"description\",\n      \"query\": \"\u5c4f\u5e55\u771f\u7684\u975e\u5e38\u4e0d\u9519\"\n    }\n  }\n}\n\u6ce8\u610f: \u67e5\u8be2\u5b57\u6bb5\u5206\u8bcd\u5c31\u5c06\u67e5\u8be2\u6761\u4ef6\u5206\u8bcd\u67e5\u8be2  \u67e5\u8be2\u5b57\u6bb5\u4e0d\u5206\u8bcd\u5c06\u67e5\u8be2\u6761\u4ef6\u4e0d\u5206\u8bcd\u67e5\u8be2\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#highlight","title":"\u9ad8\u4eae\u67e5\u8be2[highlight]","text":"<p>highlight \u5173\u952e\u5b57: \u53ef\u4ee5\u8ba9\u7b26\u5408\u6761\u4ef6\u7684\u6587\u6863\u4e2d\u7684\u5173\u952e\u8bcd\u9ad8\u4eae</p> <pre><code># \u9ad8\u4eae\u67e5\u8be2\nGET /products/_search \n{\n  \"query\": {\n    \"multi_match\": {\n      \"query\": \"iphone15\",\n      \"fields\": [\"description\",\"title\"]\n    }\n  },\n  \"highlight\": {\n    \"post_tags\": [\"&lt;/span&gt;\"], \n    \"pre_tags\": [\"&lt;span style='color:red'&gt;\"], \n    \"fields\": {\n      \"description\": {},\n      \"title\": {}\n    }\n  }\n}\n</code></pre> <p>\u672c\u8d28\u4e0a\u662f\u8fd4\u56de\u4e00\u4e2ahighlight\u7684json\u5b57\u7b26\u4e32 \u7136\u540e\u52a0\u4e0a\u6807\u7b7e</p>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#size","title":"\u8fd4\u56de\u6307\u5b9a\u6761\u6570[size]","text":"<p>\u8fd4\u56de\u6307\u5b9a\u7684\u6761\u6570 total: 4  \u4f46\u53ea\u8fd4\u56de\u4e862\u6761</p>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#form","title":"\u5206\u9875\u67e5\u8be2[form]","text":"<pre><code># \u5206\u9875\u67e5\u8be2 \nGET /products/_search\n{\n  \"query\": {\n    \"match_all\": {}\n  },\n  \"from\": 0, # \u8ddfmysql\u4e00\u6837\u7684\u5206\u9875 page * (size - 1)\n  \"size\": 3\n}\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#sort","title":"\u6307\u5b9a\u5b57\u6bb5\u6392\u5e8f[sort]","text":"<pre><code># \u6307\u5b9a\u6392\u5e8f\nGET /products/_search\n{\n  \"query\": {\n    \"match_all\": {}\n  },\n  \"sort\": [\n    {\n      \"price\": {\n        \"order\": \"asc\"\n      }\n    }\n  ]\n}\n</code></pre> <p>\u8ddf mysql \u4e00\u6837asc\u662f\u5347\u5e8f\uff0cdesc\u662f\u964d\u5e8f</p>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#_source","title":"\u8fd4\u56de\u6307\u5b9a\u5b57\u6bb5[_source]","text":"<pre><code># \u6307\u5b9a\u8fd4\u56de\u7684\u5b57\u6bb5\nGET /products/_search\n{\n  \"query\": {\n    \"match_all\": {}\n  },\n  \"_source\": [\"title\",\"description\"]\n}\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#_4","title":"\u8fc7\u6ee4\u67e5\u8be2","text":""},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#_5","title":"\u8fc7\u6ee4\u67e5\u8be2","text":"<p>\u8fc7\u6ee4\u67e5\u8be2\uff0c\u5176\u5b9e\u51c6\u786e\u6765\u8bf4\uff0cES\u4e2d\u7684\u67e5\u8be2\u64cd\u4f5c\u5206\u4e3a2\u79cd: <code>\u67e5\u8be2(query)</code>\u548c<code>\u8fc7\u6ee4(filter)</code>\u3002\u67e5\u8be2\u5373\u662f\u4e4b\u524d\u63d0\u5230\u7684<code>query\u67e5\u8be2</code>\uff0c\u5b83 (\u67e5\u8be2)\u9ed8\u8ba4\u4f1a\u8ba1\u7b97\u6bcf\u4e2a\u8fd4\u56de\u6587\u6863\u7684\u5f97\u5206\uff0c\u7136\u540e\u6839\u636e\u5f97\u5206\u6392\u5e8f\u3002\u800c<code>\u8fc7\u6ee4(filter)</code>\u53ea\u4f1a\u7b5b\u9009\u51fa\u7b26\u5408\u7684\u6587\u6863\uff0c\u5e76\u4e0d\u8ba1\u7b97 \u5f97\u5206\uff0c\u800c\u4e14\u5b83\u53ef\u4ee5\u7f13\u5b58\u6587\u6863 \u3002\u6240\u4ee5\uff0c\u5355\u4ece\u6027\u80fd\u8003\u8651\uff0c\u8fc7\u6ee4\u6bd4\u67e5\u8be2\u66f4\u5feb\u3002 \u6362\u53e5\u8bdd\u8bf4<code>\u8fc7\u6ee4\u9002\u5408\u5728\u5927\u8303\u56f4\u7b5b\u9009\u6570\u636e\uff0c\u800c\u67e5\u8be2\u5219\u9002\u5408\u7cbe\u786e\u5339\u914d\u6570\u636e\u3002\u4e00\u822c\u5e94\u7528\u65f6\uff0c \u5e94\u5148\u4f7f\u7528\u8fc7\u6ee4\u64cd\u4f5c\u8fc7\u6ee4\u6570\u636e\uff0c \u7136\u540e\u4f7f\u7528\u67e5\u8be2\u5339\u914d\u6570\u636e\u3002</code> <p>\u5fc5\u987b\u914d\u5408\u8fd9\u5e03\u5c14\u67e5\u8be2\u4f7f\u7528</p>"},{"location":"blog/2024/01/01/elasticsearch%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2/#_6","title":"\u7c7b\u578b","text":"<p>\u5e38\u89c1\u8fc7\u6ee4\u7c7b\u578b\u6709: term \u3001 terms \u3001ranage\u3001exists\u3001ids\u7b49filter\u3002</p>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/","title":"ElasticSearch\u57fa\u672c\u7406\u8bba","text":""},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#elasticsearch","title":"\u4ec0\u4e48\u662fElasticSearch","text":"<p>\u5b83\u88ab\u7528\u4f5c\u5168\u6587\u68c0\u7d22\u3001\u7ed3\u6784\u5316\u641c\u7d22\u3001\u5206\u6790\u4ee5\u53ca\u8fd9\u4e09\u4e2a\u529f\u80fd\u7684\u7ec4\u5408\uff1a</p> <ul> <li>Wikipedia \u4f7f\u7528 Elasticsearch \u63d0\u4f9b\u5e26\u6709\u9ad8\u4eae\u7247\u6bb5\u7684\u5168\u6587\u641c\u7d22\uff0c\u8fd8\u6709 search-as-you-type \u548c did-you-mean \u7684\u5efa\u8bae\u3002</li> <li>\u536b\u62a5 \u4f7f\u7528 Elasticsearch \u5c06\u7f51\u7edc\u793e\u4ea4\u6570\u636e\u7ed3\u5408\u5230\u8bbf\u5ba2\u65e5\u5fd7\u4e2d\uff0c\u4e3a\u5b83\u7684\u7f16\u8f91\u4eec\u63d0\u4f9b\u516c\u4f17\u5bf9\u4e8e\u65b0\u6587\u7ae0\u7684\u5b9e\u65f6\u53cd\u9988\u3002</li> <li>Stack Overflow \u5c06\u5730\u7406\u4f4d\u7f6e\u67e5\u8be2\u878d\u5165\u5168\u6587\u68c0\u7d22\u4e2d\u53bb\uff0c\u5e76\u4e14\u4f7f\u7528 more-like-this \u63a5\u53e3\u53bb\u67e5\u627e\u76f8\u5173\u7684\u95ee\u9898\u548c\u56de\u7b54\u3002</li> <li>GitHub \u4f7f\u7528 Elasticsearch \u5bf91300\u4ebf\u884c\u4ee3\u7801\u8fdb\u884c\u67e5\u8be2\u3002</li> <li>...</li> </ul> <p>\u9664\u4e86\u641c\u7d22\uff0c\u7ed3\u5408Kibana\u3001Logstash\u3001Beats\u5f00\u6e90\u4ea7\u54c1\uff0cElastic Stack\uff08\u7b80\u79f0ELK\uff09\u8fd8\u88ab\u5e7f\u6cdb\u8fd0\u7528\u5728\u5927\u6570\u636e\u8fd1\u5b9e\u65f6\u5206\u6790\u9886\u57df\uff0c\u5305\u62ec\uff1a\u65e5\u5fd7\u5206\u6790\u3001\u6307\u6807\u76d1\u63a7\u3001\u4fe1\u606f\u5b89\u5168\u7b49\u3002\u5b83\u53ef\u4ee5\u5e2e\u52a9\u4f60\u63a2\u7d22\u6d77\u91cf\u7ed3\u6784\u5316\u3001\u975e\u7ed3\u6784\u5316\u6570\u636e\uff0c\u6309\u9700\u521b\u5efa\u53ef\u89c6\u5316\u62a5\u8868\uff0c\u5bf9\u76d1\u63a7\u6570\u636e\u8bbe\u7f6e\u62a5\u8b66\u9608\u503c\uff0c\u901a\u8fc7\u4f7f\u7528\u673a\u5668\u5b66\u4e60\uff0c\u81ea\u52a8\u8bc6\u522b\u5f02\u5e38\u72b6\u51b5\u3002ElasticSearch\u662f\u57fa\u4e8eRestful WebApi\uff0c\u4f7f\u7528Java\u8bed\u8a00\u5f00\u53d1\u7684\u641c\u7d22\u5f15\u64ce\u5e93\u7c7b\uff0c\u5e76\u4f5c\u4e3aApache\u8bb8\u53ef\u6761\u6b3e\u4e0b\u7684\u5f00\u653e\u6e90\u7801\u53d1\u5e03\uff0c\u662f\u5f53\u524d\u6d41\u884c\u7684\u4f01\u4e1a\u7ea7\u641c\u7d22\u5f15\u64ce\u3002\u5176\u5ba2\u6237\u7aef\u5728Java\u3001C#\u3001PHP\u3001Python\u7b49\u8bb8\u591a\u8bed\u8a00\u4e2d\u90fd\u662f\u53ef\u7528\u7684\u3002 \u5176\u4e2dLucene\u662fEs\u7684\u5e95\u5c42\u641c\u7d22\u5f15\u64ce\u5e93\u3002</p>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_1","title":"\u4f7f\u7528\u573a\u666f","text":"<p>\u4e3b\u8981\u529f\u80fd\uff1a</p> <ul> <li>1\uff09\u6d77\u91cf\u6570\u636e\u7684\u5206\u5e03\u5f0f\u5b58\u50a8\u4ee5\u53ca\u96c6\u7fa4\u7ba1\u7406\uff0c\u8fbe\u5230\u4e86\u670d\u52a1\u4e0e\u6570\u636e\u7684\u9ad8\u53ef\u7528\u4ee5\u53ca\u6c34\u5e73\u6269\u5c55\uff1b</li> <li>2\uff09\u8fd1\u5b9e\u65f6\u641c\u7d22\uff0c\u6027\u80fd\u5353\u8d8a\u3002\u5bf9\u7ed3\u6784\u5316\u3001\u5168\u6587\u3001\u5730\u7406\u4f4d\u7f6e\u7b49\u7c7b\u578b\u6570\u636e\u7684\u5904\u7406\uff1b</li> <li>3\uff09\u6d77\u91cf\u6570\u636e\u7684\u8fd1\u5b9e\u65f6\u5206\u6790\uff08\u805a\u5408\u529f\u80fd\uff09</li> </ul> <p>\u5e94\u7528\u573a\u666f\uff1a</p> <ul> <li>1\uff09\u7f51\u7ad9\u641c\u7d22\u3001\u5782\u76f4\u641c\u7d22\u3001\u4ee3\u7801\u641c\u7d22\uff1b</li> <li>2\uff09\u65e5\u5fd7\u7ba1\u7406\u4e0e\u5206\u6790\u3001\u5b89\u5168\u6307\u6807\u76d1\u63a7\u3001\u5e94\u7528\u6027\u80fd\u76d1\u63a7\u3001Web\u6293\u53d6\u8206\u60c5\u5206\u6790\uff1b</li> </ul>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_2","title":"\u57fa\u7840\u6982\u5ff5","text":"<p>\u6211\u4eec\u8fd8\u9700\u5bf9\u6bd4\u7ed3\u6784\u5316\u6570\u636e\u5e93\uff0c\u770b\u770bES\u7684\u57fa\u7840\u6982\u5ff5\uff0c\u4e3a\u6211\u4eec\u540e\u9762\u5b66\u4e60\u4f5c\u94fa\u57ab\u3002</p> <ul> <li>Near Realtime\uff08NRT\uff09 \u8fd1\u5b9e\u65f6\u3002\u6570\u636e\u63d0\u4ea4\u7d22\u5f15\u540e\uff0c\u7acb\u9a6c\u5c31\u53ef\u4ee5\u641c\u7d22\u5230\u3002</li> <li>Cluster \u96c6\u7fa4\uff0c\u4e00\u4e2a\u96c6\u7fa4\u7531\u4e00\u4e2a\u552f\u4e00\u7684\u540d\u5b57\u6807\u8bc6\uff0c\u9ed8\u8ba4\u4e3a\u201celasticsearch\u201d\u3002\u96c6\u7fa4\u540d\u79f0\u975e\u5e38\u91cd\u8981\uff0c\u5177\u6709\u76f8\u540c\u96c6\u7fa4\u540d\u7684\u8282\u70b9\u624d\u4f1a\u7ec4\u6210\u4e00\u4e2a\u96c6\u7fa4\u3002\u96c6\u7fa4\u540d\u79f0\u53ef\u4ee5\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u6307\u5b9a\u3002</li> <li>Node \u8282\u70b9\uff1a\u5b58\u50a8\u96c6\u7fa4\u7684\u6570\u636e\uff0c\u53c2\u4e0e\u96c6\u7fa4\u7684\u7d22\u5f15\u548c\u641c\u7d22\u529f\u80fd\u3002\u50cf\u96c6\u7fa4\u6709\u540d\u5b57\uff0c\u8282\u70b9\u4e5f\u6709\u81ea\u5df1\u7684\u540d\u79f0\uff0c\u9ed8\u8ba4\u5728\u542f\u52a8\u65f6\u4f1a\u4ee5\u4e00\u4e2a\u968f\u673a\u7684UUID\u7684\u524d\u4e03\u4e2a\u5b57\u7b26\u4f5c\u4e3a\u8282\u70b9\u7684\u540d\u5b57\uff0c\u4f60\u53ef\u4ee5\u4e3a\u5176\u6307\u5b9a\u4efb\u610f\u7684\u540d\u5b57\u3002\u901a\u8fc7\u96c6\u7fa4\u540d\u5728\u7f51\u7edc\u4e2d\u53d1\u73b0\u540c\u4f34\u7ec4\u6210\u96c6\u7fa4\u3002\u4e00\u4e2a\u8282\u70b9\u4e5f\u53ef\u662f\u96c6\u7fa4\u3002</li> <li>Index \u7d22\u5f15: \u4e00\u4e2a\u7d22\u5f15\u662f\u4e00\u4e2a\u6587\u6863\u7684\u96c6\u5408\uff08\u7b49\u540c\u4e8esolr\u4e2d\u7684\u96c6\u5408\uff09\u3002\u6bcf\u4e2a\u7d22\u5f15\u6709\u552f\u4e00\u7684\u540d\u5b57\uff0c\u901a\u8fc7\u8fd9\u4e2a\u540d\u5b57\u6765\u64cd\u4f5c\u5b83\u3002\u4e00\u4e2a\u96c6\u7fa4\u4e2d\u53ef\u4ee5\u6709\u4efb\u610f\u591a\u4e2a\u7d22\u5f15\u3002</li> <li>Mapping \u6620\u5c04\uff1a\u6307\u5728\u4e00\u4e2a\u7d22\u5f15\u4e2d\uff0c\u5b58\u653e\u7684\u6570\u636e\u7684\u7c7b\u578b\uff0c\u7c7b\u4f3c\u4e8emysql\u4e2d\u7684\u8868\u7ed3\u6784\u3002</li> <li>Document \u6587\u6863\uff1a\u88ab\u7d22\u5f15\u7684\u4e00\u6761\u6570\u636e\uff0c\u7d22\u5f15\u7684\u57fa\u672c\u4fe1\u606f\u5355\u5143\uff0c\u4ee5JSON\u683c\u5f0f\u6765\u8868\u793a\u3002Shard \u5206\u7247\uff1a\u5728\u521b\u5efa\u4e00\u4e2a\u7d22\u5f15\u65f6\u53ef\u4ee5\u6307\u5b9a\u5206\u6210\u591a\u5c11\u4e2a\u5206\u7247\u6765\u5b58\u50a8\u3002\u6bcf\u4e2a\u5206\u7247\u672c\u8eab\u4e5f\u662f\u4e00\u4e2a\u529f\u80fd\u5b8c\u5584\u4e14\u72ec\u7acb\u7684\u201c\u7d22\u5f15\u201d\uff0c\u53ef\u4ee5\u88ab\u653e\u7f6e\u5728\u96c6\u7fa4\u7684\u4efb\u610f\u8282\u70b9\u4e0a\u3002</li> <li>Replication \u5907\u4efd: \u4e00\u4e2a\u5206\u7247\u53ef\u4ee5\u6709\u591a\u4e2a\u5907\u4efd\uff08\u526f\u672c\uff09</li> </ul>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_3","title":"\u6838\u5fc3\u6982\u5ff5","text":""},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_4","title":"\u7d22\u5f15 <p><code>\u4e00\u4e2a\u7d22\u5f15\u5c31\u662f\u4e00\u4e2a\u62e5\u6709\u51e0\u5206\u76f8\u4f3c\u7279\u5f81\u7684\u6587\u6863\u7684\u96c6\u5408</code>\u3002\u6bd4\u5982\u8bf4\uff0c\u4f60\u53ef\u4ee5\u6709\u4e00\u4e2a\u5546\u54c1\u6570\u636e\u7684\u7d22\u5f15\uff0c\u4e00\u4e2a\u8ba2\u5355\u6570\u636e\u7684\u7d22\u5f15\uff0c\u8fd8\u6709\u4e00\u4e2a\u7528\u6237\u6570\u636e\u7684\u7d22\u5f15\u3002<code>\u4e00\u4e2a\u7d22\u5f15\u7531\u4e00\u4e2a\u540d\u5b57\u6765\u6807\u8bc6</code><code>(\u5fc5\u987b\u5168\u90e8\u662f\u5c0f\u5199\u5b57\u6bcd\u7684)</code>\uff0c\u5e76\u4e14\u5f53\u6211\u4eec\u8981\u5bf9\u8fd9\u4e2a\u7d22\u5f15\u4e2d\u7684\u6587\u6863\u8fdb\u884c\u7d22\u5f15\u3001\u641c\u7d22\u3001\u66f4\u65b0\u548c\u5220\u9664\u7684\u65f6\u5019\uff0c\u90fd\u8981\u4f7f\u7528\u5230\u8fd9\u4e2a\u540d\u5b57\u3002</p>","text":""},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_5","title":"\u6620\u5c04 <p><code>\u6620\u5c04\u662f\u5b9a\u4e49\u4e00\u4e2a\u6587\u6863\u548c\u5b83\u6240\u5305\u542b\u7684\u5b57\u6bb5\u5982\u4f55\u88ab\u5b58\u50a8\u548c\u7d22\u5f15\u7684\u8fc7\u7a0b</code>\u3002\u5728\u9ed8\u8ba4\u914d\u7f6e\u4e0b\uff0cES\u53ef\u4ee5\u6839\u636e\u63d2\u5165\u7684\u6570\u636e<code>\u81ea\u52a8\u5730\u521b\u5efamapping\uff0c\u4e5f\u53ef\u4ee5\u624b\u52a8\u521b\u5efamapping</code>\u3002 mapping\u4e2d\u4e3b\u8981\u5305\u62ec\u5b57\u6bb5\u540d\u3001\u5b57\u6bb5\u7c7b\u578b\u7b49 </p>","text":""},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_6","title":"\u6587\u6863 <p><code>\u6587\u6863\u662f\u7d22\u5f15\u4e2d\u5b58\u50a8\u7684\u4e00\u6761\u6761\u6570\u636e\u3002\u4e00\u6761\u6587\u6863\u662f\u4e00\u4e2a\u53ef\u88ab\u7d22\u5f15\u7684\u6700\u5c0f\u5355\u5143</code>\u3002ES\u4e2d\u7684\u6587\u6863\u91c7\u7528\u4e86\u8f7b\u91cf\u7ea7\u7684JSON\u683c\u5f0f\u6570\u636e\u6765\u8868\u793a\u3002 </p>","text":""},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_7","title":"\u57fa\u672c\u64cd\u4f5c","text":""},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_8","title":"\u7d22\u5f15","text":""},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_9","title":"\u67e5\u8be2\u7d22\u5f15","text":"<pre><code># \u67e5\u8be2\u7d22\u5f15\n- GET /products/_cat/indices?v\n</code></pre> <p>#### \u521b\u5efa\u7d22\u5f15</p> <pre><code># 1.\u521b\u5efa\u7d22\u5f15\n- PUT /\u7d22\u5f15\u540d ====&gt; PUT /products\n- \u6ce8\u610f: \n        1.ES\u4e2d\u7d22\u5f15\u5065\u5eb7\u8f6c\u6001  red(\u7d22\u5f15\u4e0d\u53ef\u7528) \u3001yellwo(\u7d22\u5f15\u53ef\u7528,\u5b58\u5728\u98ce\u9669)\u3001green(\u5065\u5eb7)\n        2.\u9ed8\u8ba4ES\u5728\u521b\u5efa\u7d22\u5f15\u65f6\u56de\u4e3a\u7d22\u5f15\u521b\u5efa1\u4e2a\u5907\u4efd\u7d22\u5f15\u548c\u4e00\u4e2aprimary\u7d22\u5f15\n</code></pre> <p>\u5982\u679c\u4e0d\u624b\u52a8\u8bbe\u7f6e \u90a3\u4e48\u7d22\u5f15\u4e3a\u9ec4\u8272 \u5b58\u5728\u98ce\u9669</p> <pre><code># 2.\u521b\u5efa\u7d22\u5f15 \u8fdb\u884c\u7d22\u5f15\u5206\u7247\u914d\u7f6e\n- PUT /products\n{\n  \"settings\": {\n    \"number_of_shards\": 1, #\u6307\u5b9a\u4e3b\u5206\u7247\u7684\u6570\u91cf\n    \"number_of_replicas\": 0 #\u6307\u5b9a\u526f\u672c\u5206\u7247\u7684\u6570\u91cf\n  }\n}\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_10","title":"\u5220\u9664\u7d22\u5f15","text":"<p>\u6700\u7b80\u5355</p> <pre><code># \u5220\u9664\u7d22\u5f15\n- DELETE /products\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_11","title":"\u6620\u5c04","text":""},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_12","title":"\u521b\u5efa","text":"<p>\u6620\u5c04\u7684\u7c7b\u578b\uff1a</p> <p>\u5b57\u7b26\u4e32\u7c7b\u578b: keyword \u5173\u952e\u5b57 \u5173\u952e\u8bcd \u3001text \u4e00\u6bb5\u6587\u672c</p> <p>\u6570\u5b57\u7c7b\u578b\uff1ainteger long  </p> <p>\u5c0f\u6570\u7c7b\u578b\uff1afloat double</p> <p>\u5e03\u5c14\u7c7b\u578b\uff1aboolean </p> <p>\u65e5\u671f\u7c7b\u578b\uff1adate</p> <pre><code># \u521b\u5efa\u7d22\u5f15&amp;\u6620\u5c04\n</code></pre> <p>\u7d22\u5f15\u548c\u6620\u5c04\u53ef\u4ee5\u540c\u65f6\u521b\u5efa</p> <p>\u6211\u4eec\u521b\u5efa\u4e00\u4e2a\u5546\u54c1\u6620\u5c04\u4f5c\u4e3a\u540e\u9762\u7684\u4f8b\u5b50</p> <p>\u5176\u4e2d\u5305\u62ec title \u3001 price \u3001 created_at \u3001 description</p> <pre><code># \u521b\u5efa\u7d22\u5f15\u7684\u540c\u65f6\u521b\u5efa\u6620\u5c04\nPUT /products\n{\n  \"settings\": {\n    \"number_of_replicas\": 0, \n    \"number_of_shards\": 1\n  },\n  \"mappings\": {\n    \"properties\": {\n      \"title\": {\n        \"type\": \"keyword\"\n      },\n      \"price\": {\n        \"type\": \"float\"\n      },\n      \"created_at\": {\n        \"type\": \"date\"\n      },\n      \"description\": {\n        \"type\": \"text\"\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_13","title":"\u67e5\u8be2","text":"<pre><code># \u67e5\u8be2\u67d0\u4e2a\u7d22\u5f15\u7684\u6620\u5c04\n- GET /\u7d22\u5f15\u540d/_mapping =====&gt; GET /products/_mapping\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_14","title":"\u6587\u6863","text":""},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_15","title":"\u6dfb\u52a0\u6587\u6863","text":"<pre><code># \u6dfb\u52a0\u6587\u6863\n  POST /products/_doc/1 #\u6307\u5b9aid\u751f\u6210\u6587\u6863\n  {\n    \"title\": \"Iphone XR\",\n    \"created_at\": \"2018-09-01\",\n    \"price\": \"4999\",\n    \"description\": \"\u8fd9\u662f\u4e00\u90e8Iphone XR \u624b\u673a\"\n  }\n</code></pre> <p>\u6307\u5b9aid\u6dfb\u52a0</p> <p>\u4e0d\u6307\u5b9aid \u6dfb\u52a0</p>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_16","title":"\u67e5\u8be2\u6587\u6863","text":"<pre><code># \u67e5\u8be2\u6587\u6863\nGET /products/_doc/1\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_17","title":"\u5220\u9664\u6587\u6863","text":"<pre><code># \u5220\u9664\u6587\u6863\nDELETE /products/_doc/bLw1qX0BViY44oHwqzJq\n</code></pre> <pre><code>{\n  \"_index\" : \"products\",\n  \"_type\" : \"_doc\",\n  \"_id\" : \"bLw1qX0BViY44oHwqzJq\",\n  \"_version\" : 2,\n  \"result\" : \"deleted\",\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"_seq_no\" : 2,\n  \"_primary_term\" : 1\n}\n</code></pre>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_18","title":"\u66f4\u65b0\u6587\u6863","text":"<p>\u66f4\u65b0\u6587\u6863\u6709\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <ul> <li>\u4e00\u79cd\u662fPUT /\u7d22\u5f15\u540d/_doc/id \u8fd9\u79cd\u65b9\u5f0f\u662f\u5148\u5220\u9664\u6587\u6863\u5185\u5bb9\uff0c\u518d\u63d2\u5165\u66f4\u65b0\u5185\u5bb9</li> <li>\u4e00\u79cd\u662fPOST /\u7d22\u5f15\u540d/_doc/id/ _update \u8fd9\u79cd\u662f\u5728\u539f\u5148\u7684\u6587\u6863\u5185\u5bb9\u4e0a\u66f4\u65b0</li> </ul> <p>\u6211\u4eec\u5148\u63d2\u5165\u4e00\u6761\u6570\u636e</p> <pre><code>POST /products/_doc\n{\n  \"title\":\"Iphone 4\",\n  \"created_at\": \"2014-09-01\",\n  \"price\": \"499\",\n  \"description\": \"\u8fd9\u662f\u4e00\u90e8\u8fc7\u65f6\u4e86\u7684Iphone 4\u624b\u673a\"\n}\n\n\n\n{\n  \"_index\" : \"products\",\n  \"_type\" : \"_doc\",\n  \"_id\" : \"bbw6qX0BViY44oHwSzKn\",\n  \"_version\" : 1,\n  \"result\" : \"created\",\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"_seq_no\" : 3,\n  \"_primary_term\" : 1\n}\n</code></pre> <p>\u7b2c\u4e00\u79cd\u65b9\u5f0f\u66f4\u65b0\uff1a</p> <pre><code># \u7b2c\u4e00\u79cd\u65b9\u5f0f\u66f4\u65b0 \u4e0d\u4fdd\u5b58\u539f\u6587\u6863\u7684\u5185\u5bb9\nPUT /products/_doc/bbw6qX0BViY44oHwSzKn\n{\n  \"title\": \"Iphone15\"\n}\n\n\n{\n  \"_index\" : \"products\",\n  \"_type\" : \"_doc\",\n  \"_id\" : \"bbw6qX0BViY44oHwSzKn\",\n  \"_version\" : 2,\n  \"result\" : \"updated\",\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"_seq_no\" : 4,\n  \"_primary_term\" : 1\n}\n</code></pre> <p>\u67e5\u8be2\u8be5\u6587\u6863\u4e4b\u540e\uff1a</p> <p>\u7b2c\u4e8c\u79cd\u65b9\u5f0f</p> <p>\u524d\u9762\u662f\u4e00\u6837\u7684\u63d2\u5165\u4e00\u6761\u6570\u636e\uff1a</p> <pre><code>POST /products/_doc\n{\n  \"title\":\"Iphone 4\",\n  \"created_at\": \"2014-09-01\",\n  \"price\": \"499\",\n  \"description\": \"\u8fd9\u662f\u4e00\u90e8\u8fc7\u65f6\u4e86\u7684Iphone 4\u624b\u673a\"\n}\n\n\n\n{\n  \"_index\" : \"products\",\n  \"_type\" : \"_doc\",\n  \"_id\" : \"bbw6qX0BViY44oHwSzKn\",\n  \"_version\" : 1,\n  \"result\" : \"created\",\n  \"_shards\" : {\n    \"total\" : 1,\n    \"successful\" : 1,\n    \"failed\" : 0\n  },\n  \"_seq_no\" : 3,\n  \"_primary_term\" : 1\n}\n</code></pre> <pre><code># \u7b2c\u4e8c\u79cd\u65b9\u5f0f\u66f4\u65b0 \u5728\u539f\u6765\u7684\u6587\u6863\u4e0a\u8fdb\u884c\u66f4\u65b0\nPOST /products/_doc/brw9qX0BViY44oHwbDLo/_update \n{\n \"doc\": {\n  \"title\": \"Iphone15\",\n  \"price\": \"4000\"\n }\n}\n</code></pre> <p>\u6570\u636e\u66f4\u65b0\u5b8c\u6210\uff0c\u539f\u6765\u7684\u6570\u636e\u4f9d\u7136\u5b58\u5728\u3002</p>"},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_19","title":"\u6279\u91cf\u64cd\u4f5c","text":""},{"location":"blog/2024/01/01/elasticsearch%E5%9F%BA%E6%9C%AC%E7%90%86%E8%AE%BA/#_20","title":"\u6279\u91cf\u64cd\u4f5c","text":"<pre><code>POST /products/_doc/_bulk #\u6279\u91cf\u7d22\u5f15\u4e24\u6761\u6587\u6863\n    {\"index\":{\"_id\":\"1\"}}\n        {\"title\":\"iphone14\",\"price\":8999.99,\"created_at\":\"2021-09-15\",\"description\":\"iPhone 13\u5c4f\u5e55\u91c7\u75286.8\u82f1\u5bf8OLED\u5c4f\u5e55\"}\n    {\"index\":{\"_id\":\"2\"}}\n        {\"title\":\"iphone15\",\"price\":8999.99,\"created_at\":\"2021-09-15\",\"description\":\"iPhone 15\u5c4f\u5e55\u91c7\u752810.8\u82f1\u5bf8OLED\u5c4f\u5e55\"}\n</code></pre> <pre><code>POST /products/_doc/_bulk #\u66f4\u65b0\u6587\u6863\u540c\u65f6\u5220\u9664\u6587\u6863\n    {\"update\":{\"_id\":\"1\"}}\n        {\"doc\":{\"title\":\"iphone17\"}}\n    {\"delete\":{\"_id\":2}}\n    {\"index\":{}}\n        {\"title\":\"iphone19\",\"price\":8999.99,\"created_at\":\"2021-09-15\",\"description\":\"iPhone 19\u5c4f\u5e55\u91c7\u752861.8\u82f1\u5bf8OLED\u5c4f\u5e55\"}\n</code></pre> <p>\u8bf4\u660e:\u6279\u91cf\u65f6\u4e0d\u4f1a\u56e0\u4e3a\u4e00\u4e2a\u5931\u8d25\u800c\u5168\u90e8\u5931\u8d25,\u800c\u662f\u7ee7\u7eed\u6267\u884c\u540e\u7eed\u64cd\u4f5c,\u5728\u8fd4\u56de\u65f6\u6309\u7167\u6267\u884c\u7684\u72b6\u6001\u8fd4\u56de!</p>"},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/","title":"\u4ece\u96f6\u5f00\u59cb\u7684Ubuntu\u4e4b\u65c5","text":""},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/#_1","title":"\u4ece\u865a\u62df\u673a\u5f00\u59cb","text":"<p>\u8fd9\u91cc\u6211\u4f7f\u7528<code>VirtualBox</code>\uff0c\u539f\u56e0\u561b\uff0c\u4e3b\u8981\u662f\u514d\u8d39+\u8f7b\u4fbf\u597d\u7528\u3002\u4f60\u53ef\u4ee5\u5728Oracle\u4e0b\u8f7d\u9875\u4e0b\u8f7d\u5230\u5b83\u3002\u5f53\u7136\uff0c\u6e05\u534e\u5927\u5b66\u5f00\u6e90\u8f6f\u4ef6\u955c\u50cf\u7ad9\u4e5f\u6709\u63d0\u4f9b\u7684\u865a\u62df\u673a\u8f6f\u4ef6\u7684\u4e0b\u8f7d\u3002</p> <p>\u7136\u540e\u9700\u8981\u4e0b\u8f7d\u4e00\u4e2aUbuntu\u7684ISO\u6620\u50cf\u6587\u4ef6\uff0c\u8fd9\u91cc\u6211\u4eec\u4ee520.04(focal)\u7248\u672c\u4e3a\u4f8b\uff0c\u540c\u6837\u53ef\u4ee5\u5728\u6e05\u534e\u5927\u5b66\u5f00\u6e90\u8f6f\u4ef6\u955c\u50cf\u7ad9\u4e0b\u8f7d\u5230\u3002</p> <p>\u7136\u540e\u5c31\u53ef\u4ee5\u6839\u636e\u63d0\u793a\u6765\u5b89\u88c5\u865a\u62df\u673a\u4e86\u3002</p> <p>\u5b89\u88c5\u7cfb\u7edf\u65f6\u53ef\u80fd\u4f1a\u9047\u5230\u5206\u8fa8\u7387\u8fc7\u4f4e\u5bfc\u81f4\u9875\u9762\u5185\u5bb9\u663e\u793a\u4e0d\u5b8c\u6574\u7684\u60c5\u51b5</p> <p>\u53ef\u4ee5\u7528<code>xrandr</code>\u547d\u4ee4\u6765\u5207\u6362\u5206\u8fa8\u7387\u3002\u4f8b\u5982\uff1a<code>xrandr -s 7</code>\uff0c\u8fd9\u91cc7\u8868\u793a\u7b2c8\u4e2a\u5206\u8fa8\u7387\u9009\u9879\u3002</p> <p>\u5b89\u88c5\u597d\u865a\u62df\u673a\u540e\u8fdb\u5165\u64cd\u4f5c\u7cfb\u7edf\uff0c\u51c6\u5907\u5de5\u4f5c\u5c31\u5b8c\u6210\u4e86\u3002</p> \u2460 VirtualBox\u53ef\u80fd\u51fa\u73b0\u5168\u5c4f\u65f6\u5206\u8fa8\u7387\u4e0e\u5c4f\u5e55\u4e0d\u543b\u5408\u7684\u60c5\u51b5\u3002 <ol> <li>\u5173\u95ed\u865a\u62df\u673a\uff0c\u5728<code>\u63a7\u5236\u5668\uff1aIDE</code>\u5904\u5bfc\u5165\u589e\u5f3a\u529f\u80fd\u9a71\u52a8</li> <li>\u5f00\u542f\u865a\u62df\u673a\uff0c\u5728\u5c4f\u5e55\u5e95\u90e8\uff08\u6216\u9876\u90e8\uff09\u7684\u5c0f\u5de5\u5177\u680f\u9009\u62e9<code>\u8bbe\u5907</code>-&gt;<code>\u5b89\u88c5\u589e\u5f3a\u529f\u80fd</code></li> <li>\u53ef\u80fd\u9700\u8981\u91cd\u542f</li> </ol> \u2461 VirtualBox\u53ef\u80fd\u51fa\u73b0\u5f00\u542f\u53cc\u5411\u7c98\u8d34\u677f/\u62d6\u653e\u4f46\u5b9e\u9645\u4e0a\u5931\u6548\u7684\u60c5\u51b5\u3002 <ol> <li>\u5173\u95ed\u865a\u62df\u673a\uff0c\u5728\u7ba1\u7406\u5668\u9009\u62e9<code>\u8bbe\u7f6e</code>-&gt;<code>\u5b58\u50a8</code>-&gt;<code>\u63a7\u5236\u5668\uff1aSATA</code>\uff0c\u52fe\u9009\u53f3\u4fa7\u7684<code>\u4f7f\u7528\u4e3b\u673a\u8f93\u5165\u8f93\u51fa(I/O)\u7f13\u5b58</code></li> <li>\u9009\u62e9<code>\u63a7\u5236\u5668\uff1aSATA</code>\u4e0b\u65b9\u786c\u76d8\uff0c\u52fe\u9009\u53f3\u4fa7\u7684<code>\u56fa\u6001\u9a71\u52a8\u5668</code></li> <li>\u5728<code>\u63a7\u5236\u5668\uff1aIDE</code>\u5904\u5bfc\u5165\u589e\u5f3a\u529f\u80fd\u9a71\u52a8</li> <li>\u5f00\u542f\u865a\u62df\u673a\uff0c\u5728\u6587\u4ef6\u7cfb\u7edf\u6253\u5f00\u9a71\u52a8\u76ee\u5f55\uff0c\u8fd0\u884c\u53ef\u6267\u884c\u6587\u4ef6\u91cd\u65b0\u5b89\u88c5\u589e\u5f3a\u529f\u80fd</li> <li>\u53ef\u80fd\u9700\u8981\u91cd\u542f</li> <li>\u4ece\u865a\u62df\u673a\u5411\u5bbf\u4e3b\u673a\u62d6\u653e\u53ef\u80fd\u5931\u8d25\uff0c\u6682\u65e0\u8f83\u597d\u7684\u89e3\u51b3\u529e\u6cd5</li> </ol>"},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/#docker","title":"\u4eceDocker\u5f00\u59cb","text":"<p>\u5982\u679c\u5bbf\u4e3b\u673a\u662fLinux\u7cfb\u7edf\uff0c\u90a3\u76f4\u63a5\u5b89\u88c5docker\u5e76\u62c9\u53d6ubuntu\u955c\u50cf\u5c31\u53ef\u4ee5\u4e86\u3002</p> <pre><code>sudo docker pull ubuntu:latest\n</code></pre> <p>\u5982\u679c\u662f\u5176\u4ed6\u7cfb\u7edf\uff0c\u9700\u8981\u5148\u5b89\u88c5docker desktop\uff0c\u4f60\u53ef\u4ee5\u4eceDocker\u5b98\u7f51\u4e0b\u8f7d\u5230\u5b83\u3002</p> <p>\u5b89\u88c5\u597d\u4e4b\u540e\u5c31\u53ef\u4ee5\u641c\u7d22\u5e76\u62c9\u53d6\u60f3\u8981\u7684\u955c\u50cf\u4e86\u3002\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u4eceDocker Hub\u627e\u4f60\u60f3\u8981\u7684\u955c\u50cf\u7248\u672c\u62c9\u53d6\u3002</p> <p>\u5982\u4f55\u4f7f\u7528\u955c\u50cf\uff1f\u53ef\u4ee5\u53c2\u8003\u7b80\u6613Docker\u4f7f\u7528\u624b\u518c\u3002</p>"},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/#apt","title":"\u66f4\u6362apt\u7684\u4e0b\u8f7d\u6e90","text":"<p>\u73b0\u5728\u6211\u4eec\u6709\u4e86\u4e00\u4e2a\u6700\u5c0f\u7684ubuntu\u7cfb\u7edf\uff0c\u5728\u4e00\u5207\u5de5\u4f5c\u4e4b\u524d\uff0c\u56e0\u4e3a\u56fd\u5185\u7684\u7279\u6b8a\u6027\uff0c\u6211\u4eec\u6700\u597d\u5148\u89e3\u51b3\u4e0b\u7f51\u7edc\u95ee\u9898\uff08\u6e90\u548c\u4ee3\u7406\uff09\u3002</p> <p>\u4ece\u6e05\u534e\u6e90\u83b7\u53d6\u5230ubuntu\u7684apt\u6e90\uff0c\u5e76\u66f4\u65b0\u7cfb\u7edf\u914d\u7f6e\u3002</p> <p>\u6ce8\u610f\u9875\u9762\u4e0a\u7684\u63d0\u793a\uff0cARM\u7b49\u7248\u672c\u9700\u8981\u4f7f\u7528Ubuntu Ports \u8f6f\u4ef6\u4ed3\u5e93</p> <p>\u66f4\u65b0\u65f6\u63d0\u793a\u6ca1\u6709\u8bc1\u4e66</p> <p>\u8fd9\u91cc\u5efa\u8bae\u628a\u9009\u9879<code>\u662f\u5426\u4f7f\u7528 HTTPS</code>\u53d6\u6d88\u52fe\u9009\uff0c\u5373\u9009\u62e9\u5426\uff0c\u907f\u514d\u8bc1\u4e66\u53ef\u80fd\u5e26\u6765\u7684\u95ee\u9898\u3002\u66f4\u6362\u5bf9\u5e94ubuntu\u7248\u672c\u9009\u9879\u540e\uff0c\u5c31\u53ef\u4ee5\u590d\u5236\u7c98\u8d34\u4e86\u3002\u8fd9\u91cc\u793a\u4f8bubuntu20.04\u7684\u6e90\u3002</p> <pre><code>deb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal main restricted universe multiverse\ndeb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-updates main restricted universe multiverse\ndeb http://mirrors.tuna.tsinghua.edu.cn/ubuntu/ focal-backports main restricted universe multiverse\ndeb http://security.ubuntu.com/ubuntu/ focal-security main restricted universe multiverse\n</code></pre> <p>\u4f7f\u7528<code>sudo vi /etc/apt/source.list</code>\u5e76\u628a\u6e90\u5199\u5165\uff0c\u7136\u540e\u6267\u884c<code>sudo apt update</code>\u66f4\u65b0\u914d\u7f6e\u3002</p> <p>\u5982\u679c\u6b64\u65f6\u6ca1\u6709vi\u5de5\u5177\uff0c\u5c24\u5176\u662f\u5b98\u65b9\u63d0\u4f9b\u7684\u6700\u5c0f\u955c\u50cf\uff0c\u53ef\u4ee5\u7528echo\u547d\u4ee4\u8ffd\u52a0\u5199\u5165\u6587\u4ef6\u7684\u5f62\u5f0f\u6765\u64cd\u4f5c\uff0c\u50cf\u8fd9\u6837\uff1a</p> <pre><code>echo \"xxxxxx\" &gt;&gt; /etc/apt/sources.list\n</code></pre> <p>\u8986\u76d6\u6587\u4ef6\u524d\u8bb0\u5f97\u5907\u4efd\uff01</p>"},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/#_2","title":"\u57fa\u7840\u5de5\u5177","text":"<p>\u8fd9\u91cc\u4f1a\u5b89\u88c5<code>vim</code>\u3001<code>docker</code>\u3001<code>curl</code>\u3001<code>git</code></p> <pre><code>sudo apt update &amp;&amp; sudo apt install vim curl git ca-certificates curl gnupg lsb-release docker.io -y\n</code></pre> <p>\u5982\u679cdocker\u5b89\u88c5\u6709\u5f02\u5e38\uff0c\u4e5f\u53ef\u4ee5\u5c1d\u8bd5\u4e0b\u9762\u7684\u65b9\u5f0f</p> <pre><code>sudo apt-add-repository \"deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable\"\nsudo apt update &amp;&amp; sudo apt install -y docker-ce\n</code></pre> <p>docker\u56e0\u4e3asudo\u6743\u9650\u7684\u5173\u7cfb\uff0c\u5e73\u65f6\u4f7f\u7528\u53ef\u4ee5\u5c06\u7528\u6237\u52a0\u5165docker\u7528\u6237\u7ec4\uff0c\u8fd9\u91cc\u53ef\u80fd\u9700\u8981\u91cd\u542f\u751f\u6548\u3002</p> <pre><code>newgrp docker\nsudo groupadd docker\nsudo usermod -aG docker &lt;username&gt;\n</code></pre> <p>\u597d\u4e86\uff0c\u73b0\u5728\u4f60\u6709\u4e86\u4e00\u4e2a\u6700\u57fa\u7840\u7684Ubuntu20.04\u5f00\u53d1\u73af\u5883\u4e86\uff0c\u4eab\u53d7\u4ee3\u7801\u7684\u4e50\u8da3\u5427\u3002\u4ee5\u4e0b\u662f\u4e00\u4e9b\u63a8\u8350\u7684\u5185\u5bb9\uff0c\u4ee5\u4fbf\u4e8e\u4f60\u6709\u66f4\u597d\u7684\u5f00\u53d1\u4f53\u9a8c\u3002</p>"},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/#zsh","title":"\u66f4\u597d\u7684\u7ec8\u7aef\u4f53\u9a8c \u2014\u2014 zsh","text":"<p>\u63a5\u4e0b\u6765\u5b89\u88c5zsh + oh-my-zsh + p10k + \u63d2\u4ef6</p> <pre><code>sudo apt update &amp;&amp; apt-get install zsh -y\nwget https://gitee.com/mirrors/oh-my-zsh/raw/master/tools/install.sh\nsudo chmod +x install.sh\n</code></pre> <p>\u5c06<code>install.sh</code>\u4e2dREPO\u548cREMOTE</p> <pre><code># Default settings\nZSH=${ZSH:-~/.oh-my-zsh}\nREPO=${REPO:-ohmyzsh/ohmyzsh}\nREMOTE=${REMOTE:-https://github.com/${REPO}.git}\nBRANCH=${BRANCH:-master}\n</code></pre> <p>\u66ff\u6362\u4e3a\uff1a</p> <pre><code>REPO=${REPO:-mirrors/oh-my-zsh}\nREMOTE=${REMOTE:-https://gitee.com/${REPO}.git}\n</code></pre> <p>\u7136\u540e\u6267\u884c\u811a\u672c\uff0c\u5c31\u4f1a\u81ea\u52a8\u4e0b\u8f7doh my zsh\u4e86\uff0c\u4e0b\u8f7d\u597d\u4e4b\u540e\u4f1a\u5f00\u59cb\u521d\u59cb\u5316\u3002</p> <p>\u7136\u540e\u6211\u4eec\u4e0b\u8f7dp10k\u4e3b\u9898\u548c\u63d2\u4ef6\uff1a</p> <p><pre><code>git clone --depth=1 https://gitee.com/romkatv/powerlevel10k.git ${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}/themes/powerlevel10k\n</code></pre> <pre><code>git clone https://gitee.com/phpxxo/zsh-autosuggestions.git ${ZSH_CUSTOM:-~/.oh-my-zsh/custom}/plugins/zsh-autosuggestions\n</code></pre> <pre><code>git clone https://gitee.com/mirror-hub/zsh-syntax-highlighting $ZSH_CUSTOM/plugins/zsh-syntax-highlighting\n</code></pre></p> <p>\u5728<code>.zshrc</code>\uff08\u901a\u5e38\u662fhome\u76ee\u5f55\uff09\u4e2d\u4fee\u6539theme\u548c\u6dfb\u52a0\u63d2\u4ef6\uff1a</p> <pre><code>ZSH_THEME=\"powerlevel10k/powerlevel10k\"\n\nplugins=(git zsh-autosuggestions zsh-syntax-highlighting)\n</code></pre>"},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/#proxy","title":"Proxy","text":""},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/#for-docker","title":"for Docker","text":"<pre><code>sudo mkdir -p /etc/systemd/system/docker.service.d\nsudo touch /etc/systemd/system/docker.service.d/proxy.conf\n</code></pre> <p>\u5728\u8fd9\u4e2a<code>proxy.conf</code>\u6587\u4ef6\uff08\u53ef\u4ee5\u662f\u4efb\u610f<code>*.conf</code>\u7684\u5f62\u5f0f\uff09\u4e2d\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u5185\u5bb9\uff1a</p> <p>\u8fd9\u91cc<code>http://proxy.example.com:8080/</code>\u662f\u81ea\u5df1\u7684\u4ee3\u7406\u8f6c\u53d1\u5730\u5740</p> <pre><code>[Service]\nEnvironment=\"HTTP_PROXY=http://proxy.example.com:8080/\"\nEnvironment=\"HTTPS_PROXY=http://proxy.example.com:8080/\"\nEnvironment=\"NO_PROXY=localhost,127.0.0.1,.example.com\"\n</code></pre> <p>\u63a5\u4e0b\u6765\u91cd\u542fdocker\u670d\u52a1\u5c31\u53ef\u4ee5\u4e86<code>sudo systemctl restart docker</code></p>"},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/#for-terminal","title":"for Terminal","text":"<p>\u5982\u679c\u4f60\u6709Clash\u6216\u8005\u5176\u4ed6\u7684\u5de5\u5177\uff0c\u4e5f\u8bb8\u4e0d\u9700\u8981\u8fd9\u4e2a</p> <pre><code>export http_proxy=xxx.xxx.xxx.xxx\nexport https_proxy=xxx.xxx.xxx.xxx\n</code></pre> <p>\u5f53\u7136\uff0c\u4e5f\u53ef\u4ee5\u628a\u5b83\u5199\u8fdb<code>.bashrc</code>\u91cc\uff0c\u8ba9\u4ed6\u5f00\u673a\u5c31\u542f\u52a8</p> <p>\u5efa\u8bae\u914d\u5408\u6d4f\u89c8\u5668\u7684<code>SwitchyOmega</code>\u63d2\u4ef6\u5b9e\u73b0\u9875\u9762\u7684\u81ea\u52a8\u4ee3\u7406\u6a21\u5f0f\u3002</p>"},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/#for-git","title":"for Git","text":"<pre><code>git config --global http.proxy http://proxy.example.com:8080/\ngit config --global https.proxy https://proxy.example.com:8080/\n</code></pre>"},{"location":"blog/2023/10/28/%E4%BB%8E%E9%9B%B6%E5%BC%80%E5%A7%8B%E7%9A%84ubuntu%E4%B9%8B%E6%97%85/#code","title":"\u66f4\u597d\u7684code\u4f53\u9a8c","text":"<p>\u6bd4\u5982\u4e0b\u8f7dvscode\uff0c\u56fd\u5185\u4e0b\u8f7d\u53ef\u4ee5\u66ff\u6362\u57df\u540d\u4e3a\uff1a<code>vscode.cdn.azure.cn</code></p> <p>\u6216\u8005\u914d\u7f6e\u4e00\u4e2a\u66f4\u68d2\u7684vim\u73af\u5883\u2026\u2026</p>"},{"location":"blog/2025/03/17/%E6%B5%85%E8%B0%88%E9%9B%86%E6%88%90%E7%B3%BB%E7%BB%9F/","title":"\u6d45\u8c08\u96c6\u6210\u7cfb\u7edf","text":"<p>\u7b80\u5355\u6784\u60f3\u4e00\u5957\u7075\u6d3b\u654f\u6377\u5e73\u53f0\u5316\u7684\u96c6\u6210\u7cfb\u7edf\u3002</p>"},{"location":"blog/2025/03/17/%E6%B5%85%E8%B0%88%E9%9B%86%E6%88%90%E7%B3%BB%E7%BB%9F/#_1","title":"\u9884\u89c8","text":"<pre><code>%%{init: {'themeVariables': {\n  'primaryColor': '#f0f0f0',\n  'primaryBorderColor': '#666',\n  'primaryTextColor': '#333',\n  'lineColor': '#999',\n  'fontFamily': 'system-ui'\n}}}%%\nflowchart TD\n    A[\"\u7528\u6237\u63d0\u4ea4\u6784\u5efa\u8bf7\u6c42\"] --&gt; B[\u751f\u6210YAML/JSON\u914d\u7f6e\u6587\u4ef6]\n    B --&gt; C[(\u7248\u672c\u6570\u636e\u5e93)]\n\n    subgraph DB[\u6570\u636e\u5e93\u6a21\u5757]\n        C --&gt; D[\u5b58\u50a8\u7ed3\u6784]\n        D --&gt; E[\"\u7248\u672c\u53f7 / \u6784\u5efa\u65f6\u95f4 / \u5e73\u53f0\"]\n        D --&gt; F[\"\u4f9d\u8d56\u5e93\u7248\u672c(MD5\u6307\u7eb9)\"]\n        D --&gt; G[\"\u6784\u5efa\u72b6\u6001\"]\n    end\n\n    subgraph Build[\u7ec4\u5408\u6784\u5efa\u7cfb\u7edf]\n        H[\u6784\u5efa\u8c03\u5ea6\u5668] --&gt; I[\u542f\u52a8Docker\u5bb9\u5668]\n        I --&gt; J{{\"Docker Registry(\u6784\u5efa\u955c\u50cf)\"}}\n        J --&gt; K[\u83b7\u53d6\u9884\u7f16\u8bd1\u4ea7\u7269]\n        K --&gt; L1[\"\u529f\u80fd\u6a21\u5757\"]\n        K --&gt; L2[\"\u9002\u914d\u5668\u6a21\u5757\"]\n        K --&gt; M[\"\u8d44\u6e90\u6587\u4ef6\"]\n\n        L1 --&gt; N[\u96c6\u6210\u9aa8\u67b6]\n        L2 --&gt; N[\u96c6\u6210\u9aa8\u67b6]\n        M --&gt; N\n        N --&gt; O[\u7f16\u8bd1Entrypoint]\n        O --&gt; P[\u6253\u5305Docker\u955c\u50cf]\n    end\n\n    subgraph Test[\u6d4b\u8bd5\u5e73\u53f0]\n        Q[\u81ea\u52a8\u90e8\u7f72] --&gt; R[\u9a8c\u8bc1\u6d4b\u8bd5]\n        R --&gt; S{{\"\u538b\u529b\u6d4b\u8bd5\"}}\n        S --&gt; T[\u6d4b\u8bd5\u62a5\u544a\u5206\u6790]\n        T --&gt; U{\u901a\u8fc7\uff1f}\n        U --&gt;|Yes| V[\u751f\u6210Release]\n        U --&gt;|No| W[\u5931\u8d25\u901a\u77e5]\n    end\n\n    subgraph Deploy[\u53d1\u5e03\u7cfb\u7edf]\n        V --&gt; X{{\"Docker Registry(\u5f85\u53d1\u5e03\u955c\u50cf)\"}}\n        X --&gt; Y[\"Kubernetes\"]\n        Y --&gt; Z[Prometheus\u76d1\u63a7]\n    end\n\n    classDef box fill:#f8f9fa,stroke:#495057,stroke-width:1.5px\n    classDef db fill:#e9ecef,stroke:#212529,stroke-dasharray:3 3\n    classDef diamond fill:#ffffff,stroke:#6c757d,stroke-width:1.2px\n    classDef decision fill:#ffffff,stroke:#212529,stroke-width:2px\n\n    class DB db\n    class J,J,X diamond\n    class U decision\n    class Build,Test,Deploy box\n\n    style A stroke:#2b8a3e,stroke-width:1.5px\n    style W stroke:#c92a2a,stroke-width:1.5px</code></pre>"},{"location":"blog/2025/03/17/%E6%B5%85%E8%B0%88%E9%9B%86%E6%88%90%E7%B3%BB%E7%BB%9F/#0","title":"0. \u8bf7\u6c42\u6784\u5efa","text":"<p>\u4e3a\u4e86\u65b9\u4fbf\u601d\u8003\uff0c\u6211\u4eec\u4ece\u6700\u7ec8\u53d1\u5e03\u6765\u5012\u63a8\u6574\u4e2a\u6d41\u7a0b\u9700\u8981\u54ea\u4e9b\u90e8\u4ef6\u6a21\u5757\u3002\u5c06\u88ab\u53d1\u5e03\u7684\u5305\u81f3\u5c11\u9700\u8981\u4e00\u4e2a\u53ef\u4ee5\u6eaf\u6e90\u7248\u672c\u4fe1\u606f\u7684\u5e73\u53f0\uff0c\u8fd9\u6837\u5ba2\u6237\u3001\u5b9e\u65bd\u3001QA\u3001\u5f00\u53d1\u7b49\u4eba\u5458\u53ef\u4ee5\u5feb\u901f\u786e\u8ba4\u3002\u4e8e\u662f\u6211\u4eec\u9700\u8981\u4e00\u5957\u6570\u636e\u5e93\uff08\u4f8b\u5982\u7528Mysql\u7b80\u5355\u642d\u5efa\u4e00\u4e0b\uff09\u6765\u8bb0\u5f55\u7248\u672c\u4fe1\u606f\uff0c\u7531\u4e8e\u4fe1\u606f\u9700\u8981\u6301\u4e45\u7a33\u5b9a\uff0c\u4e5f\u8bb8\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u9ad8\u53ef\u7528\u7684\u6570\u636e\u5e93\u65b9\u6848\u6216\u662f\u5b9a\u671f\u5907\u4efd\u5230\u4ed3\u5e93\u3002</p> <p>\u8fd9\u91cc\u8981\u4fdd\u5b58\u7684\u5185\u5bb9\u6709\uff1a\u6784\u5efa\u7684\u7248\u672c\u3001\u65f6\u95f4\u3001\u5e73\u53f0\u3001\u4f9d\u8d56\u5e93\u7684\u7248\u672c\u53f7\u548cMD5\uff08\u6216\u662fhash\u503c\uff09\uff0c\u90a3\u4e48\u8fd9\u4e5f\u662f\u8bf7\u6c42\u6784\u5efa\u65f6\u9700\u8981\u88ab\u63d0\u4ea4\u7684\u4fe1\u606f\u3002\u6bd4\u5982\u5c31\u7528YAML\u6216\u662fJSON\u6765\u5b58\u8fd9\u4e9b\u5185\u5bb9\uff0c\u65b9\u4fbf\u88ab\u811a\u672c\u5904\u7406\u3002\u65b9\u4fbf\u67e5\u770b\u7684\u8bdd\u8fd8\u53ef\u4ee5\u6709\u4e00\u4e2a\u7f51\u9875\u6765\u67e5\u8be2\u6570\u636e\u5e93\uff0c\u5b9e\u65f6\u67e5\u770b\u6784\u5efa\u72b6\u6001\u7b49\u4fe1\u606f\u3002</p>"},{"location":"blog/2025/03/17/%E6%B5%85%E8%B0%88%E9%9B%86%E6%88%90%E7%B3%BB%E7%BB%9F/#1","title":"1. \u7ec4\u5408\u6784\u5efa","text":"<p>\u8fd9\u91cc\u4ee5\u5bb9\u5668\u5316\u601d\u8def\u642d\u5efa\uff0c\u9694\u79bb\u6027\u597d\uff0c\u4e5f\u6bd4\u8f83\u73b0\u4ee3\u3002\u6bcf\u4e2a\u88ab\u63d0\u4ea4\u7684\u6784\u5efa\u90fd\u5e94\u8be5\u5728\u4e00\u4e2a\u5bb9\u5668\u91cc\u5b8c\u6210\uff0c\u5bb9\u5668\u4ece\u5404\u4e2a\u6a21\u5757\u4ed3\u5e93\u62c9\u53d6\u4e8b\u5148\u7ecf\u8fc7CI/CD\u9a8c\u8bc1\u548c\u7f16\u8bd1\u7684Release\u6587\u4ef6\uff08\u5e93\u3001\u5934\u6587\u4ef6\u3001\u7248\u6743\u4fe1\u606f\u7b49\uff09\uff0c\u4e5f\u53ef\u4ee5\u987a\u5e26\u4ea7\u51fa\u62c9\u53d6\u7684\u6587\u4ef6\u7684MD5\u4ee5\u65b9\u4fbf\u540e\u7eed\u9a8c\u8bc1\u3002</p> <p>\u7136\u540e\u5e94\u8be5\u6709\u4e00\u5957\u4ee5\u63a5\u53e3\u548c\u6846\u67b6\u4e3a\u4e3b\u7684\u3001\u5c3d\u53ef\u80fd\u62bd\u8c61\u7684\u96c6\u6210\u4ee3\u7801\uff0c\u4f5c\u4e3a\u53ef\u6267\u884c\u6587\u4ef6\uff08entrypoint\uff09\u88ab\u7f16\u8bd1\u3002\u6240\u6709\u4f1a\u7528\u5230\u7684\u529f\u80fd\u6a21\u5757\u90fd\u5e94\u8be5\u662f\u88ab\u63d0\u524d\u7f16\u8bd1\u597d\u7684\uff0c\u800c\u4e0d\u662f\u5728\u6784\u5efa\u65f6\u7f16\u8bd1\u5360\u636e\u5927\u91cf\u65f6\u95f4\u548c\u6027\u80fd\u3002</p> <p>\u90a3\u4e48\u8fd9\u91cc\u9700\u8981\u6709\u4e00\u4e2a\u540e\u7aef\u6765\u5904\u7406\u8fd9\u4e9b\u6570\u636e\uff08\u4e5f\u8bb8\u8fd8\u6709\u9274\u6743\uff09\uff0c\u5e76\u542f\u52a8\u6784\u5efa\u5bb9\u5668\u548c\u811a\u672c\u6765\u505a\u8fd9\u4e9b\u4e8b\u60c5\u3002\u8fd8\u4f1a\u9700\u8981\u4e00\u4e2aDocker Repository\u6765\u5b58\u50a8\u6784\u5efa\u73af\u5883\u955c\u50cf\uff0c\u88ab\u6784\u5efa\u7684\u57fa\u7840\u955c\u50cf\u4ee5\u53ca\u6784\u5efa\u5b8c\u7684\u955c\u50cf\u3002</p>"},{"location":"blog/2025/03/17/%E6%B5%85%E8%B0%88%E9%9B%86%E6%88%90%E7%B3%BB%E7%BB%9F/#11","title":"1.1 \u529f\u80fd\u6a21\u5757","text":"<p>\u529f\u80fd\u6a21\u5757\u4e3b\u8981\u662f\u5b9e\u73b0\u4e1a\u52a1\u7684\u82e5\u5e72\u90e8\u5206\uff0c\u4f8b\u5982\u4e00\u4e2a\u626b\u7801\u670d\u52a1\u5c31\u9700\u8981\uff1a\u56fe\u50cf\u89e3\u6790\u4e0e\u5904\u7406\u6a21\u5757\u3001\u8bc6\u522b\u6a21\u5757\u3001\u4fe1\u606f\u540e\u5904\u7406\u6a21\u5757\u3002\u8fd9\u90e8\u5206\u5e94\u8be5\u4e8b\u5148\u5f00\u53d1\uff0c\u5e76\u901a\u8fc7CI/CD\u5b8c\u6210\u5355\u5143\u6d4b\u8bd5\uff0c\u7f16\u8bd1\u6210\u9759\u6001\u5e93\u548c\u52a8\u6001\u5e93\u7b49\u5f85\u62c9\u53d6\u3002\u9700\u8981\u5c01\u88c5\u597d\uff0c\u63d0\u4f9b\u5177\u4f53\u63a5\u53e3\u7b49\u5f85\u8c03\u7528\u3002</p>"},{"location":"blog/2025/03/17/%E6%B5%85%E8%B0%88%E9%9B%86%E6%88%90%E7%B3%BB%E7%BB%9F/#12","title":"1.2 \u96c6\u6210\u6a21\u5757","text":"<p>\u96c6\u6210\u6a21\u5757\u5305\u62ecHTTP\u670d\u52a1\u6a21\u5757\uff08\u5982\u679c\u662f\u5ba2\u6237\u7aef\u90a3\u5c31\u9700\u8981\u5ba2\u6237\u7aef\u4ee3\u7801\uff09\uff0cdaemon\u6a21\u5757\uff08\u6301\u4e45\u8fd0\u884c\u7684\u5fc5\u9700\u54c1\uff09\uff0c\u65e5\u5fd7\u6a21\u5757\u548c\u5bf9\u63a5\u529f\u80fd\u63a5\u53e3\u7684\u9002\u914d\u5668\u6a21\u5757\u3002\u5176\u4e2d\uff0c\u65e5\u5fd7\u6a21\u5757\u6bd4\u8f83\u5c0f\uff0c\u5e76\u4e14\u5e94\u8be5\u5177\u5907\u56fa\u5b9a\u7684\u63a5\u53e3\uff08\u56e0\u4e3a\u5176\u4ed6\u6a21\u5757\u90fd\u4f1a\u5f15\u5165\u4f7f\u7528\uff09\u3002\u800c\u9002\u914d\u5668\u6a21\u5757\u66f4\u50cf\u662f\u6846\u67b6\uff0c\u5b83\u9488\u5bf9\u4e0d\u540c\u7684\u96c6\u6210\u4efb\u52a1\u4f1a\u51fa\u73b0\u5f88\u591a\u7248\u672c\uff0c\u4f46\u8fd9\u4e9b\u4e0d\u540c\u7684\u9002\u914d\u5668\u6a21\u5757\u5e94\u8be5\u5177\u5907\u4e00\u81f4\u7684\u8c03\u7528\u903b\u8f91\u548c\u5c01\u88c5\u63a5\u53e3\uff0c\u5b83\u770b\u8d77\u6765\u5e94\u8be5\u66f4\u50cfSDK\uff0c\u56e0\u4e3a\u96c6\u6210\u597d\u529f\u80fd\u6a21\u5757\u540e\u5c31\u5f97\u7528\u8fd9\u4e2a\u6a21\u5757\u6765\u5b8c\u6210\u5404\u79cd\u57fa\u7840\u6d4b\u8bd5\uff0c\u5230\u8fd9\u91cc\u5df2\u7ecf\u5f88\u63a5\u8fd1\u4e00\u4e2a\u5f85\u53d1\u5e03\u7684\u670d\u52a1\u5305\u4e86\u3002</p> <p>\u9002\u914d\u5668\u6a21\u5757\u662f\u8981\u88ab\u63a5\u5165\u96c6\u6210\u9aa8\u67b6\u7684\uff0c\u4ece\u96c6\u6210\u9aa8\u67b6\u91cc\u8c03\u7528\u9002\u914d\u5668\u6a21\u5757\u5e94\u8be5\u91c7\u53d6\u914d\u7f6e\u6587\u4ef6\u7684\u7f16\u6392\u5f62\u5f0f\uff0c\u5c3d\u53ef\u80fd\u8ba9\u9700\u8981\u5b9a\u5236\u53d8\u66f4\u7684\u5185\u5bb9\u51fa\u73b0\u5728\u914d\u7f6e\u6587\u4ef6\u91cc\u800c\u4e0d\u662f\u7f16\u8bd1\u5230\u4ee3\u7801\u91cc\u3002</p>"},{"location":"blog/2025/03/17/%E6%B5%85%E8%B0%88%E9%9B%86%E6%88%90%E7%B3%BB%E7%BB%9F/#13","title":"1.3 \u96c6\u6210\u9aa8\u67b6","text":"<p>\u9aa8\u67b6\u5e94\u8be5\u662f\u4e00\u5957\u76f8\u5f53\u7a33\u5b9a\u7684\u4ee3\u7801\uff0c\u5229\u7528\u4f9d\u8d56\u6ce8\u5165\u7684\u5f62\u5f0f\u9884\u7559\u597dAPI\u7ed9\u4e0d\u540c\u6a21\u5757\uff0c\u7edf\u4e00\u6309\u6279\u6b21\u7684\u8c03\u7528\u521d\u59cb\u5316\u548c\u914d\u7f6e\u8bfb\u53d6\uff0c\u6309\u987a\u5e8f\u542f\u52a8daemon\u3001\u670d\u52a1\u7b49\u3002</p>"},{"location":"blog/2025/03/17/%E6%B5%85%E8%B0%88%E9%9B%86%E6%88%90%E7%B3%BB%E7%BB%9F/#2","title":"2. \u6d4b\u8bd5","text":"<p>\u9664\u4e861.1\u91cc\u7684\u5355\u5143\u6d4b\u8bd5\uff0c1.2\u91cc\u9002\u914d\u5668\u6a21\u5757\u7684\u96c6\u6210\u6d4b\u8bd5\uff0c\u5269\u4e0b\u7684\u5c31\u662f\u6574\u4f53\u6d4b\u8bd5\u4e86\u3002\u5f53\u6784\u5efa\u5b8c\u6210\uff0c\u73b0\u5728\u5c31\u6709\u4e86\u4e00\u4e2a\u548c\u7528\u6237\u62ff\u5230\u7684\u4e00\u6837\u7684\u5f85\u53d1\u5e03\u7248\u672c\uff0c\u662f\u65f6\u5019\u62ff\u5230\u4eff\u771f\u73af\u5883\u91cc\u505a\u6700\u540e\u7684\u9a8c\u8bc1\u6d4b\u8bd5\uff08\u7406\u8bba\u4e0a\u5e94\u8be5\u4e00\u904d\u8fc7\uff09\u548c\u538b\u529b\u6d4b\u8bd5\u4e86\u3002</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u8003\u8651\u5e73\u53f0\u5316\uff0c\u548c1\u91cc\u63d0\u5230\u7684\u540e\u7aef\u63a5\u5165\uff0c\u81ea\u52a8\u63a8\u9001\u90e8\u7f72\u6765\u63d0\u9ad8\u6548\u7387\u3002\u6d4b\u8bd5\u597d\u540e\u628a\u8fd9\u4e9b\u4fe1\u606f\u5168\u90e8\u6c47\u603b\u6253\u5305\u5f52\u6863\u5230\u6570\u636e\u5e93\u3002</p>"},{"location":"blog/2025/03/17/%E6%B5%85%E8%B0%88%E9%9B%86%E6%88%90%E7%B3%BB%E7%BB%9F/#_2","title":"\u5176\u4ed6","text":"<p>\u5982\u679c\u5177\u5907\u4ed3\u5e93\u80fd\u529b\uff08\u6bd4\u5982gitlab\uff09\uff0c\u7528\u4e0ajenkins\uff0cdocker\uff0ck8s\uff0cnginx\uff0cmysql\uff0cjmeter\uff0cjira\uff0c\u90a3\u4e00\u5957devops\u57fa\u672c\u4e0a\u5c31\u9f50\u6d3b\u4e86\u3002\u89c4\u8303\u505a\u597d\u7684\u8bdd\uff0c\u6574\u4e2a\u5f00\u53d1\u6d41\u7a0b\u548c\u6548\u7387\u6bd4\u8d77\u5f00\u53d1\u4eba\u5458\u672c\u5730\u7f16\u8bd1\u6253\u5305\u6d4b\u8bd5\u53d1\u5e03\u8981\u9ad8\u6548\u7684\u591a\uff0c\u4fe1\u606f\u5f52\u6863\u4e5f\u66f4\u5b8c\u6574\u597d\u8ffd\u6eaf\u3002</p>"},{"location":"blog/2025/02/17/nlohmann-json%E5%92%8Crapidjson/","title":"nlohmann json\u548crapidjson","text":"<p>\u5728c++\u5f00\u53d1\u8fc7\u7a0b\u4e2d\u4e0d\u514d\u8981\u7528\u5230Json\u6570\u636e\u683c\u5f0f\u6765\u4f20\u9012\uff0c\u6240\u4ee5\u7b80\u5355\u804a\u804a\u5e38\u7528\u7684\u4e24\u4e2aJson\u5e93\uff0c\u5e76\u4e14\u4ed6\u4eec\u4e5f\u90fd\u8f83\u597d\u7684\u652f\u6301\u8de8\u5e73\u53f0\u5f00\u53d1\u3002</p>"},{"location":"blog/2025/02/17/nlohmann-json%E5%92%8Crapidjson/#nlohmann-json","title":"Nlohmann Json","text":"<p> \u6587\u6863: https://json.nlohmann.me/</p> <p>nlohmann json\u63d0\u4f9b\u4e86header only\u7684\u7248\u672c\uff0c\u4ece\u96c6\u6210\u89d2\u5ea6\u8003\u8651\u662f\u53ca\u5176\u65b9\u4fbf\u5904\u7406\u7684\u3002</p> <p>\u4f7f\u7528\u4e0a\u7b26\u5408modern c++\u8bed\u6cd5\uff08\u6bd5\u7adf\u6807\u9898\u5c31\u662f\u8fd9\u4e2a\uff09\uff0c\u51e0\u4e4e\u548c\u7528STL\u5dee\u4e0d\u591a\uff0c\u5f00\u53d1\u4eba\u5458\u4e00\u81f4\u597d\u8bc4\u7684\u4e1d\u6ed1\u3002</p> <p>\u5b83\u4e5f\u652f\u6301\u4eceSTL\u7684\u4efb\u610f\u5e8f\u5217\u5bb9\u5668\u521d\u59cb\u5316\u83b7\u5f97json\u5bf9\u8c61\uff0c\u6240\u4ee5\u76f8\u5f53\u9002\u5408\u7528\u6765\u5904\u7406\u6570\u636e\u53cd\u5e8f\u5217\u5316\u5230JSON\u5b57\u7b26\u4e32\u7684\u8fc7\u7a0b\u3002</p> <p>\u90a3\u4e48\u4ee3\u4ef7\u662f\u4ec0\u4e48\u5462\uff1f\u5c31\u662f\u727a\u7272\u4e86\u4e00\u5b9a\u7684\u6027\u80fd\uff0c\u5c24\u5176\u662f\u5f53\u5bf9\u8c61\u4e2d\u5b58\u50a8\u4e86\u5927\u91cf\u5b57\u7b26\u4e32\u65f6\uff08\u4f8b\u5982\u4e8c\u8fdb\u5236\u6587\u4ef6\u7684base64\u5b57\u7b26\u4e32\uff09\uff0c\u5904\u7406\u8017\u65f6\u4f1a\u660e\u663e\u589e\u52a0\u3002\u5bf9\u4e8e\u65f6\u95f4\u4e0d\u654f\u611f\u7684\u670d\u52a1\u6765\u8bf4\uff0c\u80fd\u652f\u6491\u5feb\u901f\u9ad8\u6548\u7684\u5f00\u53d1\u5de5\u4f5c\u5df2\u7ecf\u662f\u76f8\u5f53\u4f18\u52bf\u4e86\u3002</p>"},{"location":"blog/2025/02/17/nlohmann-json%E5%92%8Crapidjson/#rapidjson","title":"rapidjson","text":"<p> \u6587\u6863: https://rapidjson.org/</p> <p>\u7531\u817e\u8baf\u63d0\u4f9b\u7684json\u5e93\uff0c\u540c\u6837\u662fheader only\u7684\u3002</p> <p>\u4ee5\u9ad8\u6027\u80fd\u8457\u79f0\uff0c\u72ec\u7acb\u4e14\u5185\u5b58\u53cb\u597d\u3002\u5bf9Unicode\u6709\u826f\u597d\u7684\u652f\u6301\uff0c\u5982\u679c\u670d\u52a1\u9700\u8981\u5904\u7406\u5404\u7c7b\u5b57\u7b26\uff0c\u90a3\u4e48\u5b83\u7edd\u5bf9\u662f\u4f18\u5148\u8003\u8651\u7684\u5e93\u3002</p> <p>\u4e0d\u8fc7\u6027\u80fd\u7684\u4ee3\u4ef7\u5c31\u662f\u4f7f\u7528\u4f53\u9a8c\u4e0a\u5927\u6253\u6298\u6263\uff0c\u6bcf\u4e2a\u64cd\u4f5c\u4f60\u90fd\u9700\u8981\u81ea\u5df1\u7ba1\u7406allocator\u3002\u4f60\u4e5f\u4e0d\u60f3\u770b\u5230\u5904\u7406\u4e0d\u5f53\uff08\u5c24\u5176\u662f\u521d\u6b21\u4f7f\u7528\u7684\u5f00\u53d1\u8005\uff09\u5bfc\u81f4\u4e22\u5931\u6570\u636e\u5427\uff1f</p> <p>\u6587\u6863\u4e5f\u66f4\u52a0\u4f20\u7edf\uff0c\u4e0d\u5982\u4e0a\u6587\u63d0\u53ca\u7684nlohmann json\u6765\u7684\u597d\u4e0a\u624b\u3002</p>"},{"location":"blog/2025/02/17/nlohmann-json%E5%92%8Crapidjson/#_1","title":"\u5bf9\u6bd4","text":"<p>\u5f53json\u5b57\u7b26\u4e32\u76f8\u5bf9\u8f83\u5927\u65f6\uff0crapidjson\u7684\u8017\u65f6\u53ef\u4ee5\u662fnlohmann json\u76841/4\uff0c\u6027\u80fd\u5dee\u8ddd\u660e\u663e\u3002</p> <p>\u5982\u679c\u670d\u52a1\u5f00\u53d1\u5bf9\u65f6\u95f4\u8fd8\u4e0d\u7b97\u7279\u522b\u654f\u611f\uff0c\u53c8\u5e0c\u671b\u6709\u4e00\u4e9b\u6027\u80fd\u63d0\u5347\uff0c\u6070\u597d\u662f\u8f93\u5165\u5927\u8f93\u51fa\u5c0f\u7684\u60c5\u51b5\u7684\u8bdd\uff0c\u4f60\u4e5f\u80fd\u770b\u89c1\u4e24\u4e2a\u5e93\u540c\u65f6\u51fa\u73b0\u5728\u4e00\u4e2a\u6a21\u5757\u91cc\u7684\u60c5\u51b5\u3002</p> <p>\u5e8f\u5217\u5316\u4ea4\u7ed9rapidjson\uff0c\u53cd\u5e8f\u5217\u5316\u4ea4\u7ed9nlohmann json\u3002</p>"},{"location":"blog/2024/08/08/mysql%E5%90%8C%E6%AD%A5%E6%95%B0%E6%8D%AE%E5%88%B0elasticsearch/","title":"mysql\u540c\u6b65\u6570\u636e\u5230elasticSearch","text":""},{"location":"blog/2024/08/08/mysql%E5%90%8C%E6%AD%A5%E6%95%B0%E6%8D%AE%E5%88%B0elasticsearch/#_1","title":"\u524d\u8a00","text":"<p>\u8fd9\u91cc\u53ea\u662f\u7b80\u5355\u63cf\u8ff0\u4ecemysql\u540c\u6b65\u6570\u636e\u5230elasticSearch \u4e3e\u4e00\u53cd\u4e09 \u5176\u5b9e\u53ea\u8981\u5e0c\u671b\u662f\u4ecemysql\u8fdb\u884c\u6570\u636e\u540c\u6b65 \u90fd\u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2a\u65b9\u6cd5</p>"},{"location":"blog/2024/08/08/mysql%E5%90%8C%E6%AD%A5%E6%95%B0%E6%8D%AE%E5%88%B0elasticsearch/#_2","title":"\u4e3a\u4ec0\u4e48\u9700\u8981\u540c\u6b65\u6570\u636e","text":"<p>mysql\u5b58\u653e\u7684\u5927\u90fd\u90fd\u662f\u5b58\u653e\u4e00\u4e9b\u4e1a\u52a1\u4e0a\u9700\u8981\u7684\u6570\u636e\uff0c\u5728\u67d0\u4e9b\u65b9\u9762\u53ef\u80fd\u4f1a\u5bfc\u81f4\u5404\u79cd\u95ee\u9898 \u4e3e\u4e2a\ud83c\udf30 \u73b0\u5728\u5927\u6570\u636e\u91cf\u65f6\u9700\u8981\u8fdb\u884c\u5206\u5e93\u5206\u8868 \u8fd9\u5c31\u4f1a\u5bfc\u81f4\u5982\u679c\u4f60\u53ea\u5728mysql\u5c42\u9762\u8fdb\u884c\u641c\u7d22\u4f1a\u975e\u5e38\u7684\u56f0\u96be \u53c8\u6216\u8005\u53ef\u80fd\u67d0\u4e9b\u6570\u636e\u9700\u8981\u591a\u7ef4\u5ea6\u7684\u8fdb\u884c\u67e5\u8be2 \u9700\u8981\u5b58\u5165\u5230ES \u53ef\u80fd\u9700\u8981\u5c06\u4e00\u4e9b\u6570\u636e\u5b58\u5165\u5230\u7f13\u5b58Redis\u4e2d... </p>"},{"location":"blog/2024/08/08/mysql%E5%90%8C%E6%AD%A5%E6%95%B0%E6%8D%AE%E5%88%B0elasticsearch/#_3","title":"\u51e0\u79cd\u65b9\u5f0f","text":"<ol> <li>\u540c\u6b65\u53cc\u5199</li> </ol> <p>\u4f18\u70b9: \u5b9e\u65f6\u6027\u9ad8 </p> <p>\u7f3a\u70b9: </p> <ol> <li>\u4ee3\u7801\u9ad8\u5ea6\u8026\u5408 \u4ee3\u7801\u590d\u6742\u7a0b\u5ea6\u63d0\u6210</li> <li>\u7cfb\u7edf\u53ef\u7528\u6027\u540c\u65f6\u53d7\u591a\u4e2a\u6570\u636e\u6e90\u53ef\u7528\u6027\u5f71\u54cd \u7cfb\u7edf\u53ef\u7528\u6027\u964d\u4f4e</li> <li>\u540c\u6b65\u53cc\u5199\u4e8b\u52a1\u95ee\u9898 \u6027\u80fd\u8f83\u4f4e</li> </ol> <p>\u8fd9\u91cc\u987a\u4fbf\u63d0\u4e00\u53e5 es\u5b98\u65b9\u6587\u6863\u58f0\u660e es\u662f\u4e00\u4e2aNRT(Near Realtime)\u641c\u7d22\u548c\u5206\u6790\u5f15\u64ce \u8fd9\u4e3b\u8981\u662f\u8ddfes\u7684\u5e95\u5c42 \u7d22\u5f15\u5237\u65b0\u673a\u5236\u6709\u5173</p> <ol> <li>\u5f02\u6b65\u53cc\u5199    \u7531\u4e8e\u540c\u6b65\u53cc\u5199\u4f1a\u9020\u6210\u7cfb\u7edf\u53ef\u7528\u6027\u964d\u4f4e\uff0c\u90a3\u5f88\u5bb9\u6613\u60f3\u5230\u4f18\u5316\u65b9\u6848\uff0c\u5c31\u662f\u540c\u6b65\u6539\u6210\u5f02\u6b65    \u8fd9\u91cc\u5176\u5b9e\u6709\u5f88\u591a\u65b9\u6848\uff0c\u6700\u5e38\u89c1\u7684\u5c31\u662f\u52a0\u5165\u6d88\u606f\u961f\u5217\u8fdb\u884c\u6d88\u8d39</li> </ol> <p>\u4f18\u70b9: </p> <ol> <li>\u4ee3\u7801\u8026\u5408\u6027\u4f4e \u4e1a\u52a1\u4ee3\u7801\u65e0\u9700\u5173\u6ce8\u6570\u636e\u540c\u6b65</li> <li>\u6027\u80fd\u9ad8 \u907f\u514d\u4e86\u53cc\u5199\u7684\u4e8b\u52a1\u95ee\u9898 \u7cfb\u7edf\u53ef\u7528\u6027\u8f83\u9ad8</li> <li>\u62d3\u5c55\u6027\u5f3a \u57fa\u4e8e\u6d88\u606f\u4e2d\u95f4\u4ef6\u7684\u6d88\u606f\u8ba2\u9605 \u975e\u5e38\u5bb9\u6613\u8fdb\u884c\u591a\u6570\u636e\u6e90\u548c\u5f02\u6784\u6570\u636e\u7684\u62d3\u5c55</li> </ol> <p>\u7f3a\u70b9: </p> <ol> <li>\u6570\u636e\u5b9e\u65f6\u6027\u76f8\u5bf9\u540c\u6b65\u5199\u7a0d\u4f4e </li> <li>\u5f15\u5165\u5176\u4ed6\u4e2d\u95f4\u4ef6 \u589e\u52a0\u7cfb\u7edf\u590d\u6742\u5ea6</li> </ol> <ol> <li>\u5b9a\u65f6\u540c\u6b65</li> </ol> <p>\u5b9a\u65f6\u4efb\u52a1\u540c\u6b65\u7684\u5b9e\u73b0\u65b9\u5f0f\uff0c\u662f\u57fa\u4e8e\u5bf9MySQL\u8868\u8fdb\u884c\u5b9a\u65f6\u626b\u63cf\u8bfb\u53d6\u6570\u636e\u540e\uff0c\u5199\u5165\u5230ElasticSearch\u4e2d</p> <p>\u4f18\u70b9: </p> <ol> <li>\u5b9e\u73b0\u7b80\u5355 \u5bf9\u539f\u6709\u4ee3\u7801\u65e0\u4fb5\u5165\u6027</li> </ol> <p>\u7f3a\u70b9: </p> <ol> <li>\u5b9e\u65f6\u6027\u53d6\u51b3\u4e0e\u5b9a\u65f6\u4efb\u52a1\u7684\u5468\u671f \u5b9e\u65f6\u6027\u96be\u4ee5\u4fdd\u8bc1</li> <li>\u5f53\u5bf9\u5b9e\u65f6\u6027\u6709\u8f83\u9ad8\u8981\u6c42\u65f6 \u5bf9MySQL\u4f1a\u9020\u6210\u8f83\u5927\u7684\u538b\u529b \u53ef\u80fd\u5bfc\u81f4\u7cfb\u7edf\u6574\u4f53\u53ef\u7528\u6027\u4e0b\u964d</li> </ol> <ol> <li>binlog\u8ba2\u9605\u540c\u6b65</li> </ol> <p>binlog\u662fMySQL\u7684\u903b\u8f91\u65e5\u5fd7 \u53ef\u4ee5\u7528\u6765\u8fdb\u884c\u6570\u636e\u7684\u540c\u6b65\u548c\u590d\u5236 MySQL\u4e3b\u4ece\u540c\u6b65\u5c31\u662f\u57fa\u4e8ebinlog\u65e5\u5fd7\u5b9e\u73b0\u7684 MySQL\u4e0eElasticSearch\u95f4\u7684\u6570\u636e\u540c\u6b65\u4e5f\u53ef\u4ee5\u57fa\u4e8ebinlog\u65e5\u5fd7 \u8be5\u65b9\u6848\u9700\u8981\u5f15\u5165\u4e00\u4e2a\u4e2d\u95f4\u4ef6\u5de5\u5177 \u4f5c\u7528\u662f\u4f2a\u88c5\u6210MySQL\u4ece\u5e93 \u63a5\u6536\u4e3b\u5e93binlog \u7136\u540e\u540c\u6b65\u5230\u7684\u5176\u4ed6\u6570\u636e\u6e90 \u5e02\u9762\u4e0a\u5e38\u89c1\u4e2d\u95f4\u4ef6\u5de5\u5177\u5982Flink-CDC\u3001Canal\u3001Otter\u3001DataX\u7b49\u7b49 \u672c\u7bc7\u6587\u7ae0\u4e3b\u8981\u4ecb\u7ecdCanal</p> <p>\u4f18\u70b9: </p> <ol> <li>\u5bf9\u4e1a\u52a1\u4ee3\u7801\u7684\u5165\u4fb5\u6781\u5c11 \u5f00\u53d1\u8fc7\u7a0b\u4e2d\u65e0\u611f\u77e5</li> <li>\u6570\u636e\u5b9e\u65f6\u6027\u8f83\u9ad8</li> </ol> <p>\u7f3a\u70b9: </p> <ol> <li>\u9700\u8981\u5f15\u5165\u4e2d\u95f4\u4ef6 \u67b6\u6784\u4e0a\u589e\u52a0\u4e86\u590d\u6742\u5ea6 \u4e14\u540c\u65f6\u589e\u52a0\u4e86\u7ef4\u62a4\u6210\u672c</li> </ol>"},{"location":"blog/2024/08/08/mysql%E5%90%8C%E6%AD%A5%E6%95%B0%E6%8D%AE%E5%88%B0elasticsearch/#canal","title":"canal\u914d\u7f6e","text":"<p>\u5728MySQL\u7684\u914d\u7f6e\u6587\u4ef6my.cnf\u4e2d\u6dfb\u52a0\u5982\u4e0b\u914d\u7f6e\uff1a</p> <pre><code>find / -name my.cnf # \u67e5\u627e\u5230\u5bf9\u5e94\u7684\u914d\u7f6e\u6587\u4ef6\u4f4d\u7f6e\nlog-bin=mysql-bin # \u5f00\u542f\u4e8c\u8fdb\u5236\u65e5\u5fd7\nbinlog-format=ROW #\u4f7f\u7528row\u6a21\u5f0f\nserver-id=1 #\u914d\u7f6e\u4e3b\u6570\u636e\u5e93id\uff0c\u4e0d\u80fd\u4e0e\u4ece\u6570\u636e\u5e93\u91cd\u590d\n</code></pre> <p>MySQL\u7684\u4e3b\u4ece\u590d\u5236\u5206\u4e3a\u4e09\u79cd\u6a21\u5f0f\uff1a</p> <p>Statement\uff0c\u57fa\u4e8e\u8bed\u53e5\u7684\u590d\u5236\uff0c\u5728\u7b80\u5355\u6765\u8bf4\uff0c\u5c31\u662f\u5728\u4e3b\u5e93\u4e0a\u6267\u884c\u7684SQL\uff0c\u5728\u4ece\u5e93\u4e0a\u539f\u6837\u5730\u6267\u884c\u4e00\u904d\uff1b</p> <p>Row\uff0c\u57fa\u4e8e\u884c\u7684\u590d\u5236\uff0c\u8bb0\u5f55\u6bcf\u6b21DML\u64cd\u4f5c\u5bfc\u81f4\u7684\u6570\u636e\u884c\u53d8\u5316\uff0c\u5e76\u628a\u884c\u7684\u53d8\u66f4\u540c\u6b65\u5230\u4ece\u5e93\u4e2d\uff1b</p> <p>Mixed\uff0c\u6df7\u5408\u6a21\u5f0f\uff0c\u6839\u636e\u6267\u884c\u7684\u6bcf\u4e00\u6761\u5177\u4f53SQL\u6765\u9009\u62e9Statement\u6a21\u5f0f\u6216\u8005Rows\u6a21\u5f0f\u3002</p> <p>\u4f7f\u7528Canal\u65f6\u5efa\u8bae\u4f7f\u7528Row\u6a21\u5f0f\u3002</p> <p>\u8fd9\u91cc\u53ef\u4ee5\u9009\u62e9\u65b0\u5efa\u4e00\u4e2a\u7528\u6237\u6216\u8005\u76f4\u63a5\u4f7f\u7528root\u7528\u6237 \u8fd9\u91cc\u5077\u61d2\u5c31\u76f4\u63a5\u4f7f\u7528root</p> <p>\u53ef\u4ee5\u6839\u636e<code>show variables like 'binlog_format%';</code>\u67e5\u770b\u662f\u5426\u5f00\u542f\u4e86binlog\u6a21\u5f0f</p> <p>\u4ececanal\u5b98\u7f51\u4e0b\u8f7dcanal.deployer-1.1.8.tar.gz\uff0c\u89e3\u538b\u540e \u5728\u76ee\u5f55conf/example\u4e0b\u9762\u6709\u4e00\u4e2a\u6587\u4ef6instance.properties\uff0c\u7136\u540e\u4fee\u6539\u91cc\u9762\u7684\u6570\u636e\u5e93\u76f8\u5173\u914d\u7f6e\u4fe1\u606f\uff0c\u4e3b\u8981\u662f\u4ee5\u4e0b\u51e0\u9879\uff08IP\u5730\u5740\u3001\u7aef\u53e3\u53f7\u4fee\u6539\u6210\u5b9e\u9645\u7684\u914d\u7f6e\uff09:</p> <pre><code># \u6570\u636e\u5e93\u5730\u5740\ncanal.instance.master.address=MySQL\u670d\u52a1\u5668\u7684IP\u5730\u5740:\u7aef\u53e3\u53f7\n# \u7528\u6237\u540d/\u5bc6\u7801\uff0c\u6570\u636e\u5e93\u5b57\u7b26\u96c6\ncanal.instance.dbUsername=root\ncanal.instance.dbPassword=password \ncanal.instance.connectionCharset = UTF-8\n</code></pre> <p>\u5bf9\u4e8e\u670d\u52a1\u5668\u7684\u914d\u7f6ecanal.properties\uff0c\u53ef\u4ee5\u5148\u4e0d\u7528\u4fee\u6539\u3002</p> <p>\u63a5\u4e0b\u6765\u6211\u4eec\u5199\u4e00\u6bb5\u793a\u4f8b\u4ee3\u7801\uff0c\u5982\u679c\u8fde\u63a5\u7684MySQL\u4e2d\u6570\u636e\u8868\u6570\u636e\u53d1\u751f\u4e86\u53d8\u5316\uff0c\u90a3\u4e48\u5728Java\u7a0b\u5e8f\u76d1\u542c\u5230\u8fd9\u79cd\u53d8\u5316\u5e76\u505a\u76f8\u5e94\u7684\u4e1a\u52a1\u5904\u7406\u3002\u9996\u5148\u5f15\u5165Canal\u5ba2\u6237\u7aef\u7684\u4f9d\u8d56:</p> <pre><code> &lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.otter&lt;/groupId&gt;\n    &lt;artifactId&gt;canal.client&lt;/artifactId&gt;\n    &lt;version&gt;1.1.7&lt;/version&gt;\n &lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;com.alibaba.otter&lt;/groupId&gt;\n    &lt;artifactId&gt;canal.protocol&lt;/artifactId&gt;\n    &lt;version&gt;1.1.7&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u5177\u4f53\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>package com.ruoyi.canal;\n\nimport com.alibaba.otter.canal.client.CanalConnector;\nimport com.alibaba.otter.canal.client.CanalConnectors;\nimport com.alibaba.otter.canal.protocol.CanalEntry;\nimport com.alibaba.otter.canal.protocol.Message;\nimport com.ruoyi.config.CanalConfig;\nimport com.ruoyi.service.impl.esService;\nimport lombok.extern.slf4j.Slf4j;\nimport org.springframework.stereotype.Component;\n\nimport java.net.InetSocketAddress;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.Map;\n\nimport static com.ruoyi.common.constant.SedinnbConstants.TABLE_NAME;\n\n/**\n * @author lianghaijie\n */\n@Component\n@Slf4j\npublic class CanalClient {\n\n    private final static int BATCH_SIZE = 1000;\n\n    private final EsService esService;\n\n    // \u83b7\u53d6\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684canal \u914d\u7f6e\n    private final CanalConfig config;\n\n    public CanalClient(esService esService, CanalConfig config) {\n        this.esService = esService;\n        this.config = config;\n    }\n\n    public void run() {\n        // \u521b\u5efa\u94fe\u63a5\n        CanalConnector connector = CanalConnectors.\n                newSingleConnector(new InetSocketAddress(config.getHost(), config.getPort()),\n                        config.getDestination(),\n                        config.getUserName(),\n                        config.getPassword());\n        try {\n            //\u6253\u5f00\u8fde\u63a5\n            connector.connect();\n            //\u8ba2\u9605\u6570\u636e\u5e93\u8868,\u5168\u90e8\u8868\n            connector.subscribe(\"*\");\n            //\u56de\u6eda\u5230\u672a\u8fdb\u884cack\u7684\u5730\u65b9\uff0c\u4e0b\u6b21fetch\u7684\u65f6\u5019\uff0c\u53ef\u4ee5\u4ece\u6700\u540e\u4e00\u4e2a\u6ca1\u6709ack\u7684\u5730\u65b9\u5f00\u59cb\u62ff\n            connector.rollback();\n            while (true) {\n                // \u83b7\u53d6\u6307\u5b9a\u6570\u91cf\u7684\u6570\u636e\n                Message message = connector.getWithoutAck(BATCH_SIZE);\n                //\u83b7\u53d6\u6279\u91cfID\n                long batchId = message.getId();\n                //\u83b7\u53d6\u6279\u91cf\u7684\u6570\u91cf\n                int size = message.getEntries().size();\n                //\u5982\u679c\u6ca1\u6709\u6570\u636e\n                if (batchId == -1 || size == 0) {\n                    try {\n                        //\u7ebf\u7a0b\u4f11\u77202\u79d2\n                        Thread.sleep(2000);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                } else {\n                    //\u5982\u679c\u6709\u6570\u636e,\u5904\u7406\u6570\u636e\n                    printEntry(message.getEntries());\n                }\n                //\u8fdb\u884c batch id \u7684\u786e\u8ba4\u3002\u786e\u8ba4\u4e4b\u540e\uff0c\u5c0f\u4e8e\u7b49\u4e8e\u6b64 batchId \u7684 Message \u90fd\u4f1a\u88ab\u786e\u8ba4\u3002\n                connector.ack(batchId);\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            connector.disconnect();\n        }\n    }\n\n    /**\n     * \u6253\u5370canal server\u89e3\u6790binlog\u83b7\u5f97\u7684\u5b9e\u4f53\u7c7b\u4fe1\u606f\n     */\n    private void printEntry(List&lt;CanalEntry.Entry&gt; entryList) {\n        for (CanalEntry.Entry entry : entryList) {\n            if (entry.getEntryType() == CanalEntry.EntryType.TRANSACTIONBEGIN || entry.getEntryType() == CanalEntry.EntryType.TRANSACTIONEND) {\n                //\u5f00\u542f/\u5173\u95ed\u4e8b\u52a1\u7684\u5b9e\u4f53\u7c7b\u578b\uff0c\u8df3\u8fc7\n                continue;\n            }\n            //RowChange\u5bf9\u8c61\uff0c\u5305\u542b\u4e86\u4e00\u884c\u6570\u636e\u53d8\u5316\u7684\u6240\u6709\u7279\u5f81\n            //\u6bd4\u5982isDdl \u662f\u5426\u662fddl\u53d8\u66f4\u64cd\u4f5c sql \u5177\u4f53\u7684ddl sql beforeColumns afterColumns \u53d8\u66f4\u524d\u540e\u7684\u6570\u636e\u5b57\u6bb5\u7b49\u7b49\n            CanalEntry.RowChange rowChange;\n            try {\n                rowChange = CanalEntry.RowChange.parseFrom(entry.getStoreValue());\n            } catch (Exception e) {\n                throw new RuntimeException(\"ERROR # parser of eromanga-event has an error , data:\" + entry, e);\n            }\n            //\u83b7\u53d6\u64cd\u4f5c\u7c7b\u578b\uff1ainsert/update/delete\u7c7b\u578b\n            CanalEntry.EventType eventType = rowChange.getEventType();\n            //\u6253\u5370Header\u4fe1\u606f\n            System.out.printf(\"================\u300b; binlog[%s:%s] , name[%s,%s] , eventType : %s%n\",\n                    entry.getHeader().getLogfileName(), entry.getHeader().getLogfileOffset(),\n                    entry.getHeader().getSchemaName(), entry.getHeader().getTableName(),\n                    eventType);\n            //\u5224\u65ad\u662f\u5426\u662fDDL\u8bed\u53e5\n            if (rowChange.getIsDdl()) {\n                // \u540e\u7eed\u53ef\u4ee5\u901a\u77e5\u7ba1\u7406\u5458 \u8868\u7ea7\u522b\u7684\u53d8\u52a8\n                esService.clearCache(rowChange.getDdlSchemaName());\n                System.out.println(\"================\u300b;isDdl: true,sql:\" + rowChange.getSql());\n            }\n            //\u83b7\u53d6RowChange\u5bf9\u8c61\u91cc\u7684\u6bcf\u4e00\u884c\u6570\u636e\uff0c\u6253\u5370\u51fa\u6765\n            for (CanalEntry.RowData rowData : rowChange.getRowDatasList()) {\n                if (eventType == CanalEntry.EventType.DELETE) {\n                    //\u5982\u679c\u662f\u5220\u9664\u8bed\u53e5\n                    printColumn(rowData.getBeforeColumnsList());\n                    changeToEs(entry.getHeader().getTableName(), rowData.getBeforeColumnsList(), CanalEntry.EventType.DELETE);\n                } else if (eventType == CanalEntry.EventType.INSERT) {\n                    //\u5982\u679c\u662f\u65b0\u589e\u8bed\u53e5\n                    printColumn(rowData.getAfterColumnsList());\n                    changeToEs(entry.getHeader().getTableName(), rowData.getAfterColumnsList(), CanalEntry.EventType.INSERT);\n                } else {\n                    //\u5982\u679c\u662f\u66f4\u65b0\u7684\u8bed\u53e5\n                    //\u53d8\u66f4\u524d\u7684\u6570\u636e\n                    System.out.println(\"-------&gt;; before\");\n                    printColumn(rowData.getBeforeColumnsList());\n                    //\u53d8\u66f4\u540e\u7684\u6570\u636e\n                    System.out.println(\"-------&gt;; after\");\n                    printColumn(rowData.getAfterColumnsList());\n                    changeToEs(entry.getHeader().getTableName(), rowData.getAfterColumnsList(), CanalEntry.EventType.UPDATE);\n                }\n            }\n        }\n    }\n\n    private void changeToEs(String tableName, List&lt;CanalEntry.Column&gt; afterColumnsList, CanalEntry.EventType operation) { \n        Map&lt;String, String&gt; params = new HashMap&lt;&gt;();\n        switch (operation) {\n            case INSERT:\n                esService.addToEs(params);\n                break;\n            case UPDATE:\n                params.put(TABLE_NAME, tableName);\n                esService.updateToEs(tableName, id, params);\n                break;\n            case DELETE:\n                esService.deleteToEs(tableName, id);\n                break;\n            default:\n                break;\n\n        }\n    }\n\n    private static void printColumn(List&lt;CanalEntry.Column&gt; columns) {\n        for (CanalEntry.Column column : columns) {\n            System.out.println(column.getName() + \" : \" + column.getValue() + \"    update=\" + column.getUpdated());\n        }\n    }\n}\n</code></pre>"},{"location":"blog/2024/08/08/mysql%E5%90%8C%E6%AD%A5%E6%95%B0%E6%8D%AE%E5%88%B0elasticsearch/#_4","title":"mysql\u540c\u6b65\u6570\u636e\u5230elasticSearch","text":""},{"location":"blog/2023/11/04/%E5%85%B3%E4%BA%8Edocker%E9%95%9C%E5%83%8F%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BA%8B/","title":"\u5173\u4e8eDocker\u955c\u50cf\u7684\u4e00\u4e9b\u4e8b","text":"<p>\u955c\u50cf\u3001\u5bb9\u5668\u7684\u5206\u5c42\u4e0e\u7f13\u5b58</p>"},{"location":"blog/2023/11/04/%E5%85%B3%E4%BA%8Edocker%E9%95%9C%E5%83%8F%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BA%8B/#layer","title":"Layer","text":"<p>docker\u955c\u50cf\u505a\u4e86\u5206\u5c42\u5904\u7406\uff0c\u5728docker build\u65f6\u6bcf\u6761\u6307\u4ee4\u90fd\u4f1a\u4e3a\u955c\u50cf\u589e\u52a0\u65b0\u7684\u4e00\u5c42\u3002\u5bf9\u4e8e\u5bb9\u5668\u6765\u8bf4\uff0c\u5b9e\u9645\u4e0a\u662f\u5728\u955c\u50cf\u7684\u6700\u4e0a\u5c42\u52a0\u4e0a\u4e86\u4e00\u5c42\u8bfb\u5199\u5c42\uff0c\u6240\u6709\u5728\u5bb9\u5668\u5185\u7684\u64cd\u4f5c\u90fd\u53d1\u751f\u5728\u8fd9\u4e00\u5c42\u4e0a\uff08\u4e5f\u5c31\u662f\u5bf9\u5bb9\u5668\u7684\u64cd\u4f5c\u5e76\u4e0d\u4f1a\u6539\u53d8\u955c\u50cf\u672c\u8eab\uff09\u3002</p> <p>\u8fd9\u79cd\u5206\u5c42\u7ba1\u7406\u7684\u597d\u5904\u662f\u53ef\u4ee5\u5c3d\u91cf\u51cf\u5c11\u955c\u50cf\u7684\u5360\u7528\u7a7a\u95f4\uff0c\u5e76\u4e14\u5bf9\u7248\u672c\u7ba1\u7406\u4e5f\u66f4\u53cb\u597d\u3002\u4f8b\u5982\u6211\u4eec\u5c06\u57fa\u672c\u4e0a\u4e0d\u592a\u53ef\u80fd\u53d1\u751f\u53d8\u5316\u7684\u57fa\u7840\u73af\u5883\u4f9d\u8d56\u653e\u7f6e\u5728\u6700\u5e95\u5c42\uff0c\u5c06\u7f16\u8bd1\u7684\u4ee3\u7801\u3001\u53ef\u6267\u884c\u5185\u5bb9\u3001\u914d\u7f6e\u7b49\u653e\u5728\u6700\u524d\u9762\uff0c\u5728\u540e\u7eed\u7684build\u8fc7\u7a0b\u4e2d\uff0c\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u524d\u51e0\u5c42\u505a\u6539\u52a8\u5c31\u53ef\u4ee5\u4e86\u3002\u5bf9\u4e8e\u63a5\u6536\u955c\u50cf\u7684\u4eba\u6765\u8bf4\uff0c\u4ed6\u4e5f\u53ea\u9700\u8981\u66f4\u65b0\u524d\u51e0\u5c42\u3002</p> <p>\u8fd9\u91cc\u53ef\u80fd\u5b58\u5728\u7684\u4e00\u4e2a\u95ee\u9898\u662f\uff0c\u5982\u679c\u6211\u4eec\u5e0c\u671b\u5bf9\u57fa\u7840\u73af\u5883\u505a\u6539\u53d8\uff0c\u5c31\u5fc5\u987b\u4ece\u5934\u5f00\u59cb\u505a\u3002</p> <p>\u5047\u5982\u6211\u4eec\u6709\u4e00\u4e2a\u955c\u50cf\u5c42\u7ea7\u5982\u4e0b\uff1a</p> <p>\u6211\u4eec\u7684\u57fa\u7840\u73af\u5883\u4f9d\u8d56\u5728B\uff0cA\u662f\u6211\u4eec\u7684\u4ee3\u7801\u5c42</p> <pre><code>graph TB\n  A--&gt;B</code></pre> <p>\u73b0\u5728\u6211\u4eec\u60f3\u6539\u53d8\u4e00\u4e9b\u57fa\u7840\u4f9d\u8d56\uff0c\u5e76\u6784\u5efa\u4e86\u4e00\u4e2a\u65b0\u955c\u50cf\uff0c\u73b0\u5728\u8fd9\u4e2a\u5206\u5c42\u770b\u8d77\u6765\u4f1a\u662f\u8fd9\u6837\uff1a</p> <pre><code>graph TB\n    B'--&gt;A\n    A--&gt;B</code></pre> <p>\u6ca1\u9519\uff0cB\u5c42\u539f\u6765\u5b89\u88c5\u7684\u90a3\u4e9b\u4f9d\u8d56\u4ecd\u7136\u5728\u955c\u50cf\u91cc\uff0c\u5b83\u4eec\u53ea\u662f\u53d8\u5f97\u65e0\u6548\u4e86\uff0c\u6211\u4eec\u770b\u4e0d\u5230\u4e5f\u6539\u53d8\u4e0d\u4e86\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\u955c\u50cf\u5c31\u4f1a\u53d8\u5f97\u975e\u5e38\u5927\uff0c\u5728\u4f9d\u8d56\u591a\u7684\u955c\u50cf\u91cc\uff0c\u5982\u679c\u8fd9\u79cd\u64cd\u4f5c\u5f88\u591a\uff0c\u73b0\u8c61\u4e5f\u4f1a\u88ab\u653e\u5927\u66f4\u591a\u500d\u3002\u6240\u4ee5\u5982\u679c\u4f60\u9700\u8981\u521b\u5efa\u4e00\u4e2a\u57fa\u7840\u955c\u50cf\uff0c\u6700\u597d\u4e3a\u5b83\u51c6\u5907\u4e0a\u4e00\u4e2a\u81ea\u52a8\u5316\u6d41\u7a0b\u6765\u6784\u5efa\uff0c\u5426\u5219\u6bcf\u5f53\u66f4\u65b0\u57fa\u7840\u5185\u5bb9\u7684\u65f6\u5019\u90fd\u4f1a\u53d8\u5f97\u65e0\u6bd4\u6298\u78e8\u3002</p>"},{"location":"blog/2023/11/04/%E5%85%B3%E4%BA%8Edocker%E9%95%9C%E5%83%8F%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BA%8B/#build-with-cache","title":"Build with Cache","text":"<p>\u662f\u7684\uff0cdocker\u955c\u50cf\u5728\u6784\u5efa\u65f6\u4e5f\u4f1a\u6709\u7f13\u5b58\u673a\u5236\uff0c\u524d\u6587\u63d0\u5230\u955c\u50cf\u4f1a\u505a\u5206\u5c42\u5904\u7406\uff0c\u4e8e\u662f\u5f53\u6211\u4eec\u5728\u6784\u5efa\u4e00\u4e2a\u955c\u50cf\u65f6\uff0c\u5c31\u4f1a\u6709\u201c\u57fa\u7840\u5c42\u201d\u548c\u201c\u6307\u4ee4\u201d\uff0c\u5e76\u628a\u8fd9\u4e00\u6b21\u6307\u4ee4\u5f97\u5230\u7684\u5c42\u4f5c\u4e3a\u7ed3\u679c\u7f13\u5b58\u5728docker\u91cc\uff0c\u5f53\u4e0b\u4e00\u6b21\u9047\u5230\u540c\u6837\u7684\u57fa\u7840\u5c42\u548c\u540c\u6837\u7684\u6307\u4ee4\u7684\u65f6\u5019\uff0cdocker\u4f1a\u76f4\u63a5\u628a\u7f13\u5b58\u7ed3\u679c\u62ff\u51fa\u6765\u4ee5\u201c\u52a0\u901f\u201d\u8fd9\u6b21\u6784\u5efa\u3002</p> <p>\u8fd9\u6837\u505a\u7684\u597d\u5904\u662f\uff0c\u5982\u679c\u6211\u4eec\u5728\u4e00\u6b21\u590d\u6742\u7684\u6784\u5efa\u8fc7\u7a0b\u4e2d\uff0c\u6700\u540e\u51e0\u4e2a\u547d\u4ee4\u51fa\u73b0\u4e86\u9519\u8bef\u6216\u8005\u9047\u5230\u4e86\u610f\u6599\u4e4b\u5916\u7684\u4e8b\u60c5\uff0c\u6211\u4eec\u4fee\u6539dockerfile\u540e\uff0c\u53ef\u4ee5\u5229\u7528\u4e0a\u4e00\u6b21\u7f13\u5b58\u7684\u7ed3\u679c\u6765\u8df3\u8fc7\u524d\u9762\u5197\u957f\u7684\u7b49\u5f85\u3002\u4f46\u540c\u6837\u4f1a\u5e26\u6765\u95ee\u9898\uff0c\u5f53\u6211\u4eec\u5728\u505a\u4e00\u4e9b\u4f8b\u5982\uff1a\u66f4\u65b0\u4e00\u4e2a\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\uff08ADD\u6216COPY\u4e86\u4e00\u4e9b\u4e1c\u897f\uff09\u3001\u5b89\u88c5\u4e00\u6b21\u66f4\u65b0\uff08apt update &amp;&amp; apt upgrade -y\uff09\u7684\u65f6\u5019\uff0c\u6ca1\u9519\uff0c\u4f1a\u56e0\u4e3acache\u7684\u539f\u56e0\u5bfc\u81f4\u4f60\u7684\u66f4\u65b0\u5e76\u6ca1\u6709\u8fbe\u5230\u9884\u671f\u7684\u7ed3\u679c\u3002</p> <p>\u5f53\u7136\uff0cdocker\u63d0\u4f9b\u4e86<code>--no-cache</code>\u53c2\u6570\u8ba9\u4f60\u7684build\u4e0d\u4f7f\u7528\u7f13\u5b58\uff0c\u4e0d\u8fc7\u8fd9\u4e2a\u673a\u5236\u8fd8\u662f\u9700\u8981\u65f6\u523b\u6ce8\u610f\u3002</p>"},{"location":"blog/2023/11/04/%E5%85%B3%E4%BA%8Edocker%E9%95%9C%E5%83%8F%E7%9A%84%E4%B8%80%E4%BA%9B%E4%BA%8B/#docker-in-docker","title":"Docker in Docker","text":"<p>\u6211\u60f3\u4f60\u4e00\u5b9a\u60f3\u8fc7\uff0c\u65e2\u7136\u955c\u50cf\u53ef\u4ee5\u662f\u4e00\u4e2a\u9694\u79bb\u7684\u64cd\u4f5c\u7cfb\u7edf\uff0c\u6211\u662f\u4e0d\u662f\u53ef\u4ee5\u5728\u955c\u50cf\u91cc\u5b89\u88c5docker\uff0c\u7136\u540e\u5728\u5bb9\u5668\u91cc\u542f\u52a8\u5bb9\u5668\u5462\uff08docker\u5957\u5a03\uff09\uff1f</p> <p>\u662f\u53ef\u4ee5\u7684\uff0c\u4f46\u8fd9\u4e48\u505a\u53ef\u80fd\u4f1a\u6709\u70b9\u95ee\u9898\u3002\u56e0\u4e3a\u5bb9\u5668\u5185\u662f\u4e00\u4e2a\u72ec\u7acb\u7684\u5c42\u7ea7\uff0c\u8fd9\u610f\u5473\u7740\uff0c\u5982\u679c\u4f60\u60f3\u628a\u4e00\u4e2a\u955c\u50cf\u62c9\u5230\u5bb9\u5668\u5185\u8fd0\u884c\u65f6\uff0c\u4f1a\u51fa\u73b0\u5de8\u5927\u7684\u7f13\u5b58\u548c\u9ebb\u70e6\u7684\u6743\u9650\u95ee\u9898\u3002</p> <p>\u4e5f\u8bb8\u53ef\u4ee5\u8bd5\u8bd5\u8fd9\u4e2a\uff1a<code>-v /var/run/docker.sock:/var/run/docker.sock</code></p>"},{"location":"blog/archive/2025/","title":"2025","text":""},{"location":"blog/archive/2024/","title":"2024","text":""},{"location":"blog/archive/2023/","title":"2023","text":""},{"location":"blog/category/%E9%9B%86%E6%88%90/","title":"\u96c6\u6210","text":""},{"location":"blog/category/json/","title":"Json","text":""},{"location":"blog/category/gdb/","title":"GDB","text":""},{"location":"blog/category/elasticsearch/","title":"ElasticSearch","text":""},{"location":"blog/category/mysql/","title":"MySQL","text":""},{"location":"blog/category/gunicorn/","title":"Gunicorn","text":""},{"location":"blog/category/python/","title":"Python","text":""},{"location":"blog/category/nginx/","title":"Nginx","text":""},{"location":"blog/category/ssh/","title":"SSH","text":""},{"location":"blog/category/ubuntu/","title":"Ubuntu","text":""},{"location":"blog/category/java/","title":"Java","text":""},{"location":"blog/category/docker/","title":"Docker","text":""},{"location":"blog/category/%E8%99%9A%E6%8B%9F%E6%9C%BA/","title":"\u865a\u62df\u673a","text":""},{"location":"blog/page/2/","title":"Blog","text":""}]}